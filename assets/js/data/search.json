[
  
  {
    "title": "ä½“éªŒä¸€æŠŠå¾®è½¯å¿…åº”èŠå¤©ï¼Œå’ŒChatGPTè¿˜æœ‰å¾ˆå¤§å·®è·",
    "url": "/afb72ed4.html",
    "categories": "ä»£ç ",
    "tags": "ä»£ç ",
    "date": "2023-05-18 10:42:35 +0800",
    





    
    "snippet": "ä»Šå¤©ä½“éªŒäº†æŠŠå¾®è½¯çš„AIèŠå¤©ï¼Œå…¶ä»–å°±æ˜¯å‰æ®µæ—¶é—´è¯´çš„GPTå¤§æ¨¡å‹åº”ç”¨ï¼Œæ•´ä½“ä½“éªŒæ˜¯å¯ç”¨ï¼Œç¦»chatgptçš„å¥½ç”¨è¿˜æœ‰äº›è·ç¦»ã€‚å¿…åº”èŠå¤©  è®©å¿…åº”èŠå¤©å†™ä¸€é¦–èµç¾æ˜¥å¤©çš„è¯—æ­Œï¼ŒOKï¼Œè¿˜å¯ä»¥ï¼šç¼–ç¨‹é—®é¢˜è¿™ä¸ªé—®é¢˜å›ç­”åªèƒ½è¯´å¯ä»¥ï¼Œä»£ç ä¹Ÿæ²¡æœ‰é«˜äº®ï¼Œå¯¹äºåŸå§‹å‡½æ•°çš„å†™æ³•ä¸æ˜¯å¾ˆä¸“ä¸šï¼Œå¯¹æ¯”ä¸‹ChatGPT å°±å¯ä»¥çœ‹å‡ºå·®è·ChatGPTçš„å›ç­”ChatGPT å›ç­”å’Œæ’ç‰ˆæ˜æ˜¾è¦å¥½å¾ˆå¤š",
    "content": "ä»Šå¤©ä½“éªŒäº†æŠŠå¾®è½¯çš„AIèŠå¤©ï¼Œå…¶ä»–å°±æ˜¯å‰æ®µæ—¶é—´è¯´çš„GPTå¤§æ¨¡å‹åº”ç”¨ï¼Œæ•´ä½“ä½“éªŒæ˜¯å¯ç”¨ï¼Œç¦»chatgptçš„å¥½ç”¨è¿˜æœ‰äº›è·ç¦»ã€‚å¿…åº”èŠå¤©  è®©å¿…åº”èŠå¤©å†™ä¸€é¦–èµç¾æ˜¥å¤©çš„è¯—æ­Œï¼ŒOKï¼Œè¿˜å¯ä»¥ï¼šç¼–ç¨‹é—®é¢˜è¿™ä¸ªé—®é¢˜å›ç­”åªèƒ½è¯´å¯ä»¥ï¼Œä»£ç ä¹Ÿæ²¡æœ‰é«˜äº®ï¼Œå¯¹äºåŸå§‹å‡½æ•°çš„å†™æ³•ä¸æ˜¯å¾ˆä¸“ä¸šï¼Œå¯¹æ¯”ä¸‹ChatGPT å°±å¯ä»¥çœ‹å‡ºå·®è·ChatGPTçš„å›ç­”ChatGPT å›ç­”å’Œæ’ç‰ˆæ˜æ˜¾è¦å¥½å¾ˆå¤š"
  },
  
  {
    "title": "å‰ç«¯å¼€å‘ç¬”è®°ï¼šSassç¼–è¯‘ --load-path å‚æ•°ä½¿ç”¨",
    "url": "/2d4f46f4.html",
    "categories": "ä»£ç ",
    "tags": "ä»£ç ",
    "date": "2023-05-17 11:41:33 +0800",
    





    
    "snippet": "  Sass ç¼–è¯‘å™¨ï¼Œæ¨èä½¿ç”¨ dart-sasså®‰è£…npm install sass sass-loader -gä½¿ç”¨åŸºç¡€ç”¨æ³•ï¼š sass src.scss style.css--load-path å¯ä»¥è®©ç¼–è¯‘å™¨ä»ç»Ÿæ ¹ç›®å½•åšç›¸å¯¹è·¯å¾„å» @import æ–‡ä»¶ï¼šsass src.scss style.css --load-path ~/repos/github/fifo.site/_sasså¯...",
    "content": "  Sass ç¼–è¯‘å™¨ï¼Œæ¨èä½¿ç”¨ dart-sasså®‰è£…npm install sass sass-loader -gä½¿ç”¨åŸºç¡€ç”¨æ³•ï¼š sass src.scss style.css--load-path å¯ä»¥è®©ç¼–è¯‘å™¨ä»ç»Ÿæ ¹ç›®å½•åšç›¸å¯¹è·¯å¾„å» @import æ–‡ä»¶ï¼šsass src.scss style.css --load-path ~/repos/github/fifo.site/_sasså¯ä»¥è§£å†³ scss æ–‡ä»¶ @import ç›¸å¯¹è·¯å¾„æ— æ³•æ‰¾åˆ°é—®é¢˜åŸæ–‡ç« åŸæ–‡é“¾æ¥ï¼š https://gist.github.com/neekey/4480251SASSçš„@importæ˜¯æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œé»˜è®¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸å¯¹ï¼Œç»å¯¹è·¯å¾„æ¥ä»¥å½“å‰ç›®å½•ä¸ºæ ¹èŠ‚ç‚¹è¿›è¡Œæ–‡ä»¶çš„æŸ¥æ‰¾ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¼•å…¥çš„æ–‡ä»¶å¹¶ä¸åœ¨æˆ‘ä»¬çš„å½“å‰ç›®å½•ä¸‹ï¼ˆå¹¶ä¸”æ–‡ä»¶ä½ç½®ç›¸å·®å¾ˆå¤§ï¼Œç‰¹åˆ«æ˜¯å¾ˆå¤šéœ€è¦è¢«å¤šä¸ªé¡¹ç›®å…±ç”¨çš„æ¡†æ¶ç­‰ï¼Œå¦‚compassï¼‰ã€‚é’ˆå¯¹è¿™æ ·çš„éœ€æ±‚ï¼ŒSASS å¯ä»¥é€šè¿‡æŒ‡å®š--load-path æ¥æ·»åŠ ä¸€ä¸ªé¢å¤–ç”¨äºæŸ¥æ‰¾çš„è·¯å¾„ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttp://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import  Sass looks for other Sass files in the current directory, and the Sass file directory under Rack, Rails, or Merb. Additional search directories may be specified using the :load_paths option, or the â€“load-path option on the command line.ä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼Œæ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨:ç›®å½•å‡è®¾æˆ‘ä»¬çš„æºç ç›®å½•ç»“æ„å¦‚ä¸‹ï¼šdir/ | ----- subDir/ | ----- | ----- test.scss | ----- | ----- mod.scss | ----- | ----- sibDir | ----- | ----- | ----- base.scsssibDir/ | ----- base.scss | ----- common.scssæˆ‘ä»¬éœ€è¦ç¼–è¯‘çš„å…¥å£æ–‡ä»¶ä¸º/dir/subDir/test.scssï¼Œå®ƒé™¤äº†éœ€è¦importå½“å‰ç›®å½•ä¸‹çš„æ¨¡å—å¤–ï¼Œè¿˜éœ€è¦å¼•å…¥/sibdirä¸‹çš„æ¨¡å—ã€‚å¦‚æœæ˜¯æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨test.scssä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„:@import \"../../sibDir/common.scss\"é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬ç”¨--load-pathæ¥ç®€åŒ–å¼•ç”¨è·¯å¾„ã€‚æµ‹è¯•é’ˆå¯¹test.scssæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œå‘½ä»¤ä¸ºï¼š$ sass test.scss test.css --load-path ~/Dropbox/nodejs/app/sassPathTest/`å…ˆæŠŠå‡ ä¸ªæ–‡ä»¶çš„å†…å®¹åˆ—ä¸€ä¸‹ï¼šsibDir/common.scss:body{ color: red; }sibDir/base.scss:a { color: red; }dir/subDir/mod.scss:div { color: yellow; }dir/subDir/sibDir/base.scss:a { color: yellow; }è¿™è¾¹çš„æµ‹è¯•æ–‡ä»¶ç‰¹åœ°ä¸¾å‡ºäº†ä¸‹é¢å‡ ç§æƒ…æ™¯ï¼š  å½“å‰ç›®å½•æ¨¡å—: mod.scss  åœ¨å¤–å±‚ç›®å½•çš„æ¨¡å—ï¼šsibDir/common  åœ¨å½“å‰ç›®å½•ä¸­å¼•ç”¨åœ°å€ä¸å¤–å±‚ç›®å½•æ¨¡å—ä¸€è‡´ä½†æ˜¯å†…å®¹ä¸ä¸€è‡´æ¨¡å—ï¼šsibDir/base.scss å’Œ dir/subDir/sibDir/base.scssOKï¼Œä¸‹é¢å¯¹å‡ ç§æƒ…å†µè¿›è¡Œæµ‹è¯•ï¼šé¦–å…ˆï¼Œå¼•å…¥äº†å¤–éƒ¨æ¨¡å—å’Œå†…éƒ¨æ¨¡å—ï¼štest.scssï¼š@import \"sibDir/common\";@import \"mod\";test.css:body{ color: red; }div { color: yellow; }è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ï¼Œä¸‹é¢æˆ‘ä»¬å†çœ‹çœ‹å¦‚æœå•ç­¾ç›®å½•å’Œå¤–éƒ¨ç›®å½•ä¸­å‡ºç°åŒåçš„æ¨¡å—ä¼šå‘ç”Ÿä»€ä¹ˆï¼šæˆ‘ä»¬å°†test.scssä¿®æ”¹ä¸ºï¼š@import \"sibDir/common\";@import \"sibDir/base\"@import \"mod\";test.css:body{ color: red; }a { color: yellow }div { color: yellow; }å¯ä»¥çœ‹åˆ°ï¼ŒSASSä¼˜å…ˆå¼•å…¥äº†å½“å‰ç›®å½•çš„æ¨¡å—æ€»ç»“æ‰€ä»¥SASSçš„--load-pathçš„è¶…æ‰¾åŸåˆ™åŸºæœ¬ä¸Šæ˜¯  æ ¹æ®@importä¸­ç»™å®šçš„è·¯å¾„ï¼Œå…ˆåœ¨æœ¬åœ°æŸ¥æ‰¾  è‹¥æœ¬åœ°ä¸å­˜åœ¨ï¼Œå°±åœ¨--load-pathä½œä¸ºrootè¿›è¡ŒæŸ¥æ‰¾å¦å¤–--load-pathå¯ä»¥å¤šæ¬¡æŒ‡å®šï¼Œä¹Ÿå°±è¯´å¯ä»¥æŒ‡å®šå¤šä¸ªAdditional search directories.é¢˜å¤–è¯ï¼šæƒ³å¿…compassä¹Ÿå°±æ˜¯è¿™ä¹ˆå°†è‡ªå·±å¼•å…¥è¿›æ¥çš„ã€‚"
  },
  
  {
    "title": "Mac:å·²æŸåï¼Œæ— æ³•æ‰“å¼€ã€‚ä½ åº”è¯¥å°†å®ƒç§»åˆ°åºŸçº¸ç¯“",
    "url": "/f34e01a3.html",
    "categories": "ä»£ç ",
    "tags": "ä»£ç ",
    "date": "2023-05-11 17:12:13 +0800",
    





    
    "snippet": "è§£å†³ï¼šsudo xattr -r -d com.apple.quarantine + åº”ç”¨è·¯å¾„å¦‚sudo xattr -r -d com.apple.quarantine /Applications/WeChat.app/\t\t/Applications/WeChat.app/ä¸ºå¾®ä¿¡è·¯å¾„",
    "content": "è§£å†³ï¼šsudo xattr -r -d com.apple.quarantine + åº”ç”¨è·¯å¾„å¦‚sudo xattr -r -d com.apple.quarantine /Applications/WeChat.app/\t\t/Applications/WeChat.app/ä¸ºå¾®ä¿¡è·¯å¾„"
  },
  
  {
    "title": "git pushæŠ¥é”™:pack exceeds maximum allowed size",
    "url": "/6c9b86b0.html",
    "categories": "è½¯ä»¶å·¥å…·",
    "tags": "git",
    "date": "2023-05-09 13:48:41 +0800",
    





    
    "snippet": "git push ä»“åº“æŠ¥é”™ï¼šæšä¸¾å¯¹è±¡ä¸­: 302521, å®Œæˆ.å¯¹è±¡è®¡æ•°ä¸­: 100% (302521/302521), å®Œæˆ.ä½¿ç”¨ 8 ä¸ªçº¿ç¨‹è¿›è¡Œå‹ç¼©å‹ç¼©å¯¹è±¡ä¸­: 100% (182739/182739), å®Œæˆ.remote: fatal: pack exceeds maximum allowed sizeerror: è¿œç¨‹è§£åŒ…å¤±è´¥ï¼šindex-pack abnormal exitTo ...",
    "content": "git push ä»“åº“æŠ¥é”™ï¼šæšä¸¾å¯¹è±¡ä¸­: 302521, å®Œæˆ.å¯¹è±¡è®¡æ•°ä¸­: 100% (302521/302521), å®Œæˆ.ä½¿ç”¨ 8 ä¸ªçº¿ç¨‹è¿›è¡Œå‹ç¼©å‹ç¼©å¯¹è±¡ä¸­: 100% (182739/182739), å®Œæˆ.remote: fatal: pack exceeds maximum allowed sizeerror: è¿œç¨‹è§£åŒ…å¤±è´¥ï¼šindex-pack abnormal exitTo git.xxx.com:webrtc/third_party.git ! [remote rejected]       rtc-105 -&gt; rtc-105 (unpacker error)error: æ— æ³•æ¨é€ä¸€äº›å¼•ç”¨åˆ° 'https://xxx.com/webrtc/third_party.git'error: è¿œç¨‹è§£åŒ…å¤±è´¥ï¼šindex-pack abnormal exit  åº”è¯¥æ˜¯æŸäº›æ–‡ä»¶è¶…è¿‡äº†gité™åˆ¶ã€‚è§£å†³æ‰¾äº†ä¸ªè„šæœ¬ï¼Œéå¸¸å¥½ä½¿ï¼šREMOTE æ”¹ä¸ºä½ è¦æ¨çš„è¿œç«¯ï¼Œæˆ‘æœ¬åœ°ä»“åº“å¯¹åº”è¿œç«¯ï¼Œå®é™…ä½¿ç”¨æ”¹ä¸ºäº†upstreamï¼Œæ ¹æ®éœ€è¦æ¥# Adjust the following variables as necessaryREMOTE=originBRANCH=$(git rev-parse --abbrev-ref HEAD)BATCH_SIZE=100 # check if the branch exists on the remoteif git show-ref --quiet --verify refs/remotes/$REMOTE/$BRANCH; then    # if so, only push the commits that are not on the remote already    range=$REMOTE/$BRANCH..HEADelse    # else push all the commits    range=HEADfi# count the number of commits to pushn=$(git log --first-parent --format=format:x $range | wc -l) # push each batchfor i in $(seq $n -$BATCH_SIZE 1); do    # get the hash of the commit to push    h=$(git log --first-parent --reverse --format=format:%H --skip $i -n1)    echo \"Pushing $h...\"    git push $REMOTE $h:refs/heads/$BRANCHdone# push the final partial batchgit push $REMOTE HEAD:refs/heads/$BRANCHä¿å­˜æˆè„šæœ¬ï¼Œæ”¾åˆ°ä»“åº“æ ¹ç›®å½•æ‰§è¡Œå°±å¯ä»¥ã€‚æ€æƒ³åº”è¯¥å°±æ˜¯å°†ä»“åº“åˆ†æˆéƒ¨åˆ†ï¼Œåˆ†æ‰¹pushæ¥è§£å†³å‚è€ƒ  https://chegva.com/5658.html  https://zhuanlan.zhihu.com/p/354354365"
  },
  
  {
    "title": "gitåˆ›å»ºç©ºç™½åˆ†æ”¯",
    "url": "/72b4e1b6.html",
    "categories": "è½¯ä»¶å·¥å…·",
    "tags": "Git",
    "date": "2023-05-09 11:16:24 +0800",
    





    
    "snippet": "Gitåˆ›å»ºç©ºç™½åˆ†æ”¯ï¼Œå³ï¼šä¸åŸºäºä»»ä½•åˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯git checkout --orphan newBranchName\t",
    "content": "Gitåˆ›å»ºç©ºç™½åˆ†æ”¯ï¼Œå³ï¼šä¸åŸºäºä»»ä½•åˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯git checkout --orphan newBranchName\t"
  },
  
  {
    "title": "ä»£ç é—®é¢˜å®šä½çš„å‡ ä¸ªæœ‰æ•ˆç­–ç•¥",
    "url": "/56191fa9.html",
    "categories": "ä»£ç ",
    "tags": "ä»£ç ",
    "date": "2023-05-06 09:40:34 +0800",
    





    
    "snippet": "",
    "content": ""
  },
  
  {
    "title": "Mac-M1ä¸Šdockerè¿è¡ŒjekyllæœåŠ¡",
    "url": "/566c3f40.html",
    "categories": "ä»£ç ",
    "tags": "Jekyll",
    "date": "2023-05-05 09:47:20 +0800",
    





    
    "snippet": "Jekyll Serverå¯ä»¥è®©ä½ åœ¨æœ¬åœ°ç”Ÿæˆé™æ€ç½‘é¡µï¼Œå¹¶èµ·ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé¢„è§ˆç«™ç‚¹ã€‚Jekyll å®˜æ–¹æä¾›çš„é•œåƒåªæœ‰x86ç‰ˆæœ¬çš„ï¼Œåœ¨Mac M1è·‘èµ·æ¥æ…¢ä¸€äº›ï¼Œæ‰¾äº†ä¸ªæ”¯æŒarm64çš„ç‰ˆæœ¬ã€‚ç›®å½•åˆ‡æ¢åˆ°ç«™ç‚¹çš„æ ¹ç›®å½•ï¼Œæ‰§è¡Œï¼šdocker run -rm -p 4000:4000 -v $(pwd):/site bretfisher/jekyll-serveä¼šè‡ªåŠ¨bundle install å®‰è£…ç›¸å…³ä¾èµ–...",
    "content": "Jekyll Serverå¯ä»¥è®©ä½ åœ¨æœ¬åœ°ç”Ÿæˆé™æ€ç½‘é¡µï¼Œå¹¶èµ·ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé¢„è§ˆç«™ç‚¹ã€‚Jekyll å®˜æ–¹æä¾›çš„é•œåƒåªæœ‰x86ç‰ˆæœ¬çš„ï¼Œåœ¨Mac M1è·‘èµ·æ¥æ…¢ä¸€äº›ï¼Œæ‰¾äº†ä¸ªæ”¯æŒarm64çš„ç‰ˆæœ¬ã€‚ç›®å½•åˆ‡æ¢åˆ°ç«™ç‚¹çš„æ ¹ç›®å½•ï¼Œæ‰§è¡Œï¼šdocker run -rm -p 4000:4000 -v $(pwd):/site bretfisher/jekyll-serveä¼šè‡ªåŠ¨bundle install å®‰è£…ç›¸å…³ä¾èµ–ï¼Œå¹¶æ¥ä¸€ä¸ªserverï¼Œè®¿é—®ä»¥ä¸‹åœ°å€é¢„è§ˆç«™ç‚¹ï¼šhttp://localhost:4000/"
  },
  
  {
    "title": "å…¥å‘é”®åœˆï¼Œé€ äº†ä¸€æŠŠæœºæ¢°é”®ç›˜",
    "url": "/2fbbfc28.html",
    "categories": "å·§è®°",
    "tags": "é”®ç›˜",
    "date": "2023-05-05 09:39:26 +0800",
    





    
    "snippet": "æŒºå–œæ¬¢æœºæ¢°é”®ç›˜ï¼Œå¸‚é¢ä¸Šçš„æœºæ¢°é”®ç›˜æ‰‹æ„Ÿè¾¾ä¸åˆ°è‡ªå·±çš„è¦æ±‚ï¼Œè¦ä¹ˆæ¯”è¾ƒç¡¬ï¼Œè¦ä¹ˆå£°éŸ³å¤§ï¼Œè¦ä¹ˆå¸ƒå±€ä¸å–œæ¬¢ï¼Œæ‰€ä»¥å°±è‡ªå·±åšäº†ä¸€æŠŠã€‚75%çš„å¸ƒå±€ï¼ŒåŸºäºQMKï¼Œæ”¯æŒViaï¼Œå¤–å£³ä½¿ç”¨Sharp3Dç”»çš„ï¼Œå¹¶3Dæ‰“å°çš„ï¼ŒPCBå°±æ˜¯å˜‰ç«‹åˆ›çš„ä¸€å¥—ã€‚Gasketç»“æ„ï¼ŒPCBæœ‰å¼€æ§½ï¼Œéå¸¸è½¯å¼¹ï¼Œæ‰“å­—éŸ³æ¸…çˆ½æ— æ‚éŸ³ï¼Œæ»¡è¶³è‡ªå·±éœ€æ±‚ã€‚é”®ç›˜ä¹Ÿå¼€æºå‡ºæ¥ï¼Œåˆ†äº«ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€‚Cherish-75Cherish-75ï¼Œå®¢åˆ¶åŒ–æœºæ¢°é”®ç›˜ï¼ŒPCBå·²...",
    "content": "æŒºå–œæ¬¢æœºæ¢°é”®ç›˜ï¼Œå¸‚é¢ä¸Šçš„æœºæ¢°é”®ç›˜æ‰‹æ„Ÿè¾¾ä¸åˆ°è‡ªå·±çš„è¦æ±‚ï¼Œè¦ä¹ˆæ¯”è¾ƒç¡¬ï¼Œè¦ä¹ˆå£°éŸ³å¤§ï¼Œè¦ä¹ˆå¸ƒå±€ä¸å–œæ¬¢ï¼Œæ‰€ä»¥å°±è‡ªå·±åšäº†ä¸€æŠŠã€‚75%çš„å¸ƒå±€ï¼ŒåŸºäºQMKï¼Œæ”¯æŒViaï¼Œå¤–å£³ä½¿ç”¨Sharp3Dç”»çš„ï¼Œå¹¶3Dæ‰“å°çš„ï¼ŒPCBå°±æ˜¯å˜‰ç«‹åˆ›çš„ä¸€å¥—ã€‚Gasketç»“æ„ï¼ŒPCBæœ‰å¼€æ§½ï¼Œéå¸¸è½¯å¼¹ï¼Œæ‰“å­—éŸ³æ¸…çˆ½æ— æ‚éŸ³ï¼Œæ»¡è¶³è‡ªå·±éœ€æ±‚ã€‚é”®ç›˜ä¹Ÿå¼€æºå‡ºæ¥ï¼Œåˆ†äº«ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€‚Cherish-75Cherish-75ï¼Œå®¢åˆ¶åŒ–æœºæ¢°é”®ç›˜ï¼ŒPCBå·²æ‰“æ ·éªŒè¯ï¼Œæ—¨åœ¨å®¢åˆ¶åŒ–äº¤æµåˆ†äº«ï¼Œç¦æ­¢å•†ç”¨ï¼ä¸»æ§: STM32F072CBT6, Type-Cåˆ†ç¦»å°æ¿ç¡¬ä»¶PCBï¼šFlex Cut PCBï¼Œé˜»ç„Šå¼€çª—(æ²‰é‡‘),  ç«‹åˆ›å·¥ç¨‹é“¾æ¥:  https://oshwhub.com/caiyahoho/Cherish-75é…åˆ—ï¼š75%ï¼Œå°é—¨ç‰™é…åˆ—è½´åº§: ç„Šæ¥&amp;çƒ­æ’æ‹”RGB: å¤§å†™é”® RGBè½¯ä»¶ï¼šQMK &amp; VIAï¼ŒæŸ¥çœ‹ fireware ç›®å½•è®¸å¯ï¼šGPL3.0, ç¦æ­¢å•†ç”¨å¤–å£³: 3Dæ‰“å°ï¼Œç£å¸ä¸Šä¸‹ç›–è®¾è®¡ï¼Œç¡®ä¿æ˜¯å¦æ»¡è¶³ä¸ªäººéœ€è¦ï¼Œåˆ‡å‹¿ç›´æ¥æ‰“å°ä½¿ç”¨ï¼ŒæŸ¥çœ‹ 3d-modelç›®å½•æ„Ÿè°¢ï¼šå®¢åˆ¶åŒ–å…¥å‘åŠå¹´ï¼Œå·¥ä½œåŠ ç­ä¹Ÿæ¯”è¾ƒå¤šï¼Œæ„Ÿè°¢è€å©†å¤§äººçš„å®½å®¹è®©æˆ‘æœ‰æ—¶é—´æŠ˜è…¾æˆå“ç…§é»‘è‰²PCBå¸ƒçº¿æ•ˆæœ:ç™½è‰²PCBå¸ƒçº¿æ•ˆæœ:USBæ¥å£å­æ¿:é”®ç›˜å¸ƒå±€ï¼šæ”¯æŒVia3Dæ‰“å°å¤–å£³PCBæ‰“æ ·ç„Šæ¥ï¼š"
  },
  
  {
    "title": "Android-WebRTCç¡¬ç¼–H264æ”¯æŒåˆ†æ",
    "url": "/8c5f9198.html",
    "categories": "ä»£ç ",
    "tags": "ä»£ç ",
    "date": "2023-05-04 15:58:56 +0800",
    





    
    "snippet": "Androidç«¯Mediacodec ç¡¬ç¼–é™åˆ¶æ¯”è¾ƒå¤šï¼Œä»…æ”¯æŒbaseå’Œhigh profile, è€Œä¸”high profileå¯¹å¤„ç†å™¨åšäº†é™åˆ¶ï¼Œåªæ”¯æŒä¸‰æ˜Ÿçš„å¤„ç†å™¨:codecName.startsWith(\"OMX.Exynos.)\"ï¼Œlevel ä»…æ”¯æŒ3_1ï¼Œè¯¦ç»†å¯ä»¥æŸ¥çœ‹ HardwareVideoEncoderFactory.java æ–‡ä»¶ã€‚è®°å½•ä¸‹è°ƒç”¨çš„å¤§æ¦‚æµç¨‹ï¼šh264_profile...",
    "content": "Androidç«¯Mediacodec ç¡¬ç¼–é™åˆ¶æ¯”è¾ƒå¤šï¼Œä»…æ”¯æŒbaseå’Œhigh profile, è€Œä¸”high profileå¯¹å¤„ç†å™¨åšäº†é™åˆ¶ï¼Œåªæ”¯æŒä¸‰æ˜Ÿçš„å¤„ç†å™¨:codecName.startsWith(\"OMX.Exynos.)\"ï¼Œlevel ä»…æ”¯æŒ3_1ï¼Œè¯¦ç»†å¯ä»¥æŸ¥çœ‹ HardwareVideoEncoderFactory.java æ–‡ä»¶ã€‚è®°å½•ä¸‹è°ƒç”¨çš„å¤§æ¦‚æµç¨‹ï¼šh264_profile_level_id.ccabsl::optional&lt;std::string&gt; H264ProfileLevelIdToString(    const H264ProfileLevelId&amp; profile_level_id) {  // Handle special case level == 1b.  if (profile_level_id.level == H264Level::kLevel1_b) {    switch (profile_level_id.profile) {      case H264Profile::kProfileConstrainedBaseline:        return {\"42f00b\"};      case H264Profile::kProfileBaseline:        return {\"42100b\"};      case H264Profile::kProfileMain:        return {\"4d100b\"};      // Level 1b is not allowed for other profiles.      default:        return absl::nullopt;    }  }  const char* profile_idc_iop_string;  switch (profile_level_id.profile) {    case H264Profile::kProfileConstrainedBaseline:      profile_idc_iop_string = \"42e0\";      break;    case H264Profile::kProfileBaseline:      profile_idc_iop_string = \"4200\";      break;    case H264Profile::kProfileMain:      profile_idc_iop_string = \"4d00\";      break;    case H264Profile::kProfileConstrainedHigh:      profile_idc_iop_string = \"640c\";      break;    case H264Profile::kProfileHigh:      profile_idc_iop_string = \"6400\";      break;    case H264Profile::kProfilePredictiveHigh444:      profile_idc_iop_string = \"f400\";      break;    // Unrecognized profile.    default:      return absl::nullopt;  }  char str[7];  snprintf(str, 7u, \"%s%02x\", profile_idc_iop_string, profile_level_id.level);  return {str};}webrtc_video_engine.ccbool WebRtcVideoChannel::GetChangedSendParameters(    const VideoSendParameters&amp; params,    ChangedSendParameters* changed_params) const {  if (!ValidateCodecFormats(params.codecs) ||      !ValidateRtpExtensions(params.extensions, send_rtp_extensions_)) {    return false;  }  std::vector&lt;VideoCodecSettings&gt; negotiated_codecs =      SelectSendVideoCodecs(MapCodecs(params.codecs));  // We should only fail here if send direction is enabled.  if (params.is_stream_active &amp;&amp; negotiated_codecs.empty()) {    RTC_LOG(LS_ERROR) &lt;&lt; \"No video codecs supported.\";    return false;  }  // Never enable sending FlexFEC, unless we are in the experiment.  if (!IsEnabled(call_-&gt;trials(), \"WebRTC-FlexFEC-03\")) {    for (VideoCodecSettings&amp; codec : negotiated_codecs)      codec.flexfec_payload_type = -1;  }  if (negotiated_codecs_ != negotiated_codecs) {    if (negotiated_codecs.empty()) {      changed_params-&gt;send_codec = absl::nullopt;    } else if (send_codec_ != negotiated_codecs.front()) {      changed_params-&gt;send_codec = negotiated_codecs.front();    }    changed_params-&gt;negotiated_codecs = std::move(negotiated_codecs);  }  // Handle RTP header extensions.  if (params.extmap_allow_mixed != ExtmapAllowMixed()) {    changed_params-&gt;extmap_allow_mixed = params.extmap_allow_mixed;  }  std::vector&lt;webrtc::RtpExtension&gt; filtered_extensions = FilterRtpExtensions(      params.extensions, webrtc::RtpExtension::IsSupportedForVideo, true,      call_-&gt;trials());  if (send_rtp_extensions_ != filtered_extensions) {    changed_params-&gt;rtp_header_extensions =        absl::optional&lt;std::vector&lt;webrtc::RtpExtension&gt;&gt;(filtered_extensions);  }  if (params.mid != send_params_.mid) {    changed_params-&gt;mid = params.mid;  }  // Handle max bitrate.  if (params.max_bandwidth_bps != send_params_.max_bandwidth_bps &amp;&amp;      params.max_bandwidth_bps &gt;= -1) {    // 0 or -1 uncaps max bitrate.    // TODO(pbos): Reconsider how 0 should be treated. It is not mentioned as a    // special value and might very well be used for stopping sending.    changed_params-&gt;max_bandwidth_bps =        params.max_bandwidth_bps == 0 ? -1 : params.max_bandwidth_bps;  }  // Handle conference mode.  if (params.conference_mode != send_params_.conference_mode) {    changed_params-&gt;conference_mode = params.conference_mode;  }  // Handle RTCP mode.  if (params.rtcp.reduced_size != send_params_.rtcp.reduced_size) {    changed_params-&gt;rtcp_mode = params.rtcp.reduced_size                                    ? webrtc::RtcpMode::kReducedSize                                    : webrtc::RtcpMode::kCompound;  }  return true;}simulcast_encoder_adapter.ccSimulcastEncoderAdapter::FetchOrCreateEncoderContext(    bool is_lowest_quality_stream) const {  bool prefer_temporal_support = fallback_encoder_factory_ != nullptr &amp;&amp;                                 is_lowest_quality_stream &amp;&amp;                                 prefer_temporal_support_on_base_layer_;  // Toggling of `prefer_temporal_support` requires encoder recreation. Find  // and reuse encoder with desired `prefer_temporal_support`. Otherwise, if  // there is no such encoder in the cache, create a new instance.  auto encoder_context_iter =      std::find_if(cached_encoder_contexts_.begin(),                   cached_encoder_contexts_.end(), [&amp;](auto&amp; encoder_context) {                     return encoder_context-&gt;prefer_temporal_support() ==                            prefer_temporal_support;                   });  std::unique_ptr&lt;SimulcastEncoderAdapter::EncoderContext&gt; encoder_context;  if (encoder_context_iter != cached_encoder_contexts_.end()) {    encoder_context = std::move(*encoder_context_iter);    cached_encoder_contexts_.erase(encoder_context_iter);  } else {    std::unique_ptr&lt;VideoEncoder&gt; primary_encoder =        primary_encoder_factory_-&gt;CreateVideoEncoder(video_format_);    std::unique_ptr&lt;VideoEncoder&gt; fallback_encoder;    if (fallback_encoder_factory_ != nullptr) {      fallback_encoder =          fallback_encoder_factory_-&gt;CreateVideoEncoder(video_format_);    }    std::unique_ptr&lt;VideoEncoder&gt; encoder;    VideoEncoder::EncoderInfo primary_info;    VideoEncoder::EncoderInfo fallback_info;    if (primary_encoder != nullptr) {      primary_info = primary_encoder-&gt;GetEncoderInfo();      fallback_info = primary_info;      if (fallback_encoder == nullptr) {        encoder = std::move(primary_encoder);      } else {        encoder = CreateVideoEncoderSoftwareFallbackWrapper(            std::move(fallback_encoder), std::move(primary_encoder),            prefer_temporal_support);      }    } else if (fallback_encoder != nullptr) {      RTC_LOG(LS_WARNING) &lt;&lt; \"Failed to create primary \" &lt;&lt; video_format_.name                          &lt;&lt; \" encoder. Use fallback encoder.\";      fallback_info = fallback_encoder-&gt;GetEncoderInfo();      primary_info = fallback_info;      encoder = std::move(fallback_encoder);    } else {      RTC_LOG(LS_ERROR) &lt;&lt; \"Failed to create primary and fallback \"                        &lt;&lt; video_format_.name &lt;&lt; \" encoders.\";      return nullptr;    }    encoder_context = std::make_unique&lt;SimulcastEncoderAdapter::EncoderContext&gt;(        std::move(encoder), prefer_temporal_support, primary_info,        fallback_info);  }  encoder_context-&gt;encoder().RegisterEncodeCompleteCallback(      encoded_complete_callback_);  return encoder_context;}ç„¶åè°ƒç”¨åˆ°Javaå±‚HardwareVideoEncoderFactory.java@Nullable@Overridepublic VideoEncoder createEncoder(VideoCodecInfo input) {  VideoCodecMimeType type = VideoCodecMimeType.valueOf(input.getName());  MediaCodecInfo info = findCodecForType(type);  if (info == null) {    return null;  }  String codecName = info.getName();  String mime = type.mimeType();  Integer surfaceColorFormat = MediaCodecUtils.selectColorFormat(      MediaCodecUtils.TEXTURE_COLOR_FORMATS, info.getCapabilitiesForType(mime));  Integer yuvColorFormat = MediaCodecUtils.selectColorFormat(      MediaCodecUtils.ENCODER_COLOR_FORMATS, info.getCapabilitiesForType(mime));  if (type == VideoCodecMimeType.H264) {    boolean isHighProfile = H264Utils.isSameH264Profile(        input.params, MediaCodecUtils.getCodecProperties(type, /* highProfile= */ true));    boolean isBaselineProfile = H264Utils.isSameH264Profile(        input.params, MediaCodecUtils.getCodecProperties(type, /* highProfile= */ false));    if (!isHighProfile &amp;&amp; !isBaselineProfile) {      return null;    }    if (isHighProfile &amp;&amp; !isH264HighProfileSupported(info)) {      return null;    }  }  return new HardwareVideoEncoder(new MediaCodecWrapperFactoryImpl(), codecName, type,      surfaceColorFormat, yuvColorFormat, input.params, PERIODIC_KEY_FRAME_INTERVAL_S,      getForcedKeyFrameIntervalMs(type, codecName), createBitrateAdjuster(type, codecName),      sharedContext);}HardwareVideoEncoder.java@Overridepublic VideoCodecStatus initEncode(Settings settings, Callback callback) {  encodeThreadChecker.checkIsOnValidThread();  this.callback = callback;  automaticResizeOn = settings.automaticResizeOn;  if (settings.width % REQUIRED_RESOLUTION_ALIGNMENT != 0      || settings.height % REQUIRED_RESOLUTION_ALIGNMENT != 0) {    Logging.e(TAG, \"MediaCodec is only tested with resolutions that are 16x16 aligned.\");    return VideoCodecStatus.ERR_SIZE;  }  this.width = settings.width;  this.height = settings.height;  useSurfaceMode = canUseSurface();  if (settings.startBitrate != 0 &amp;&amp; settings.maxFramerate != 0) {    bitrateAdjuster.setTargets(settings.startBitrate * 1000, settings.maxFramerate);  }  adjustedBitrate = bitrateAdjuster.getAdjustedBitrateBps();  Logging.d(TAG,      \"initEncode: \" + width + \" x \" + height + \". @ \" + settings.startBitrate          + \"kbps. Fps: \" + settings.maxFramerate + \" Use surface mode: \" + useSurfaceMode);  return initEncodeInternal();}"
  },
  
  {
    "title": "Android-Native-æ‰“å°æ—¥å¿—",
    "url": "/1be3649c.html",
    "categories": "ä»£ç ",
    "tags": "ä»£ç ",
    "date": "2023-05-04 11:19:04 +0800",
    





    
    "snippet": "Android NDKè°ƒè¯•ï¼Œç»å¸¸éœ€è¦æ‰“æ—¥å¿—ï¼Œæ—¥å¿—å‡½æ•°ç»å¸¸å¿˜è®°ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œæ•´ç†åˆ°è¿™é‡Œï¼šå¤´æ–‡ä»¶#include &lt;android/log.h&gt; åŸå‡½æ•°int __android_log_print(int prio, const char* tag, const char* fmt, ...)æ—¥å¿—çº§åˆ«typedef enum android_LogPriority {  /*...",
    "content": "Android NDKè°ƒè¯•ï¼Œç»å¸¸éœ€è¦æ‰“æ—¥å¿—ï¼Œæ—¥å¿—å‡½æ•°ç»å¸¸å¿˜è®°ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œæ•´ç†åˆ°è¿™é‡Œï¼šå¤´æ–‡ä»¶#include &lt;android/log.h&gt; åŸå‡½æ•°int __android_log_print(int prio, const char* tag, const char* fmt, ...)æ—¥å¿—çº§åˆ«typedef enum android_LogPriority {  /** For internal use only.  */  ANDROID_LOG_UNKNOWN = 0,  /** The default priority, for internal use only.  */  ANDROID_LOG_DEFAULT, /* only for SetMinPriority() */  /** Verbose logging. Should typically be disabled for a release apk. */  ANDROID_LOG_VERBOSE,  /** Debug logging. Should typically be disabled for a release apk. */  ANDROID_LOG_DEBUG,  /** Informational logging. Should typically be disabled for a release apk. */  ANDROID_LOG_INFO,  /** Warning logging. For use with recoverable failures. */  ANDROID_LOG_WARN,  /** Error logging. For use with unrecoverable failures. */  ANDROID_LOG_ERROR,  /** Fatal logging. For use when aborting. */  ANDROID_LOG_FATAL,  /** For internal use only.  */  ANDROID_LOG_SILENT, /* only for SetMinPriority(); must be last */} android_LogPriority;ä½¿ç”¨ç®€å•ä½¿ç”¨ï¼šint i = 0;__android_log_print(ANDROID_LOG_DEBUG, \"log_tag\", \"this is log:%d\", i++)å®å°è£…ï¼š#include &lt;android/log.h&gt;#define TAG \"tagName\" #define LOGD(...) __android_log_print(ANDROID_LOG_DEBUG,TAG ,__VA_ARGS__) \t// å®šä¹‰LOGDç±»å‹#define LOGI(...) __android_log_print(ANDROID_LOG_INFO,TAG ,__VA_ARGS__) \t\t// å®šä¹‰LOGIç±»å‹ #define LOGW(...) __android_log_print(ANDROID_LOG_WARN,TAG ,__VA_ARGS__) \t\t// å®šä¹‰LOGWç±»å‹ #define LOGE(...) __android_log_print(ANDROID_LOG_ERROR,TAG ,__VA_ARGS__) \t// å®šä¹‰LOGEç±»å‹ #define LOGF(...) __android_log_print(ANDROID_LOG_FATAL,TAG ,__VA_ARGS__) \t// å®šä¹‰LOGFç±»å‹æ”¾åˆ° android_log.h ä¸­ï¼Œä½¿ç”¨æ—¶å€™ #include \"android_log.h\"å³å¯ä½¿ç”¨ï¼šLOGE(\"print a log:%d\", 100); //error logå‚è€ƒ@See https://developer.android.com/ndk/reference/group/logging@See https://blog.csdn.net/u012102149/article/details/86356228"
  },
  
  {
    "title": "æ™¨å…‰çƒ§é¥¼ï¼šä»Šå¤©ä¸‹åˆä¼‘æ¯ï¼Œæ˜å¤©è¥ä¸š",
    "url": "/9812e9ea.html",
    "categories": "ç”Ÿæ´»",
    "tags": "ç”Ÿæ´»",
    "date": "2023-05-03 22:32:36 +0800",
    





    
    "snippet": "ç»å¸¸åƒæ™¨å…‰çƒ§é¥¼ï¼Œå‘³é“å¾ˆä¸é”™ã€‚æ¸…å‹å›­é™„è¿‘çš„æ™¨å…‰çƒ§é¥¼åº—æœ‰æ—¶å€™ä¹°ä¸åˆ°ï¼Œè€æ¿å¤ªæ´’è„±äº†ï¼Œå–å…‰äº†å°±å…³é—¨ğŸ˜‚ï¼Œåˆ«äººä½¿åŠ²åšç”Ÿæ„ï¼Œè€æ¿é¡ºå…¶è‡ªç„¶ï¼Œå–å…‰å°±æ‰“çƒŠï¼Œè¿‡çš„ä»å®¹ä¸è¿«ï¼å¤§å®¶åº”è¯¥éƒ½å¸Œæœ›è‡ªå·±ä¹Ÿæ˜¯è¿™ç§çŠ¶æ€å§ï¼Œæˆ–è€…è¯´å¼€ä¸€å®¶ç±»ä¼¼çš„å°åº—ã€‚æƒ³èµ·è‡ªå·±è„±ç¦»äº†996è‹¦æµ·ï¼Œè¿˜åœ¨995æ–°æµ·é‡ŒæŒ£æ‰ï¼Œæ„Ÿè§‰åˆ«äººæ‰å«ç”Ÿæ´»ï¼Œæˆ‘è¿™æ˜¯ç”Ÿå­˜ï¼Œå¯èƒ½æ˜¯ä¸ºä»¥åç§¯è“„åŠ›é‡å§ã€‚",
    "content": "ç»å¸¸åƒæ™¨å…‰çƒ§é¥¼ï¼Œå‘³é“å¾ˆä¸é”™ã€‚æ¸…å‹å›­é™„è¿‘çš„æ™¨å…‰çƒ§é¥¼åº—æœ‰æ—¶å€™ä¹°ä¸åˆ°ï¼Œè€æ¿å¤ªæ´’è„±äº†ï¼Œå–å…‰äº†å°±å…³é—¨ğŸ˜‚ï¼Œåˆ«äººä½¿åŠ²åšç”Ÿæ„ï¼Œè€æ¿é¡ºå…¶è‡ªç„¶ï¼Œå–å…‰å°±æ‰“çƒŠï¼Œè¿‡çš„ä»å®¹ä¸è¿«ï¼å¤§å®¶åº”è¯¥éƒ½å¸Œæœ›è‡ªå·±ä¹Ÿæ˜¯è¿™ç§çŠ¶æ€å§ï¼Œæˆ–è€…è¯´å¼€ä¸€å®¶ç±»ä¼¼çš„å°åº—ã€‚æƒ³èµ·è‡ªå·±è„±ç¦»äº†996è‹¦æµ·ï¼Œè¿˜åœ¨995æ–°æµ·é‡ŒæŒ£æ‰ï¼Œæ„Ÿè§‰åˆ«äººæ‰å«ç”Ÿæ´»ï¼Œæˆ‘è¿™æ˜¯ç”Ÿå­˜ï¼Œå¯èƒ½æ˜¯ä¸ºä»¥åç§¯è“„åŠ›é‡å§ã€‚"
  },
  
  {
    "title": "Jekyllå¿«é€Ÿæ–°å»ºæ–‡ç« è„šæœ¬",
    "url": "/81e92c74.html",
    "categories": "å·§è®°",
    "tags": "Jekyll",
    "date": "2023-05-03 13:09:39 +0800",
    





    
    "snippet": "Jekyll æ–°å»ºæ–‡ç« å¾ˆéº»çƒ¦ï¼Œé™¤äº†ç²˜è´´å¤åˆ¶å¤´ï¼Œè¿˜è¦æ”¹æ–‡ç« çš„æ ‡é¢˜å’Œæ—¶é—´ï¼Œéå¸¸ç¹çï¼Œä¸‹é¢çš„è„šæœ¬å¯ä»¥è‡ªåŠ¨è·å–æ–‡ç« åˆ›å»ºæ—¶é—´ï¼Œå¹¶æ·»åŠ åŸºç¡€ä¿¡æ¯ï¼Œéå¸¸æ–¹ä¾¿ã€‚åˆ›å»º new-post.sh, æ”¾åˆ°jekyll ç½‘ç«™æ ¹ç›®å½•ï¼Œå³å’Œ_postsåŒçº§ç›®å½•,å†…å®¹å¦‚ä¸‹ï¼šè¿™æ˜¯ä¸€ä¸ªæ¨¡æ¿ä¿¡æ¯ï¼Œä½œè€…ï¼Œåˆ†ç±»ï¼Œæ ‡ç­¾ç­‰éƒ½å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ä¿®æ”¹ã€‚#!/usr/bin/env bashDIR=\"${0%/*}\"title=`echo $@...",
    "content": "Jekyll æ–°å»ºæ–‡ç« å¾ˆéº»çƒ¦ï¼Œé™¤äº†ç²˜è´´å¤åˆ¶å¤´ï¼Œè¿˜è¦æ”¹æ–‡ç« çš„æ ‡é¢˜å’Œæ—¶é—´ï¼Œéå¸¸ç¹çï¼Œä¸‹é¢çš„è„šæœ¬å¯ä»¥è‡ªåŠ¨è·å–æ–‡ç« åˆ›å»ºæ—¶é—´ï¼Œå¹¶æ·»åŠ åŸºç¡€ä¿¡æ¯ï¼Œéå¸¸æ–¹ä¾¿ã€‚åˆ›å»º new-post.sh, æ”¾åˆ°jekyll ç½‘ç«™æ ¹ç›®å½•ï¼Œå³å’Œ_postsåŒçº§ç›®å½•,å†…å®¹å¦‚ä¸‹ï¼šè¿™æ˜¯ä¸€ä¸ªæ¨¡æ¿ä¿¡æ¯ï¼Œä½œè€…ï¼Œåˆ†ç±»ï¼Œæ ‡ç­¾ç­‰éƒ½å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ä¿®æ”¹ã€‚#!/usr/bin/env bashDIR=\"${0%/*}\"title=`echo $@ | sed 's/[ ][ ]*/-/g'`post_date=`date  +\"%Y-%m-%d %T\"`post_name=\"`date \"+%Y-%m-%d\"`-${title}.markdown\"random_addr=`openssl rand -hex 8 | md5 | cut -c1-8`cat &gt; ${DIR}/_posts/${post_name} &lt;&lt; EOF---layout: posttitle:  \"${title}\"description: \"\"author: ä½œè€…date:   ${post_date} +0800permalink: ${random_addr}.htmlcategories:    - åˆ†ç±»tags:    - æ ‡ç­¾---EOF# åˆ›å»ºå®Œæ‰“å¼€æ–‡ç« open ${DIR}/_posts/${post_name}å¦‚æœåˆ›å»ºæ–°æ–‡ç« ï¼Œæ‰§è¡Œ ./new-post.sh æ–‡ç« åå­— å³å¯"
  },
  
  {
    "title": "Jekyllä¸­æ˜¾ç¤ºåŒ…åˆ†å·åŒ…è£¹çš„ä»£ç ",
    "url": "/4f7b855d.html",
    "categories": "å·§è®°",
    "tags": "jekyll",
    "date": "2023-05-03 10:59:19 +0800",
    





    
    "snippet": "åœ¨ Jekyllä¸­å¦‚æœmarkdownæ˜¾ç¤ºç™¾åˆ†å·åŒ…è£¹çš„ä»£ç ï¼Œä¼šå‘ç°ä»£ç ä¸æ˜¾ç¤º, å¯ä»¥ç”¨%åŠ {rawè§£å†³ï¼šè§£å†³ï¼š stackoverflow: https://stackoverflow.com/questions/17720167/how-do-i-include-in-markdown-file-when-using-jekyll",
    "content": "åœ¨ Jekyllä¸­å¦‚æœmarkdownæ˜¾ç¤ºç™¾åˆ†å·åŒ…è£¹çš„ä»£ç ï¼Œä¼šå‘ç°ä»£ç ä¸æ˜¾ç¤º, å¯ä»¥ç”¨%åŠ {rawè§£å†³ï¼šè§£å†³ï¼š stackoverflow: https://stackoverflow.com/questions/17720167/how-do-i-include-in-markdown-file-when-using-jekyll"
  },
  
  {
    "title": "Jekyllä¸»é¢˜Chirpyç®€å•å®¢åˆ¶åŒ–",
    "url": "/0e62f112.html",
    "categories": "å·§è®°",
    "tags": "Jekyll",
    "date": "2023-05-02 23:36:17 +0800",
    





    
    "snippet": "æœ¬åšå®¢ä½¿ç”¨Jekyllç”Ÿæˆï¼Œéƒ¨ç½²åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨çš„æ˜¯Chirpyä¸»é¢˜ï¼Œä¸€æ¬¾éå¸¸ç®€çº¦å´åˆåŠŸèƒ½ä¸°å¯Œçš„ä¸»é¢˜ã€‚æœ‰äº›åœ°æ–¹ä¸ªäººåšäº†å°‘è®¸æ”¹åŠ¨ï¼Œè®°å½•ä¸€ä¸‹ã€‚æ–‡ç« åˆ—è¡¨ç¼©ç•¥å›¾å¢åŠ äº†æ–‡ç« åˆ—è¡¨ç¼©ç•¥å›¾ï¼Œä¸‰ç§å°ºå¯¸ small, medium, large,  æ•ˆæœä¹Ÿå¯æŸ¥é˜…æœ¬åšå®¢é¦–é¡µã€‚ä¿®æ”¹å†…å®¹ä¸º:åœ¨ _layouts/home.html çš„ &lt;div class=\"card-body\"&gt; æ ‡ç­¾ä¸‹å¢åŠ &lt...",
    "content": "æœ¬åšå®¢ä½¿ç”¨Jekyllç”Ÿæˆï¼Œéƒ¨ç½²åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨çš„æ˜¯Chirpyä¸»é¢˜ï¼Œä¸€æ¬¾éå¸¸ç®€çº¦å´åˆåŠŸèƒ½ä¸°å¯Œçš„ä¸»é¢˜ã€‚æœ‰äº›åœ°æ–¹ä¸ªäººåšäº†å°‘è®¸æ”¹åŠ¨ï¼Œè®°å½•ä¸€ä¸‹ã€‚æ–‡ç« åˆ—è¡¨ç¼©ç•¥å›¾å¢åŠ äº†æ–‡ç« åˆ—è¡¨ç¼©ç•¥å›¾ï¼Œä¸‰ç§å°ºå¯¸ small, medium, large,  æ•ˆæœä¹Ÿå¯æŸ¥é˜…æœ¬åšå®¢é¦–é¡µã€‚ä¿®æ”¹å†…å®¹ä¸º:åœ¨ _layouts/home.html çš„ &lt;div class=\"card-body\"&gt; æ ‡ç­¾ä¸‹å¢åŠ &lt;!-- thumb start --&gt; {% if post.image.thumb.enable %}  {% if post.image.thumb.size == 'small' %}    &lt;img class=\"card-thumb-small\" src=\"{{ post.image.path }}\"/&gt;  {% endif %}  {% if post.image.thumb.size == 'medium' %}    &lt;img class=\"card-thumb-medium\" src=\"{{ post.image.path}}\"/&gt;  {% endif %}  {% if post.image.thumb.size == 'large' %}    &lt;img class=\"card-thumb-large\" src=\"{{ post.image.path}}\" /&gt;  {% endif %} {% endif %}&lt;!-- thumb end --&gt;å¢åŠ è‡ªå®šä¹‰cssï¼Œä¿®æ”¹assets/css/style.scss.card-thumb-small {  border-radius: 8px;  margin-right: 20px;  height: 120px;  display: block;  object-fit: cover;  float: left;}.card-thumb-medium {  width: 100%;   margin-bottom: 15px;  border-radius: 8px;  max-height: 125px;  display: block;  object-fit: cover;  float: left;}.card-thumb-large {  width: 100%;   margin-bottom: 15px;  border-radius: 8px;  max-height: 300px;  display: block;  object-fit: cover;  float: left;}@media all and (max-width: 830px) {  .card-thumb-small {    width: 100%;    margin-bottom: 15px;  }}@media all and (min-width: 831px) {  .card-thumb-small {    width: 25%;  }}åˆ›å»ºæ–‡ç« å¤´éƒ¨imageæ ‡ç­¾ä¸‹å¢åŠ thumbå­—æ®µï¼šimage:  path: http://io.fifo.site/typora5691682473820.jpg  alt: android &amp; ffmpeg.  thumb:      enable: false    size: 'medium' #small, medium, largeä»£ç é«˜äº®ä»£ç é«˜äº®å¤´éƒ¨æ”¹ä¸ºmacé£æ ¼æœ‰é¢œè‰²çš„ç‚¹, å¹¶ä¸”å­—ä½“é¢œè‰²ç¨å¾®è°ƒæ·±ä¸€ç‚¹ã€‚å¢åŠ è‡ªå®šä¹‰cssï¼Œä¿®æ”¹assets/css/style.scss.highlight {  .lineno {    color: #999999;  }}.code-header {  &amp;::before {    $dot-size: 0.75rem;    $dot-margin: 0.5rem;    background-color: #ED6C5F;    box-shadow: ($dot-size + $dot-margin) 0 0 #F4BF4F,      ($dot-size + $dot-margin) * 2 0 0 #62C655;  }  /* the label block */  span {    /* label icon */    i {      color: #999999;    }        /* label text */    &amp;::after {      color: #999999;    }  }  button {    i {      color: #999999;    }  }}è¡Œå†…ä»£ç å­—ä½“é¢œè‰²è¡Œå†…ä»£ç å­—ä½“é¢œè‰²ä¿®æ”¹ä¸ºæµ…çº¢ï¼ŒåŸæ¥ä¸ºæµ…ç°ä¸æ˜¯å¤ªæ˜¾çœ¼å¢åŠ è‡ªå®šä¹‰cssï¼Œä¿®æ”¹assets/css/style.scsscode {  &amp;.highlighter-rouge {    color: #BF2D44;    // background-color: #FCF6E5;  }}æ€»ç»“å¯¹åŸä¸»é¢˜çš„ä¾µå…¥æ¯”è¾ƒå°ï¼Œä¸»è¦ä¿®æ”¹äº†csså’Œå°‘é‡home.htmlï¼ŒåæœŸå‡çº§ä¸»é¢˜ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚æ•´ä½“æ”¹å®Œä½¿ç”¨æ•ˆæœéå¸¸ä¸é”™ï¼Œæœ‰éœ€è¦çš„æœ‹å‹å¯ä»¥æŒ‰ç…§ä¸Šé¢æ–¹æ³•ä¿®æ”¹ä¸€ä¸‹ã€‚"
  },
  
  {
    "title": "ç¼–è¯‘Android OpenCV with FFmpegé™æ€åº“",
    "url": "/bian-yi-android-opencv-with-ffmpeg.html",
    "categories": "å·§è®°",
    "tags": "opencv, Android",
    "date": "2023-04-27 08:33:57 +0800",
    





    
    "snippet": "ç¼–è¯‘ç¯å¢ƒ  opencv : 4.6.0  ndk: r21e  os: mac m1 &amp; 13.3.1ç¼–è¯‘è„šæœ¬ä¿®æ”¹ç¼–è¯‘è„šæœ¬opencv/platforms/android/build_sdk.py ä¸­ build_library(self, abi, do_install)å‡½æ•°æ”¹ä¸ºå¦‚ä¸‹def build_library(self, abi, do_install):  cmd = ...",
    "content": "ç¼–è¯‘ç¯å¢ƒ  opencv : 4.6.0  ndk: r21e  os: mac m1 &amp; 13.3.1ç¼–è¯‘è„šæœ¬ä¿®æ”¹ç¼–è¯‘è„šæœ¬opencv/platforms/android/build_sdk.py ä¸­ build_library(self, abi, do_install)å‡½æ•°æ”¹ä¸ºå¦‚ä¸‹def build_library(self, abi, do_install):  cmd = [self.cmake_path, \"-GNinja\"]  cmake_vars = dict(      CMAKE_TOOLCHAIN_FILE=self.get_toolchain_file(),      INSTALL_CREATE_DISTRIB=\"ON\",      WITH_OPENCL=\"OFF\",      BUILD_KOTLIN_EXTENSIONS=\"ON\",      WITH_IPP=(\"ON\" if abi.haveIPP() else \"OFF\"),      WITH_TBB=\"ON\",      BUILD_EXAMPLES=\"OFF\",      BUILD_TESTS=\"OFF\",      BUILD_PERF_TESTS=\"OFF\",      BUILD_DOCS=\"OFF\",      BUILD_ANDROID_EXAMPLES=\"OFF\",      INSTALL_ANDROID_EXAMPLES=\"OFF\",      BUILD_ANDROID_PROJECTS=\"OFF\",      WITH_FFMPEG=\"ON\",      OPENCV_FFMPEG_USE_FIND_PACKAGE=\"ON\",      FFMPEG_DIR=\"../\",  )  if self.ninja_path != 'ninja':      cmake_vars['CMAKE_MAKE_PROGRAM'] = self.ninja_path  if self.debug:      cmake_vars['CMAKE_BUILD_TYPE'] = \"Debug\"  if self.debug_info:  # Release with debug info      cmake_vars['BUILD_WITH_DEBUG_INFO'] = \"ON\"  if self.opencl:      cmake_vars['WITH_OPENCL'] = \"ON\"  if self.no_kotlin:      cmake_vars['BUILD_KOTLIN_EXTENSIONS'] = \"OFF\"  if self.config.modules_list is not None:      cmd.append(\"-DBUILD_LIST='%s'\" % self.config.modules_list)  if self.config.extra_modules_path is not None:      cmd.append(\"-DOPENCV_EXTRA_MODULES_PATH='%s'\" % self.config.extra_modules_path)  if self.use_ccache == True:      cmd.append(\"-DNDK_CCACHE=ccache\")  if do_install:      cmd.extend([\"-DBUILD_TESTS=ON\", \"-DINSTALL_TESTS=ON\"])  cmake_vars.update(abi.cmake_vars)  cmd += [ \"-D%s='%s'\" % (k, v) for (k, v) in cmake_vars.items() if v is not None]  cmd.append(self.opencvdir)  execute(cmd)  # full parallelism for C++ compilation tasks  execute([self.ninja_path, \"opencv_modules\"])  # limit parallelism for building samples (avoid huge memory consumption)  if self.no_samples_build:      execute([self.ninja_path, \"install\" if (self.debug_info or self.debug) else \"install/strip\"])  else:      execute([self.ninja_path, \"-j1\" if (self.debug_info or self.debug) else \"-j3\", \"install\" if (self.debug_info or self.debug) else \"install/strip\"])ä¸»è¦æ˜¯å¢åŠ ä¸€ä¸‹ç¼–è¯‘å‚æ•°æ”¾å¼€ffmpegä¾èµ–ï¼Œä»¥åŠå…³é—­javaç›¸å…³çš„ç¼–è¯‘BUILD_ANDROID_EXAMPLES=\"OFF\",INSTALL_ANDROID_EXAMPLES=\"OFF\",BUILD_ANDROID_PROJECTS=\"OFF\",WITH_FFMPEG=\"ON\",OPENCV_FFMPEG_USE_FIND_PACKAGE=\"ON\",FFMPEG_DIR=\"../\",FFmpegä¾èµ–æŒ‡å®šåˆ›å»º ffmpeg-config.cmakeæ–‡ä»¶ï¼Œä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼Œæ”¾åˆ°å’Œç¼–è¯‘opencvåŒçº§ç›®å½•ï¼Œç”¨æ¥æŒ‡å®šffmpegä¾èµ–çš„é™æ€åº“çš„ä½ç½®å’Œå¤´æ–‡ä»¶ä½ç½®ã€‚set(FFMPEG_LIBDIR \"${CMAKE_CURRENT_LIST_DIR}/../../../libs/mediautils/android/${CMAKE_ANDROID_ARCH_ABI}/Release/ffmpeg\")set(FFMPEG_INCLUDE_DIRS \"${CMAKE_CURRENT_LIST_DIR}/../../../include/mediautils/ffmpeg\")set(FFMPEG_LIBRARIES    ${FFMPEG_LIBDIR}/libavformat.a    ${FFMPEG_LIBDIR}/libavcodec.a    ${FFMPEG_LIBDIR}/libavutil.a    ${FFMPEG_LIBDIR}/libswscale.a    ${FFMPEG_LIBDIR}/libswresample.a    ${FFMPEG_LIBDIR}/libavfilter.a    ${CMAKE_CURRENT_LIST_DIR}/../../../libs/mediautils/android/${CMAKE_ANDROID_ARCH_ABI}/Release/zpx264/libx264.a    z)set(FFMPEG_libavformat_FOUND TRUE)set(FFMPEG_libavcodec_FOUND TRUE)set(FFMPEG_libavutil_FOUND TRUE)set(FFMPEG_libswscale_FOUND TRUE)set(FFMPEG_libswresample_FOUND TRUE)set(FFMPEG_libavfilter_FOUND TRUE)set(FFMPEG_libavcodec_VERSION 59.18.100)set(FFMPEG_libavfilter_VERSION 8.24.100)set(FFMPEG_libavformat_VERSION 59.16.100)set(FFMPEG_libavutil_VERSION 57.17.100)set(FFMPEG_libswresample_VERSION 4.3.100)set(FFMPEG_libswscale_VERSION 6.4.100)set(FFMPEG_FOUND TRUE)set(FFMPEG_LIBS ${FFMPEG_LIBRARIES})  æ³¨æ„ï¼Œæ²¡æœ‰ä¾èµ–çš„é™æ€åº“ä¸è¦å†™åˆ°è„šæœ¬ä¸­ï¼Œå¯èƒ½ä¼šæŠ¥é”™æ·»åŠ ç¼–è¯‘è„šæœ¬åˆ›å»ºbuild-android.sh, å†…å®¹å¦‚ä¸‹ï¼Œå°†æ­¤è„šæœ¬æ”¾åˆ°å’Œopencvæºç åŒçº§ç›®å½•#!/bin/shecho \"start build opencv android platform\"echo \"Current PWD: ${PWD}\"#ndk-buildexport ANDROID_NDK=/Users/admin/works/tools/ndk-r21eexport PATH=$PATH:$ANDROID_NDKrm -rf opencv-buildmkdir opencv-buildcd opencv-buildmkdir static cd staticpython3 ../../opencv/platforms/android/build_sdk.py ./ -Dand\tæ‰§è¡Œ ./build-android.sh å³å¯å…¶ä»–ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šä¸‹è½½TBB, å¦‚ä¸‹è½½ä¸ä¸‹æ¥éœ€è¦é…ç½®ä»£ç†:TBB: Downloading v2020.2.tar.gz from https://github.com/01org/tbb/archive/v2020.2.tar.gz\tå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/472115312?utm_id=0 éå¸¸è¯¦ç»†"
  },
  
  {
    "title": "è®°å½•ä¸‹2023å¹´çš„æ˜¥å¤©",
    "url": "/2023-spring.html",
    "categories": "å°è®°",
    "tags": "life",
    "date": "2023-04-26 08:33:57 +0800",
    





    
    "snippet": "åˆåˆ°äº†æ˜¥å¤©ï¼Œå…¬å¸æ¥¼ä¸‹æœ‰ä¸ªå°èŠ±å›­ï¼Œç”»ç”»è‰è‰éƒ½å‘èŠ½é•¿å¤§ï¼Œå«©ç»¿å«©ç»¿çš„ï¼Œæ°´æ± é‡Œè¿˜æœ‰å¤§å¤§å°å°çš„é”¦é²¤ï¼Œéå¸¸çš„èµææ‚¦ç›®ã€‚å·¥ä½œç´¯äº†ï¼Œæˆ–è€…ä¸­åˆå‚æ™šåƒå®Œé¥­æ¥è¿™é‡Œæºœè¾¾æºœè¾¾ï¼Œå¿ƒæƒ…ä¹Ÿä¼šå˜å¥½ï¼Œç–²æƒ«ä¹Ÿå‡è½»äº›ã€‚å…¬å¸æ¥¼ä¸‹å‡‰äº­èŠ±å›­è—¤è”“å¤ªé˜³å®«åœ°é“ç«™èŠ±èŠ±è‰è‰æ°´å¡˜é”¦é²¤æ°´å¡˜é”¦é²¤",
    "content": "åˆåˆ°äº†æ˜¥å¤©ï¼Œå…¬å¸æ¥¼ä¸‹æœ‰ä¸ªå°èŠ±å›­ï¼Œç”»ç”»è‰è‰éƒ½å‘èŠ½é•¿å¤§ï¼Œå«©ç»¿å«©ç»¿çš„ï¼Œæ°´æ± é‡Œè¿˜æœ‰å¤§å¤§å°å°çš„é”¦é²¤ï¼Œéå¸¸çš„èµææ‚¦ç›®ã€‚å·¥ä½œç´¯äº†ï¼Œæˆ–è€…ä¸­åˆå‚æ™šåƒå®Œé¥­æ¥è¿™é‡Œæºœè¾¾æºœè¾¾ï¼Œå¿ƒæƒ…ä¹Ÿä¼šå˜å¥½ï¼Œç–²æƒ«ä¹Ÿå‡è½»äº›ã€‚å…¬å¸æ¥¼ä¸‹å‡‰äº­èŠ±å›­è—¤è”“å¤ªé˜³å®«åœ°é“ç«™èŠ±èŠ±è‰è‰æ°´å¡˜é”¦é²¤æ°´å¡˜é”¦é²¤"
  },
  
  {
    "title": "å®å¡”é…ç½®ç½‘ç«™404é¡µé¢",
    "url": "/bao-ta-pei-zhi-404.html",
    "categories": "å·§è®°",
    "tags": "jekyll",
    "date": "2023-04-24 11:33:57 +0800",
    





    
    "snippet": "é…ç½®jekyll ç”Ÿæˆé™æ€åšå®¢ï¼Œå¯¹äºæ‰¾ä¸åˆ°çš„é¡µé¢ï¼Œç›´æ¥æ˜¾ç¤º404 not found.éœ€è¦é‡å®šå‘åˆ°ç½‘ç«™çš„404é¡µé¢ï¼Œå³ 404.htmlæ‰¾åˆ°ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š    #ERROR-PAGE-START  é”™è¯¯é¡µé…ç½®ï¼Œå¯ä»¥æ³¨é‡Šã€åˆ é™¤æˆ–ä¿®æ”¹    error_page 404 /404.html;    #error_page 502 /502.html;    #ERROR-PAGE-END   ...",
    "content": "é…ç½®jekyll ç”Ÿæˆé™æ€åšå®¢ï¼Œå¯¹äºæ‰¾ä¸åˆ°çš„é¡µé¢ï¼Œç›´æ¥æ˜¾ç¤º404 not found.éœ€è¦é‡å®šå‘åˆ°ç½‘ç«™çš„404é¡µé¢ï¼Œå³ 404.htmlæ‰¾åˆ°ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š    #ERROR-PAGE-START  é”™è¯¯é¡µé…ç½®ï¼Œå¯ä»¥æ³¨é‡Šã€åˆ é™¤æˆ–ä¿®æ”¹    error_page 404 /404.html;    #error_page 502 /502.html;    #ERROR-PAGE-END    #PHP-INFO-START  PHPå¼•ç”¨é…ç½®ï¼Œå¯ä»¥æ³¨é‡Šæˆ–ä¿®æ”¹    å°† ` error_page 404 /404.html;`çš„æ³¨é‡Šæ”¾å¼€ï¼Œç½‘ç«™æ ¹ç›®å½•ä¸‹è¦æœ‰ 404.html"
  },
  
  {
    "title": "WebRTC Android FFmpegè½¯è§£æŠ¥é”™ H264è§£ç æ‰¾ä¸åˆ°",
    "url": "/webrtc-android-ffmpeg-ruan-jie-bao-cuo-h264jie-ma.html",
    "categories": "RTC",
    "tags": "Android, FFMpeg, h264, WebRTC",
    "date": "2023-04-19 11:20:07 +0800",
    





    
    "snippet": "æŠ¥é”™ï¼š  const AVCodec* codec = avcodec_find_decoder(av_context_-&gt;codec_id);  if (!codec) {    // This is an indication that FFmpeg has not been initialized or it has not    // been compiled/initial...",
    "content": "æŠ¥é”™ï¼š  const AVCodec* codec = avcodec_find_decoder(av_context_-&gt;codec_id);  if (!codec) {    // This is an indication that FFmpeg has not been initialized or it has not    // been compiled/initialized with the correct set of codecs.    RTC_LOG(LS_ERROR) &lt;&lt; \"FFmpeg H.264 decoder not found.\";    Release();    ReportError();    return false;  }å¢åŠ ç¼–è¯‘å‚æ•° rtc\\_use\\_h264=true ä¸ç®¡ç”¨ï¼ä¿®æ”¹ ffmpeg_generated.gniæ‰¾åˆ°third_party/ffmpeg/ffmpeg_generated.gniuse\\_linux\\_configï¼Œæ·»åŠ  || is\\_androidä»¥æ”¯æŒï¼Œç»“æœå¦‚ä¸‹use_linux_config = is_linux || is_fuchsia || is_androidå¢åŠ  codec_list parser_list h264 æ”¯æŒä¿®æ”¹ arm64, ç›¸åº”çš„armv7çš„æ”¹ç›¸åº”ç›®å½•å³å¯chromium/config/Chrome/android/arm64/config.h ä¸­ CONFIG_H264_DECODER è®¾ç½®ä¸º 1third_party/ffmpeg/chromium/config/Chrome/android/arm64/libavcodec/parser_list.c æ·»åŠ  &amp;ff_h264_parser,third_party/ffmpeg/chromium/config/Chrome/android/arm64/libavcodec/codec_list.c æ·»åŠ  &amp;ff_h264_decoderç¼–è¯‘å‚æ•°æ·»åŠ  rtc_use_h264=true ffmpeg_branding=\"Chrome\"å‚è€ƒï¼šhttps://blog.csdn.net/CSqingchen/article/details/120199702"
  },
  
  {
    "title": "Xcodeè¿è¡Œè„šæœ¬æ‰¾ä¸åˆ°ç³»ç»Ÿå‘½ä»¤",
    "url": "/xcode-yun-xing-jiao-ben-zhao-bu-dao-xi-tong-ming-l.html",
    "categories": "å·§è®°",
    "tags": "xocde",
    "date": "2023-03-30 11:33:57 +0800",
    





    
    "snippet": "ç°è±¡ï¼šè„šæœ¬ä¸ºé€šè¿‡é…ç½®åœ¨buildçš„åŒæ—¶è¿è¡Œ.shè„šæœ¬ï¼Œå‡ºç° xxxï¼šcommand not foundç»ˆç«¯ä¸­æ‰§è¡Œæ­£å¸¸ï¼›è§£å†³ 1æŸ¥çœ‹å‘½ä»¤ä½ç½®which ninjaâ€©# è¾“å‡ºâ€©/opt/homebrew/bin/wgetâ€©Xcode æ‰§è¡Œè„šæœ¬ä¸­æ·»åŠ PATH=$PATH:/opt/homebrew/bin/â€©è§£å†³ 2è½¯é“¾ln -s /opt/homebrew/bin/Ninja /usr/loca...",
    "content": "ç°è±¡ï¼šè„šæœ¬ä¸ºé€šè¿‡é…ç½®åœ¨buildçš„åŒæ—¶è¿è¡Œ.shè„šæœ¬ï¼Œå‡ºç° xxxï¼šcommand not foundç»ˆç«¯ä¸­æ‰§è¡Œæ­£å¸¸ï¼›è§£å†³ 1æŸ¥çœ‹å‘½ä»¤ä½ç½®which ninjaâ€©# è¾“å‡ºâ€©/opt/homebrew/bin/wgetâ€©Xcode æ‰§è¡Œè„šæœ¬ä¸­æ·»åŠ PATH=$PATH:/opt/homebrew/bin/â€©è§£å†³ 2è½¯é“¾ln -s /opt/homebrew/bin/Ninja /usr/local/binâ€©å‚è€ƒï¼šhttps://blog.csdn.net/Le_1M/article/details/122673435"
  },
  
  {
    "title": "WordPressä¸­æ–‡åšå®¢ä¸»é¢˜ï¼šSoda Theme",
    "url": "/wordpress-zhong-wen-bo-ke-zhu-tisoda-theme.html",
    "categories": "å·§è®°",
    "tags": "wordpress",
    "date": "2023-03-30 09:39:50 +0800",
    





    
    "snippet": "é¢„è§ˆä¸‹è½½åœ°å€ï¼šhttps://github.com/gezhaoyou/soda-theme/releases/åŠŸèƒ½bug",
    "content": "é¢„è§ˆä¸‹è½½åœ°å€ï¼šhttps://github.com/gezhaoyou/soda-theme/releases/åŠŸèƒ½bug"
  },
  
  {
    "title": "å®‰å“Bitmapè½¬yuv420p(I420)ä»£ç å®ç°",
    "url": "/bitmap-zi-jie-shu-zuargb8888-zhuan-yuv420pi420-jav.html",
    "categories": "RTC",
    "tags": "",
    "date": "2023-03-13 21:38:04 +0800",
    





    
    "snippet": "// è·å–bitmap     Bitmap b = Bitmap.createBitmap(activity.getWindow().getDecorView().getWidth(),                    activity.getWindow().getDecorView().getHeight(), Bitmap.Config.ARGB_8888);         ...",
    "content": "// è·å–bitmap     Bitmap b = Bitmap.createBitmap(activity.getWindow().getDecorView().getWidth(),                    activity.getWindow().getDecorView().getHeight(), Bitmap.Config.ARGB_8888);            Canvas canvas = new Canvas(b);            activity.getWindow().getDecorView().draw(canvas);      int[] argb = new int[inputWidth * inputHeight];       // Bitmap è·å– argb        b.getPixels(argb, 0, inputWidth, 0, 0, inputWidth, inputHeight);        byte[] yuv = new byte[inputWidth * inputHeight * 3 / 2];        // argb 8888 è½¬ i420        conver_argb_to_i420(yuv, argb, inputWidth, inputHeight); // argb 8888 è½¬ i420 public static void conver_argb_to_i420(byte[] i420, int[] argb, int width, int height) {        final int frameSize = width * height;        int yIndex = 0;                   // Y start index        int uIndex = frameSize;           // U statt index        int vIndex = frameSize*5/4; // V start index: w*h*5/4        int a, R, G, B, Y, U, V;        int index = 0;        for (int j = 0; j &lt; height; j++) {            for (int i = 0; i &lt; width; i++) {                a = (argb[index] &amp; 0xff000000) &gt;&gt; 24; //  is not used obviously                R = (argb[index] &amp; 0xff0000) &gt;&gt; 16;                G = (argb[index] &amp; 0xff00) &gt;&gt; 8;                B = (argb[index] &amp; 0xff) &gt;&gt; 0;                // well known RGB to YUV algorithm                Y = ( (  66 * R + 129 * G +  25 * B + 128) &gt;&gt; 8) +  16;                U = ( ( -38 * R -  74 * G + 112 * B + 128) &gt;&gt; 8) + 128;                V = ( ( 112 * R -  94 * G -  18 * B + 128) &gt;&gt; 8) + 128;                // I420(YUV420p) -&gt; YYYYYYYY UU VV                i420[yIndex++] = (byte) ((Y &lt; 0) ? 0 : ((Y &gt; 255) ? 255 : Y));                if (j % 2 == 0 &amp;&amp; i % 2 == 0) {                    i420[uIndex++] = (byte)((U&lt;0) ? 0 : ((U &gt; 255) ? 255 : U));                    i420[vIndex++] = (byte)((V&lt;0) ? 0 : ((V &gt; 255) ? 255 : V));                }                index ++;            }        }    }"
  },
  
  {
    "title": "FFmpegå¸¸ç”¨æ ¼å¼è½¬æ¢å‘½ä»¤",
    "url": "/ffmpeg-chang-yong-ge-shi-zhuan-huan-ming-ling.html",
    "categories": "æ‹™è®°",
    "tags": "FFMpeg",
    "date": "2023-03-12 21:41:56 +0800",
    





    
    "snippet": "åšéŸ³è§†é¢‘å¼€å‘å¯èƒ½ä¼šç”¨åˆ°ä¸€äº› wav, pcm, mp4, yuv ç­‰æµ‹è¯•æ–‡ä»¶ï¼Œæ•´ç†äº†ä¸€ä¸‹å¸¸ç”¨FFmpegå‘½ä»¤ï¼Œå¯ä»¥ä»mp4ä¸­åˆ†ç¦»éŸ³é¢‘æœªwav, wavå¯ä»¥è½¬æˆä¸åŒé‡‡æ ·ç‡çš„ pcm.  mp4 æå–éŸ³é¢‘ä¸ºwavffmpeg -i input.mp4 -acodec pcm_s16le -f s16le -ac 1 -ar 16000 -f wav output.wav  mp4 è½¬yuv420...",
    "content": "åšéŸ³è§†é¢‘å¼€å‘å¯èƒ½ä¼šç”¨åˆ°ä¸€äº› wav, pcm, mp4, yuv ç­‰æµ‹è¯•æ–‡ä»¶ï¼Œæ•´ç†äº†ä¸€ä¸‹å¸¸ç”¨FFmpegå‘½ä»¤ï¼Œå¯ä»¥ä»mp4ä¸­åˆ†ç¦»éŸ³é¢‘æœªwav, wavå¯ä»¥è½¬æˆä¸åŒé‡‡æ ·ç‡çš„ pcm.  mp4 æå–éŸ³é¢‘ä¸ºwavffmpeg -i input.mp4 -acodec pcm_s16le -f s16le -ac 1 -ar 16000 -f wav output.wav  mp4 è½¬yuv420ffmpeg -i input.mp4 -s 720x1280 -pix_fmt yuv420p output.yuv  wav è½¬ pcm 16k 16bitffmpeg -i input.wav -ar 16000 -ac 1 -f s16le output.pcm"
  },
  
  {
    "title": "WebRTCé‡ä¼ åŒ…åˆ¤æ–­",
    "url": "/webrtc-zhong-chuan-bao-pan-duan.html",
    "categories": "RTC",
    "tags": "",
    "date": "2023-03-12 21:41:17 +0800",
    





    
    "snippet": "è°ƒç”¨å¤„bool StreamStatisticianImpl::UpdateOutOfOrder(const RtpPacketReceived&amp; packet,                                              int64_t sequence_number,                                          ...",
    "content": "è°ƒç”¨å¤„bool StreamStatisticianImpl::UpdateOutOfOrder(const RtpPacketReceived&amp; packet,                                              int64_t sequence_number,                                              int64_t now_ms) {  // Check if |packet| is second packet of a stream restart.  if (received_seq_out_of_order_) {    // Count the previous packet as a received; it was postponed below.    --cumulative_loss_;    uint16_t expected_sequence_number = *received_seq_out_of_order_ + 1;    received_seq_out_of_order_ = absl::nullopt;    if (packet.SequenceNumber() == expected_sequence_number) {      // Ignore sequence number gap caused by stream restart for packet loss      // calculation, by setting received_seq_max_ to the sequence number just      // before the out-of-order seqno. This gives a net zero change of      // |cumulative_loss_|, for the two packets interpreted as a stream reset.      //      // Fraction loss for the next report may get a bit off, since we don't      // update last_report_seq_max_ and last_report_cumulative_loss_ in a      // consistent way.      last_report_seq_max_ = sequence_number - 2;      received_seq_max_ = sequence_number - 2;      return false;    }  }  if (std::abs(sequence_number - received_seq_max_) &gt;      max_reordering_threshold_) {    // Sequence number gap looks too large, wait until next packet to check    // for a stream restart.    received_seq_out_of_order_ = packet.SequenceNumber();    // Postpone counting this as a received packet until we know how to update    // |received_seq_max_|, otherwise we temporarily decrement    // |cumulative_loss_|. The    // ReceiveStatisticsTest.StreamRestartDoesntCountAsLoss test expects    // |cumulative_loss_| to be unchanged by the reception of the first packet    // after stream reset.    ++cumulative_loss_;    return true;  }  if (sequence_number &gt; received_seq_max_)    return false;  // Old out of order packet, may be retransmit.  if (enable_retransmit_detection_ &amp;&amp; IsRetransmitOfOldPacket(packet, now_ms))    receive_counters_.retransmitted.AddPacket(packet);  return true;}\t\té‡ä¼ åŒ…åˆ¤æ–­é€»è¾‘bool StreamStatisticianImpl::IsRetransmitOfOldPacket(    const RtpPacketReceived&amp; packet,    int64_t now_ms) const {  uint32_t frequency_khz = packet.payload_type_frequency() / 1000;  RTC_DCHECK_GT(frequency_khz, 0);  int64_t time_diff_ms = now_ms - last_receive_time_ms_;  // Diff in time stamp since last received in order.  uint32_t timestamp_diff = packet.Timestamp() - last_received_timestamp_;  uint32_t rtp_time_stamp_diff_ms = timestamp_diff / frequency_khz;  int64_t max_delay_ms = 0;  // Jitter standard deviation in samples.  float jitter_std = std::sqrt(static_cast&lt;float&gt;(jitter_q4_ &gt;&gt; 4));  // 2 times the standard deviation =&gt; 95% confidence.  // And transform to milliseconds by dividing by the frequency in kHz.  max_delay_ms = static_cast&lt;int64_t&gt;((2 * jitter_std) / frequency_khz);  // Min max_delay_ms is 1.  if (max_delay_ms == 0) {    max_delay_ms = 1;  }  return time_diff_ms &gt; rtp_time_stamp_diff_ms + max_delay_ms;}"
  },
  
  {
    "title": "WebRTCä¸­PacedSenderå·¥ä½œåˆ†æ",
    "url": "/webrtc-zhongpacedsender-gong-zuo-fen-xi.html",
    "categories": "RTC",
    "tags": "",
    "date": "2023-03-12 21:40:20 +0800",
    





    
    "snippet": "æ‘˜æŠ„ä¸€æ®µ PacedSender ç®€ä»‹ï¼Œä¸‹é¢çš„é“¾æ¥å¯¹è¯¥æ¨¡å—çš„å·¥ä½œåŸç†åšäº†è¯¦ç»†çš„ä»‹ç»ï¼Œä»Šå¤©å¤§è‡´çœ‹äº†ä¸‹è¿™ä¸ªæ¨¡å—çš„ä»£ç ï¼Œè®°å½•ä¸€ä¸‹  åœ¨estimatoræ ¹æ®ç½‘ç»œçŠ¶æ€å†³ç­–å‡ºæ–°çš„é€šä¿¡ç ç‡ï¼ˆtarget bitrateï¼‰ï¼Œå®ƒä¼šå°†è¿™ä¸ªç ç‡è®¾ç½®åˆ°pacerå½“ä¸­ï¼Œè¦æ±‚paceræŒ‰ç…§æ–°çš„ç ç‡æ¥è®¡ç®—å‘åŒ…é¢‘ç‡ã€‚å› ä¸ºåœ¨è§†é¢‘é€šä¿¡ä¸­ï¼Œå•å¸§è§†é¢‘å¯èƒ½æœ‰ä¸Šç™¾KB,å¦‚æœæ˜¯å½“è§†é¢‘å¸§è¢«ç¼–ç å™¨ç¼–ç å‡ºæ¥åï¼Œå°±ç«‹å³è¿›è¡ŒRTPæ‰“åŒ…å‘é€ï¼Œç¬æ—¶...",
    "content": "æ‘˜æŠ„ä¸€æ®µ PacedSender ç®€ä»‹ï¼Œä¸‹é¢çš„é“¾æ¥å¯¹è¯¥æ¨¡å—çš„å·¥ä½œåŸç†åšäº†è¯¦ç»†çš„ä»‹ç»ï¼Œä»Šå¤©å¤§è‡´çœ‹äº†ä¸‹è¿™ä¸ªæ¨¡å—çš„ä»£ç ï¼Œè®°å½•ä¸€ä¸‹  åœ¨estimatoræ ¹æ®ç½‘ç»œçŠ¶æ€å†³ç­–å‡ºæ–°çš„é€šä¿¡ç ç‡ï¼ˆtarget bitrateï¼‰ï¼Œå®ƒä¼šå°†è¿™ä¸ªç ç‡è®¾ç½®åˆ°pacerå½“ä¸­ï¼Œè¦æ±‚paceræŒ‰ç…§æ–°çš„ç ç‡æ¥è®¡ç®—å‘åŒ…é¢‘ç‡ã€‚å› ä¸ºåœ¨è§†é¢‘é€šä¿¡ä¸­ï¼Œå•å¸§è§†é¢‘å¯èƒ½æœ‰ä¸Šç™¾KB,å¦‚æœæ˜¯å½“è§†é¢‘å¸§è¢«ç¼–ç å™¨ç¼–ç å‡ºæ¥åï¼Œå°±ç«‹å³è¿›è¡ŒRTPæ‰“åŒ…å‘é€ï¼Œç¬æ—¶ä¼šå‘é€å¤§é‡çš„æ•°æ®åˆ°ç½‘ç»œä¸Šï¼Œå¯èƒ½ä¼šå¼•èµ·ç½‘ç»œè¡°å‡å’Œé€šä¿¡æ¶åŒ–ã€‚WebRTCå¼•å…¥pacerï¼Œpacerä¼šæ ¹æ®estimatorè¯„ä¼°å‡ºæ¥çš„ç ç‡ï¼ŒæŒ‰ç…§æœ€å°å•ä½æ—¶é—´ï¼ˆ5msï¼‰åšæ—¶é—´åˆ†ç‰‡è¿›è¡Œé€’è¿›å‘é€æ•°æ®ï¼Œé¿å…ç¬æ—¶å¯¹ç½‘ç»œçš„å†²å‡»ã€‚pacerçš„ç›®çš„å°±æ˜¯è®©è§†é¢‘æ•°æ®æŒ‰ç…§è¯„ä¼°ç ç‡å‡åŒ€çš„åˆ†å¸ƒåœ¨å„ä¸ªæ—¶é—´ç‰‡é‡Œå‘é€ï¼Œ æ‰€ä»¥åœ¨å¼±ç½‘çš„WiFiç¯å¢ƒï¼Œpaceræ˜¯ä¸ªéå¸¸é‡è¦çš„å…³é”®æ­¥éª¤  via: http://livevideostack.com/portal.php?mod=view&amp;aid=201PacedSender å‘é€é€Ÿç‡è®¾ç½®GCC ä¼°æµ‹çš„å¸¦å®½åªä¼šé€šè¿‡ SetEstimatedBitrate æ–¹æ³•è®¾ç½®åˆ° PacedSender ä¸­ï¼Œ pacing_bitrate_kbps_ ä¸º PacedSender å‘é€åª’ä½“åŒ…çš„é€Ÿç‡ï¼Œä¸ºGCCä¼°æµ‹å¸¦å®½ ä¹˜ä»¥äº†å›ºå®šç³»æ•° kDefaultPaceMultiplier(2.5)void PacedSender::SetEstimatedBitrate(uint32_t bitrate_bps) {  if (bitrate_bps == 0)    LOG(LS_ERROR) &lt;&lt; \"PacedSender is not designed to handle 0 bitrate.\";  CriticalSectionScoped cs(critsect_.get());  estimated_bitrate_bps_ = bitrate_bps;  padding_budget_-&gt;set_target_rate_kbps(estimated_bitrate_bps_ / 1000 );  // æ›´æ–° pacing å‘é€é€Ÿç‡ï¼Œä¸º estimated_bitrate_bps_/1000 * 2.5;  pacing_bitrate_kbps_ =      max(min_send_bitrate_kbps_, estimated_bitrate_bps_ / 1000) *      kDefaultPaceMultiplier;  alr_detector_-&gt;SetEstimatedBitrate(bitrate_bps);}PacedSender åŒ…ç¼“å­˜é˜Ÿåˆ—è¯¥æ–¹æ³•ç”± rtp_sender æ¨¡å—è°ƒç”¨ï¼Œå°†å°è£…å¥½çš„è§†é¢‘rtpåŒ…çš„å…ƒä¿¡æ¯ï¼Œå¦‚ ssrc, sequence_numberç­‰å°è£…æˆPacketæ•°æ®ç»“æ„å­˜å‚¨åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶æœªç¼“å­˜çœŸæ­£çš„åª’ä½“æ•°æ®ã€‚å‘åŒ…æ—¶ï¼ŒPacedSender ä¼šé€šè¿‡è¿™äº›å…ƒä¿¡æ¯ï¼Œåœ¨rtp_senderä¸­çš„ç¼“å­˜é˜Ÿåˆ—ä¸­æ‰¾åˆ°å¯¹åº”çš„åª’ä½“åŒ…æ•°æ®// å°†è§†é¢‘åŒ…å…ƒä¿¡æ¯ï¼Œinstertåˆ°pacerä¸­void PacedSender::InsertPacket(RtpPacketSender::Priority priority,                               uint32_t ssrc,                               uint16_t sequence_number,                               int64_t capture_time_ms,                               size_t bytes,                               bool retransmission) {  CriticalSectionScoped cs(critsect_.get());  DCHECK(estimated_bitrate_bps_ &gt; 0)        &lt;&lt; \"SetEstimatedBitrate must be called before InsertPacket.\";  int64_t now_ms = clock_-&gt;TimeInMilliseconds();  prober_-&gt;OnIncomingPacket(bytes);  if (capture_time_ms &lt; 0)    capture_time_ms = now_ms;  // å°è£… packet åŒ…ï¼Œæ”¾åˆ°listä¸­ packets_  packets_-&gt;Push(paced_sender::Packet(priority, ssrc, sequence_number,                                      capture_time_ms, now_ms, bytes,                                      retransmission, packet_counter_++));}å‘åŒ…çº¿ç¨‹çº¿ç¨‹å‘åŒ…é—´éš” 5ms è®¡ç®—PacedSender å‘é€çº¿ç¨‹æ˜¯è°ƒç”¨æ—¶é—´é—´éš”ä¸º5msï¼Œä¸ºä»€ä¹ˆæ˜¯5ms, é€šè¿‡æ¨¡å—ä¸­ä¸‹é¢çš„æ–¹æ³•è®¡ç®—çš„ï¼š// è®¡ç®—çº¿ç¨‹è°ƒç”¨çš„æ—¶é—´é—´éš”ï¼Œå³ä¸‹é¢ process() æ–¹æ³•è°ƒç”¨çš„æ—¶é—´é—´éš” ï¼ï¼ï¼ï¼int64_t PacedSender::TimeUntilNextProcess() {  CriticalSectionScoped cs(critsect_.get());    //  å¦‚æœæ­£åœ¨æ¢æµ‹    if (prober_-&gt;IsProbing()) {    int64_t ret = prober_-&gt;TimeUntilNextProbe(clock_-&gt;TimeInMilliseconds());    if (ret &gt; 0 || (ret == 0 &amp;&amp; !probing_send_failure_))      return ret;  }  // å½“å‰æ—¶é—´ å‡å» ä¸Šä¸€æ¬¡ processï¼ˆï¼‰æ–¹æ³•è°ƒç”¨çš„æ—¶é—´ï¼Œå¾—å‡ºæ—¶é—´é—´éš”  int64_t elapsed_time_us = clock_-&gt;TimeInMicroseconds() - time_last_update_us_;  int64_t elapsed_time_ms = (elapsed_time_us + 500) / 1000;      // kMinPacketLimitMsï¼š5msï¼Œå³ process() æ–¹æ³• 5m å¤„ç†ä¸€æ¬¡  return std::max&lt;int64_t&gt;(kMinPacketLimitMs - elapsed_time_ms, 0);}kMinPacketLimitMs çš„å€¼ä¸ºå›ºå®š 5ms, elapsed_time_msä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸ºä¸Šä¸€æ¬¡è°ƒç”¨ processåˆ°ç°åœ¨çš„æ—¶é—´é—´éš”ï¼Œä¸¤ä¸ªçš„æ—¶é—´å·®å³ä¸ºçº¿ç¨‹è¦ç­‰å¾…çš„æ—¶é•¿ï¼Œæœ€å¤§5msï¼Œä¹‹åçº¿ç¨‹ä¼šå†æ¬¡è°ƒç”¨process æ–¹æ³•å‘é€åª’ä½“æ•°æ®ã€‚çº¿ç¨‹å¤„ç†æ–¹æ³• process()ä¸‹é¢çš„ process() æ–¹æ³•ä¸­å¤„ç†çœŸæ­£å‘åŒ…é€»è¾‘ï¼Œ æ¯æ¬¡è¿›å…¥ process éƒ½ä¼šè°ƒç”¨ UpdateBudgetWithElapsedTime(elapsed_time_ms), å»æ›´æ–°(å¢åŠ ) media_budget_ä¸­çš„ bytes_remaining_ ,bytes_remaining_ ä¸ºæ¯æ¬¡å¯ä»¥å‘é€åŒ…çš„æœ€å¤§å­—èŠ‚æ•°ï¼š  å‘åŒ…é‡ = Î”t x GCCåé¦ˆå¸¦å®½ x 2.5Î”t å³elapsed_time_ms, æœ€å¤§ 5msã€‚ åœ¨ä¸‹é¢çš„while å¾ªç¯ä¸­ï¼Œåªè¦åŒ…é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå°±ä¸€ç›´å°è¯•ç”¨SendPacketå»å‘åŒ…ã€‚int32_t PacedSender::Process() {  int64_t now_us = clock_-&gt;TimeInMicroseconds();  CriticalSectionScoped cs(critsect_.get());    // elapsed_time_ms: ä¸Šä¸€æ¬¡processå’Œè¿™æ¬¡process ä¹‹é—´çš„æ—¶é—´é—´éš” elapsed_time_ms  ms  int64_t elapsed_time_ms = (now_us - time_last_update_us_ + 500) / 1000;  time_last_update_us_ = now_us;  int target_bitrate_kbps = pacing_bitrate_kbps_; // æ‹¿åˆ°æœ€æ–°çš„ pacer å‘é€é€Ÿç‡  if (!paused_ &amp;&amp; elapsed_time_ms &gt; 0) {    // ç¼“å­˜çš„æ‰€æœ‰çš„åŒ…çš„å¤§å°ï¼ŒæŒ‰å­—èŠ‚ç®—    size_t queue_size_bytes = packets_-&gt;SizeInBytes();    if (queue_size_bytes &gt; 0) {      // Assuming equal size packets and input/output rate, the average packet      // has avg_time_left_ms left to get queue_size_bytes out of the queue, if      // time constraint shall be met. Determine bitrate needed for that.      packets_-&gt;UpdateQueueTime(clock_-&gt;TimeInMilliseconds());      int64_t avg_time_left_ms = std::max&lt;int64_t&gt;(          1, kMaxQueueLengthMs - packets_-&gt;AverageQueueTimeMs()); // è¿™ä¸ªåœ°æ–¹åº”è¯¥æ˜¯ å·²ç»ç¼“å­˜åŒ…æ—¶é•¿ = æœ€å¤§ç¼“å­˜æ—¶é•¿ - å‰©ä½™é˜Ÿåˆ—æ—¶é•¿      int min_bitrate_needed_kbps =          static_cast&lt;int&gt;(queue_size_bytes * 8 / avg_time_left_ms);      if (min_bitrate_needed_kbps &gt; target_bitrate_kbps)        target_bitrate_kbps = min_bitrate_needed_kbps; // å¦‚æœè®¡ç®—å‡ºæ¥çš„å‘é€é€Ÿç‡æ¯”ä¸Šé¢ä¼ å…¥çš„ ç›®æ ‡å‘é€ç ç‡å¤§ï¼Œåˆ™æ›´æ–°ç›®æ ‡å‘é€ç ç‡    }    //  media budget æ›´æ–°å‘é€é€Ÿç‡    media_budget_-&gt;set_target_rate_kbps(target_bitrate_kbps);    // æœ€å¤§æ—¶é—´é—´éš” kMaxIntervalTimeMs = 30 ms    elapsed_time_ms = min(kMaxIntervalTimeMs, elapsed_time_ms);    UpdateBudgetWithElapsedTime(elapsed_time_ms);  }  bool is_probing = prober_-&gt;IsProbing();  PacedPacketInfo pacing_info;  size_t bytes_sent = 0;  size_t recommended_probe_size = 0;  if (is_probing) {    pacing_info = prober_-&gt;CurrentCluster();    recommended_probe_size = prober_-&gt;RecommendedMinProbeSize();  }      // é˜Ÿåˆ—ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹  while (!packets_-&gt;Empty()) {    // Since we need to release the lock in order to send, we first pop the    // element from the priority queue but keep it in storage, so that we can    // reinsert it if send fails.    const paced_sender::Packet&amp; packet = packets_-&gt;BeginPop();    // å»é™¤ é˜Ÿåˆ—ä¸­çš„åŒ…ï¼Œå¹¶å¼€å§‹å‘é€    if (SendPacket(packet, pacing_info)) {      // Send succeeded, remove it from the queue.      // å‘é€æˆåŠŸï¼Œåˆ™è®°å½•å‘é€çš„å­—èŠ‚æ•°ï¼Œå¹¶ä»é˜Ÿåˆ—ä¸­å°†åŒ…æ¸…é™¤      bytes_sent += packet.bytes;      packets_-&gt;FinalizePop(packet);//        æ¢æµ‹æœŸé—´ï¼Œæˆ–å‘é€å­—èŠ‚æ•°è¶…è¿‡æ¢æµ‹çš„æ•°å€¼äº†ï¼Œåˆ™è·³å‡ºå¾ªç¯ä¸å†å‘é€   è¿™ä¸ªåœ°æ–¹å’Œæ¢æµ‹æœ‰å…³ï¼Œæ˜¯å¦æœ‰é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ      if (is_probing &amp;&amp; bytes_sent &gt; recommended_probe_size)        break;    } else {      // Send failed, put it back into the queue.      packets_-&gt;CancelPop(packet);      break;    }  }  if (packets_-&gt;Empty() &amp;&amp; !paused_) {    // We can not send padding unless a normal packet has first been sent. If we    // do, timestamps get messed up.    if (packet_counter_ &gt; 0) {    // è®¡ç®—æ˜¯å¦åº”è¯¥å‘é€ padding åŒ…    int padding_needed = static_cast&lt;int&gt;(is_probing ? (recommended_probe_size - bytes_sent) : padding_budget_-&gt;bytes_remaining());                if (padding_needed &gt; 0) {          bytes_sent += SendPadding(padding_needed, pacing_info);        }    }  }      if (is_probing) {    probing_send_failure_ = bytes_sent == 0;    if (!probing_send_failure_)      prober_-&gt;ProbeSent(clock_-&gt;TimeInMilliseconds(), bytes_sent);  }  alr_detector_-&gt;OnBytesSent(bytes_sent, now_us / 1000);  return 0;}å‘åŒ…æ–¹æ³•SendPacket()è¯¥æ–¹æ³•ç”±ä¸Šé¢çš„whileå‘åŒ…å¾ªç¯è°ƒç”¨ï¼Œå‘åŒ…åä¼šè°ƒç”¨ UpdateBudgetWithBytesSent(packet.bytes) ä» media_budget_ å‡å»packet.bytesé•¿åº¦çš„å‘åŒ…é¢„ç®—, å½“å‘åšåŒ…å¾ªç¯èµ°å‡ æ¬¡ä¹‹åï¼Œmedia_budgetä¸­çš„é¢„ç®—é•¿åº¦è¢«æ¶ˆè€—å®Œï¼Œå³ &lt;= 0ï¼Œ æ­¤æ—¶ media_budget_-&gt;bytes_remaining() æ–¹æ³•ä¼šåš max(0, bytes_remaining_) å¤„ç†ï¼Œå³è¿”å›0 ï¼Œè€Œå‘åŒ…å‰ä¼šåˆ¤æ–­ media_budget_-&gt;bytes_remaining() == 0 ,æ»¡è¶³æ¡ä»¶å°±return falseä¸å‘äº†ã€‚bool PacedSender::SendPacket(const paced_sender::Packet&amp; packet,                             const PacedPacketInfo&amp; pacing_info) {    // æ˜¯å¦æš‚åœå‘åŒ…    if (paused_)    return false;            //  media  budget å‰©ä½™é¢„ç®—å­—èŠ‚æ•°ä¸º 0ï¼Œåœæ­¢å‘åŒ…  if (media_budget_-&gt;bytes_remaining() == 0 &amp;&amp;      pacing_info.probe_cluster_id == PacedPacketInfo::kNotAProbe) {    return false;  }  critsect_-&gt;Enter();  const bool success = packet_sender_-&gt;TimeToSendPacket(      packet.ssrc, packet.sequence_number, packet.capture_time_ms,      packet.retransmission, pacing_info);  critsect_-&gt;Leave();  if (success) {    // TODO(holmer): High priority packets should only be accounted for if we    // are allocating bandwidth for audio.    if (packet.priority != kHighPriority) { // åŒ…çš„ä¼˜å…ˆçº§ä¸ä¸ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œæ›´æ–°å‘é€çš„å­—èŠ‚æ•°      // Update media bytes sent.      UpdateBudgetWithBytesSent(packet.bytes);    }  }  return success;}SendPacket æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨ rtp_senderä¸­çš„æ–¹æ³•ï¼Œå°†ssrcï¼Œsequence_number ç­‰å‚æ•°ä¼ é€’è¿‡å»ï¼Œrtp_senderé€šè¿‡è¿™äº›å€¼æ‰¾åˆ°çœŸæ­£çš„è§†é¢‘åª’ä½“åŒ…ï¼Œæœ€ç»ˆå‘é€åˆ°åˆ°ç½‘ç»œä¸Šã€‚media_budgetç®€ä»‹media_budget æ˜¯åœ¨ PacedSenderä¸­å°è£…çš„ä¸€ä¸ªç±»ï¼Œå…¨éƒ¨ä»£ç å¦‚ä¸‹ï¼Œæ³¨é‡Šåšäº†è§£é‡Šï¼šclass IntervalBudget { public:  explicit IntervalBudget(int initial_target_rate_kbps)      : target_rate_kbps_(initial_target_rate_kbps),        bytes_remaining_(0) {}  void set_target_rate_kbps(int target_rate_kbps) {    //æ›´æ–°å‘é€é€Ÿç‡    target_rate_kbps_ = target_rate_kbps;      bytes_remaining_ =        max(-kWindowMs * target_rate_kbps_ / 8, bytes_remaining_);  }  void IncreaseBudget(int64_t delta_time_ms) {    // ä¼°è®¡åœ¨ delta æ—¶é—´ï¼Œ åœ¨å¸¦å®½ä¸º target_rate_kbps çš„æƒ…å†µå¯ä»¥å‘é€å‡ºå»å¤šå°‘å­—èŠ‚    int64_t bytes = target_rate_kbps_ * delta_time_ms / 8;          if (bytes_remaining_ &lt; 0) {      // We overused last interval, compensate this interval.      bytes_remaining_ = bytes_remaining_ + bytes;    } else {      // If we underused last interval we can't use it this interval.      bytes_remaining_ = bytes;    }  }  //æ›´æ–°å®é™…å‘é€çš„å­—èŠ‚æ•°ï¼Œ ä»bytes_remaining_å‡å»  void UseBudget(size_t bytes) {    bytes_remaining_ = max(bytes_remaining_ - static_cast&lt;int&gt;(bytes),                                -kWindowMs * target_rate_kbps_ / 8);  }  // å‡ æ¬¡å‘é€å¾ªç¯åï¼Œå‘é€çš„æ€»å­—èŠ‚æ•°å¤§äºå¼€å§‹çš„ bytes_remaining_ï¼Œbytes_remaining_ &lt;= 0ï¼Œæ”¹æ–¹æ³•è¿”å›0  size_t bytes_remaining() const {    return static_cast&lt;size_t&gt;(max(0, bytes_remaining_));  }  int target_rate_kbps() const { return target_rate_kbps_; } private:  static const int kWindowMs = 500; // window 500 ms  int target_rate_kbps_;  int bytes_remaining_;};PacedSender åŸç†æ€»ç»“åˆ°è¿™å¯ä»¥çŸ¥é“PacedSenderå·¥ä½œåŸç†äº†, æ¯æ¬¡å‘åŒ…å‰ä¼šæ›´æ–°media_budgetä¸­é¢„ç®—bytes_remaining_ çš„å¤§å°ï¼Œè€Œæ¯æ¬¡å‘é€æ—¶é—´(&lt;= 5ms)å†…æœ€å¤šå‘é€ bytes_remaining_ å­—èŠ‚æ•°ï¼Œä»è€Œè¾¾åˆ°é™åˆ¶å’Œå¹³æ»‘å¸¦å®½çš„ç›®çš„ï¼ŒPacedSender ä¸­ paddingå‘é€çš„åŸç†å’Œæ­¤ç±»ä¼¼ã€‚"
  },
  
  {
    "title": "OpenCV VideoWriterå½•åˆ¶mp4å¹¶ä¿®æ”¹è§†é¢‘ç ç‡",
    "url": "/opencv-videowriter-lu-zhimp4bing-xiu-gai-shi-pin-m.html",
    "categories": "æ‹™è®°",
    "tags": "OpenCV",
    "date": "2023-03-12 21:39:29 +0800",
    





    
    "snippet": "OpenCVç‰ˆæœ¬ opencv-4.5.3å°è£…è®¾ç½®è§†é¢‘ç ç‡é€»è¾‘ä¿®æ”¹opencvæºç  modules/videoio/include/opencv2/videoio.hppä¿®æ”¹ 197è¡Œ, æ·»åŠ  VIDEOWRITER_PROP_BITRATE = 9,enum VideoWriterProperties {  VIDEOWRITER_PROP_QUALITY = 1,    //!&lt; ...",
    "content": "OpenCVç‰ˆæœ¬ opencv-4.5.3å°è£…è®¾ç½®è§†é¢‘ç ç‡é€»è¾‘ä¿®æ”¹opencvæºç  modules/videoio/include/opencv2/videoio.hppä¿®æ”¹ 197è¡Œ, æ·»åŠ  VIDEOWRITER_PROP_BITRATE = 9,enum VideoWriterProperties {  VIDEOWRITER_PROP_QUALITY = 1,    //!&lt; Current quality (0..100%) of the encoded videostream. Can be adjusted dynamically in some codecs.  VIDEOWRITER_PROP_FRAMEBYTES = 2, //!&lt; (Read-only): Size of just encoded video frame. Note that the encoding order may be different from representation order.  VIDEOWRITER_PROP_NSTRIPES = 3,   //!&lt; Number of stripes for parallel encoding. -1 for auto detection.  VIDEOWRITER_PROP_IS_COLOR = 4,   //!&lt; If it is not zero, the encoder will expect and encode color frames, otherwise it                                   //!&lt; will work with grayscale frames.  VIDEOWRITER_PROP_DEPTH = 5,      //!&lt; Defaults to CV_8U.  VIDEOWRITER_PROP_HW_ACCELERATION = 6, //!&lt; (**open-only**) Hardware acceleration type (see #VideoAccelerationType). Setting supported only via `params` parameter in VideoWriter constructor / .open() method. Default value is backend-specific.  VIDEOWRITER_PROP_HW_DEVICE       = 7, //!&lt; (**open-only**) Hardware device index (select GPU if multiple available). Device enumeration is acceleration type specific.  VIDEOWRITER_PROP_HW_ACCELERATION_USE_OPENCL= 8, //!&lt; (**open-only**) If non-zero, create new OpenCL context and bind it to current thread. The OpenCL context created with Video Acceleration context attached it (if not attached yet) for optimized GPU data copy between cv::UMat and HW accelerated encoder.  VIDEOWRITER_PROP_BITRATE = 9,#ifndef CV_DOXYGEN  CV__VIDEOWRITER_PROP_LATEST#endif};ä¿®æ”¹ modules/videoio/src/cap_avfoundation.mm 228è¡Œå·¦å³ï¼Œè·å–ç ç‡å‚æ•°:cv::Ptr&lt;cv::IVideoWriter&gt; cv::create_AVFoundation_writer(const std::string&amp; filename, int fourcc,                                                         double fps, const cv::Size &amp;frameSize,                                                         const cv::VideoWriterParameters&amp; params){    CvSize sz = { frameSize.width, frameSize.height };    const bool isColor = params.get(VIDEOWRITER_PROP_IS_COLOR, true);    const int bitrate = params.get(VIDEOWRITER_PROP_BITRATE, 600000);    CvVideoWriter_AVFoundation* wrt = new CvVideoWriter_AVFoundation(filename.c_str(), fourcc, fps, sz, bitrate, isColor);    return cv::makePtr&lt;cv::LegacyWriter&gt;(wrt);}ä¿®æ”¹1202è¡Œå·¦å³ï¼Œä¿®æ”¹ CvVideoWriter_AVFoundationæ„é€ å‡½æ•°ï¼Œæ·»åŠ  int bitrate å‚æ•°ï¼šCvVideoWriter_AVFoundation::CvVideoWriter_AVFoundation(const char* filename, int fourcc,        double fps, CvSize frame_size,        int bitrate, int is_color) {ä¿®æ”¹ 1306è¡Œå·¦å³ï¼Œå°†ç ç‡è®¾ç½®ç»™ AVAssetWriterInputNSDictionary* videoCompressionSetting = [NSDictionary dictionaryWithObjectsAndKeys:        [NSNumber numberWithInteger:bitrate], AVVideoAverageBitRateKey,        nil]; // è®¾ç½® AVAssetWriterInput ç¼–ç ç ç‡NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:        codec, AVVideoCodecKey,        [NSNumber numberWithInt:movieSize.width], AVVideoWidthKey,        [NSNumber numberWithInt:movieSize.height], AVVideoHeightKey,        videoCompressionSetting, AVVideoCompressionPropertiesKey,        nil]; mMovieWriterInput = [[AVAssetWriterInput        assetWriterInputWithMediaType:AVMediaTypeVideo        outputSettings:videoSettings] retain];æ‰€æœ‰ä¿®æ”¹å®Œæˆç¼–è¯‘iOS OpenCVopencvæºç æ ¹ç›®å½•æ‰§è¡Œpython platforms/ios/build_framework.py ios --iphoneos_archs armv7,arm64 --iphonesimulator_archs i386,x86_64ä½¿ç”¨åˆ›å»ºé…ç½® cv::VideoWriter å¹¶è®¾ç½®è§†é¢‘ç ç‡cv::VideoWriter writer;cv::Size size = cv::Size(480, 640);  int myFourcc = cv::VideoWriter::fourcc('H', '2', '6', '4');  double fps = 30;  std::vector&lt;int&gt; vect;  vect.push_back(cv::VIDEOWRITER_PROP_BITRATE);  vect.push_back(450*1000); // æ›´æ”¹ video ç ç‡  // outputPath = @\"document/video.mp4\" å­˜å‚¨è·¯å¾„  writer.open([outputPath UTF8String], cv::CAP_AVFOUNDATION, myFourcc, fps, size, vect);ä¹‹åå¯ä»¥æ„‰å¿«çš„å½•åˆ¶mp4æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶ç”Ÿæˆæ–‡ä»¶ç ç‡å‚è€ƒï¼š  AVAssetWriterè§†é¢‘æ•°æ®ç¼–ç   AVAssetWriter å®ç°é«˜åˆ†è¾¨ç‡å½•åˆ¶è§†é¢‘ï¼Œç”Ÿæˆä½ä½“ç§¯çš„è§†é¢‘æ–‡ä»¶  iOS ç¼–è¯‘OpenCV"
  },
  
  {
    "title": "Compile ffmpeg 4.2.1 for mac os with openssl",
    "url": "/compile-ffmpeg-421-for-mac-os-with-openssl.html",
    "categories": "æ‹™è®°",
    "tags": "",
    "date": "2023-03-12 21:38:58 +0800",
    





    
    "snippet": "ç¼–è¯‘ç¯å¢ƒï¼šmac os x 10.15.3 ï¼Œ ffmpeg 4.2.1./configure --target-os=darwin \\            --disable-programs  \\            --libdir=./ffmpegbuild/lib \\            --incdir=./ffmpegbuild/include  \\           ...",
    "content": "ç¼–è¯‘ç¯å¢ƒï¼šmac os x 10.15.3 ï¼Œ ffmpeg 4.2.1./configure --target-os=darwin \\            --disable-programs  \\            --libdir=./ffmpegbuild/lib \\            --incdir=./ffmpegbuild/include  \\            --extra-cflags=-mmacosx-version-min=10.8 \\            --extra-ldflags=-mmacosx-version-min=10.8  \\            --enable-pic \\            --enable-dct \\            --enable-dwt \\            --enable-lsp \\            --enable-mdct \\            --enable-rdft \\            --enable-fft \\            --enable-runtime-cpudetect \\            --disable-ffmpeg \\            --disable-ffplay \\            --disable-ffprobe \\            --disable-doc \\            --disable-symver \\            --disable-protocols \\            --enable-small \\            --enable-gpl --enable-nonfree --enable-version3 --disable-iconv \\            --disable-decoders --enable-decoder=vp9 --enable-decoder=h264 --enable-decoder=mpeg4 --enable-decoder=aac --enable-decoder=mp3 --enable-decoder=flac --enable-decoder=pcm_s16le \\            --disable-encoders \\            --disable-demuxers --enable-demuxer=rtsp --enable-demuxer=rtp --enable-demuxer=flv --enable-demuxer=h264 --enable-demuxer=wav --enable-demuxer=aac \\            --enable-demuxer=hls --enable-demuxer=mp3 --enable-muxer=ogg --enable-demuxer=flac \\            --enable-demuxer=amr --enable-decoder=amrwb --enable-decoder=amrnb --enable-demuxer=wav --enable-decoder=wavpack --enable-demuxer=avi \\            --disable-muxers --enable-muxer=rtsp --enable-muxer=rtp --enable-muxer=flv --enable-muxer=h264 --enable-muxer=mp4 --enable-muxer=wav --enable-muxer=adts \\            --disable-parsers --enable-parser=mpeg4video --enable-parser=aac --enable-parser=h264 --enable-parser=vp9 \\            --enable-decoder=jpeg2000 \\            --enable-decoder=jpegls \\            --enable-decoder=mjpeg \\            --enable-decoder=mjpegb \\            --enable-muxer=mjpeg \\            --enable-demuxer=mjpeg \\            --enable-encoder=png \\            --enable-decoder=png \\            --enable-parser=png \\            --enable-protocol=http --enable-protocol=https \\            --enable-protocol=rtmp --enable-protocol=rtp --enable-protocol=tcp --enable-protocol=udp --enable-protocol=file \\            --disable-bsfs \\            --disable-indevs --enable-indev=v4l2 \\            --disable-outdevs \\            --disable-postproc \\            --enable-openssl --enable-protocol=crypto --enable-protocol=tls_openssl \\            --extra-cflags=-I/Users/gezhaoyou/repos/libs/ffmpeg/mac/openssl/include \\            --extra-ldflags=-L/Users/gezhaoyou/repos/libs/ffmpeg/mac/openssl/lib \\openssl éœ€è¦æå‰ç¼–è¯‘å¥½ï¼Œå¯ä»¥å‚è€ƒ Compile Openssl for mac--extra-cflags å’Œ --extra-ldflags æŒ‡å®šäº†opensll å¤´æ–‡ä»¶è·¯å¾„å’Œåº“æ–‡ä»¶è·¯å¾„ffmpeg` ç¼–è¯‘è¾“å‡ºè·¯å¾„ä¸ºï¼š`--libdir=./ffmpegbuild/libä¸Šé¢çš„ffmpegé…ç½®é€‰é¡¹æ”¯æŒå¸¸è§å°è£…çš„è§£ç æ’­æ”¾ï¼Œå¦‚mp3ï¼Œ mp4, hlsï¼Œæ”¯æŒ https, è‹¥è¦æ”¯æŒç¼–ç ï¼Œéœ€è‡ªè¡Œæ·»åŠ ç›¸å…³å‚æ•°å’Œåº“ä¾èµ–"
  },
  
  {
    "title": "Mac M1 ç¼–è¯‘arm64ç‰ˆæœ¬ WebRTC",
    "url": "/mac-m1-bian-yiarm64ban-ben-webrtc.html",
    "categories": "RTC",
    "tags": "RTC",
    "date": "2023-03-12 21:37:40 +0800",
    





    
    "snippet": "Mac M1 ç¼–è¯‘arm64ç‰ˆæœ¬ WebRTCgn gen out/mac --args='target_os=\"mac\" is_debug=false target_cpu=\"arm64\" rtc_include_tests=false enable_dsyms=true is_debug=true' --ide=xcode  æ¶æ„é€‰ target_cpu=\"arm64\"  enable_...",
    "content": "Mac M1 ç¼–è¯‘arm64ç‰ˆæœ¬ WebRTCgn gen out/mac --args='target_os=\"mac\" is_debug=false target_cpu=\"arm64\" rtc_include_tests=false enable_dsyms=true is_debug=true' --ide=xcode  æ¶æ„é€‰ target_cpu=\"arm64\"  enable_dsyms=true å¯ä»¥ä½¿ WebRTC Xcodeå·¥ç¨‹æ·»åŠ æ–­ç‚¹è°ƒè¯•  is_debug=true ç”Ÿæˆdebugç‰ˆæœ¬å·¥ç¨‹ï¼Œæ–­ç‚¹å¯æŸ¥çœ‹å˜é‡è¯¦æƒ…  rtc_include_tests=false  å…³é—­æµ‹è¯•ï¼Œå¦æˆå·¥ç¨‹å·¥å‡ºç°å¤§é‡å•å…ƒæµ‹è¯•æ–‡ä»¶iOSç‰ˆæœ¬WebRTC Frameworkç¼–è¯‘è‹¥ç›´æ¥ç¼–è¯‘iOS Apprtc å¯ä»¥ç¼–è¯‘æˆåŠŸï¼Œä½†å®‰è£…æ—¶å€™ä¼šæŠ¥ webrtc  No code signature foundgn gen out/ios-framework --args='target_os=\"ios\" is_debug=false target_cpu=\"arm64\" rtc_include_tests=false ios_enable_code_signing=false' --ide=xcodeæœ€ç»ˆæˆ‘æ²¡è§£å†³ï¼Œå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼Œæ–°å»ºä¸€ä¸ªxcodeå·¥ç¨‹ï¼Œå°†rtc demoçš„ä»£ç å¯¼å…¥åˆ°æ–°åˆ›å»ºçš„å·¥ç¨‹ä¸­ï¼Œç„¶åé“¾æ¥WebRTC.frameworkWebRTC Frameworkç¼–è¯‘gn gen out/ios-framework --args='target_os=\"ios\" is_debug=false target_cpu=\"arm64\" rtc_include_tests=false ios_enable_code_signing=false rtc_enable_symbol_export=true' --ide=xcodeninja -C out/ios-framework framework_objcæŠ½å‡ºæ¥çš„demoåœ¨è¿™ https://github.com/gezhaoyou/apprtc-demo ï¼Œå¯ä»¥ç›´æ¥è·‘ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ç¼–è¯‘WebRTC.frameworkæ›¿æ¢"
  },
  
  {
    "title": "MacOS Big SuråGNç”ŸæˆWebRTCå·¥ç¨‹æŠ¥é”™",
    "url": "/macos-big-sur-hougn-sheng-chengwebrtc-gong-cheng-b.html",
    "categories": "RTC",
    "tags": "",
    "date": "2023-03-12 21:36:32 +0800",
    





    
    "snippet": "ç”Ÿæˆå·¥ç¨‹å‘½ä»¤ï¼š  gn gen out/ios_64_debug â€“args=â€™target_os=â€iosâ€ target_cpu=â€arm64â€ ios_enable_code_signing=falseâ€™ â€“ide=xcodeæŠ¥é”™:ERROR at //build/config/mac/mac_sdk.gni:106:7: Script returned non-zero exit c...",
    "content": "ç”Ÿæˆå·¥ç¨‹å‘½ä»¤ï¼š  gn gen out/ios_64_debug â€“args=â€™target_os=â€iosâ€ target_cpu=â€arm64â€ ios_enable_code_signing=falseâ€™ â€“ide=xcodeæŠ¥é”™:ERROR at //build/config/mac/mac_sdk.gni:106:7: Script returned non-zero exit code.      exec_script(\"//build/mac/find_sdk.py\", find_sdk_args, \"list lines\")      ^----------Current dir: /Users/admin/Repos/webrtc_all/webrtc/src/out/ios_64_debug/Command: python /Users/admin/Repos/webrtc_all/webrtc/src/build/mac/find_sdk.py --print_sdk_path --print_bin_path 10.12Returned 1.stderr:Traceback (most recent call last):  File \"/Users/admin/Repos/webrtc_all/webrtc/src/build/mac/find_sdk.py\", line 97, in &lt;module&gt;    print(main())  File \"/Users/admin/Repos/webrtc_all/webrtc/src/build/mac/find_sdk.py\", line 80, in main    raise Exception('No %s+ SDK found' % min_sdk_version)Exception: No 10.12+ SDK foundSee //build/toolchain/mac/BUILD.gn:15:1: whence it was imported.import(\"//build/config/mac/mac_sdk.gni\")^--------------------------------------See //BUILD.gn:29:3: which caused the file to be included.  group(\"default\") {  ^-----------------Exception: No 10.12+ SDK found, å¤§æ„å°±æ˜¯10.12+ çš„SDKæ‰¾ä¸åˆ°ï¼ŒæŠ¥é”™æ–‡ä»¶webrtc/src/build/mac/find_sdk.py 80è¡Œã€‚ä»£ç å¦‚ä¸‹ï¼š  if not os.path.isdir(sdk_dir):    raise SdkError('Install Xcode, launch it, accept the license ' +      'agreement, and run `sudo xcode-select -s /path/to/Xcode.app` ' +      'to continue.')  sdks = [re.findall('^MacOSX(10\\.\\d+)\\.sdk$', s) for s in os.listdir(sdk_dir)]  sdks = [s[0] for s in sdks if s]  # [['10.5'], ['10.6']] =&gt; ['10.5', '10.6']  sdks = [s for s in sdks  # ['10.5', '10.6'] =&gt; ['10.6']          if parse_version(s) &gt;= parse_version(min_sdk_version)]  if not sdks:    raise Exception('No %s+ SDK found' % min_sdk_version)  best_sdk = sorted(sdks, key=parse_version)[0]å› ä¸ºMacOS Big Surç‰ˆæœ¬å·æ”¹ä¸ºäº†11.xï¼Œç¨‹åºæœç´¢çš„ç‰ˆæœ¬å·æ˜¯10å¼€å¤´çš„ï¼Œæ‰€ä»¥æŸ¥æ‰¾ä¸åˆ°ï¼Œæ”¹ä¸º11å work fineï¼š  sdks = [re.findall('^MacOSX(11\\.\\d+)\\.sdk$', s) for s in os.listdir(sdk_dir)]"
  },
  
  {
    "title": "RTMPç›´æ’­åè®®å®ç°æ³¨æ„äº‹é¡¹",
    "url": "/rtmp-zhi-bo-xie-yi-shi-xian-zhu-yi-shi-xiang.html",
    "categories": "å¼€å‘",
    "tags": "",
    "date": "2023-03-12 21:34:29 +0800",
    





    
    "snippet": "2018å¹´8æœˆ4æ—¥ç¬¬ä¸‰æ¬¡æ›´æ–°ï¼Œè¯¦ç»†ä»‹ç»äº†RTMPåè®®ä¸é‡åˆ°çš„å‘ï¼Œå¦å¤–çº¯Javaé‡å†™äº†RTMPåè®®ï¼Œåšäº†ä¸ªAndroid æ¨æµé¡¹ç›®ï¼ŒåŒ…å«å®‰å“ç›¸æœºé‡‡é›†ï¼Œç¼–ç å’ŒRTMPæ¨æµï¼Œä¸Šä¼ åˆ°githubäº†ã€‚é¡¹ç›®åœ°å€ï¼šhttps://github.com/gezhaoyou/SimpleLivePublisherLiteå‚è€ƒæ–‡ç« ï¼š      Android RTMPç›´æ’­æ¨æµDemoï¼š https://www....",
    "content": "2018å¹´8æœˆ4æ—¥ç¬¬ä¸‰æ¬¡æ›´æ–°ï¼Œè¯¦ç»†ä»‹ç»äº†RTMPåè®®ä¸é‡åˆ°çš„å‘ï¼Œå¦å¤–çº¯Javaé‡å†™äº†RTMPåè®®ï¼Œåšäº†ä¸ªAndroid æ¨æµé¡¹ç›®ï¼ŒåŒ…å«å®‰å“ç›¸æœºé‡‡é›†ï¼Œç¼–ç å’ŒRTMPæ¨æµï¼Œä¸Šä¼ åˆ°githubäº†ã€‚é¡¹ç›®åœ°å€ï¼šhttps://github.com/gezhaoyou/SimpleLivePublisherLiteå‚è€ƒæ–‡ç« ï¼š      Android RTMPç›´æ’­æ¨æµDemoï¼š https://www.jianshu.com/p/0318ff29ac32    å¸¦ä½ åƒé€RTMPï¼šhttp://mingyangshang.github.io/2016/03/06/RTMP%E5%8D%8F%E8%AE%AE/  1. ç®€ä»‹RTMPåè®®æ˜¯Real Time Message Protocol(å®æ—¶ä¿¡æ¯ä¼ è¾“åè®®)çš„ç¼©å†™ï¼Œå®ƒæ˜¯ç”±Adobeå…¬å¸æå‡ºçš„ä¸€ç§åº”ç”¨å±‚çš„åè®®ï¼Œç”¨æ¥è§£å†³å¤šåª’ä½“æ•°æ®ä¼ è¾“æµçš„å¤šè·¯å¤ç”¨ï¼ˆMultiplexingï¼‰å’Œåˆ†åŒ…ï¼ˆpacketizingï¼‰çš„é—®é¢˜ã€‚éšç€VRæŠ€æœ¯çš„å‘å±•ï¼Œè§†é¢‘ç›´æ’­ç­‰é¢†åŸŸé€æ¸æ´»è·ƒèµ·æ¥ï¼ŒRTMPä½œä¸ºä¸šå†…å¹¿æ³›ä½¿ç”¨çš„åè®®ä¹Ÿé‡æ–°è¢«ç›¸å…³å¼€å‘è€…é‡è§†èµ·æ¥ã€‚æœ¬æ–‡ä¸»è¦åˆ†äº«å¯¹RTMPçš„ä¸€äº›ç®€ä»‹å’Œå®é™…å¼€å‘ä¸­é‡åˆ°çš„ä¸€äº›çŠ¶å†µã€‚RTMPåè®®åŸºæœ¬ç‰¹ç‚¹ï¼šâ€¢ åŸºäºTCPåè®®çš„åº”ç”¨å±‚åè®®â€¢ é»˜è®¤é€šä¿¡ç«¯å£1935RTMP URLæ ¼å¼ï¼šrtmp://ip:[port]/appName/streamNameä¾‹å¦‚ï¼š rtmp://192.168.178.218:1935/live/devzhaoyou  å‚è€ƒï¼šhttps://blog.csdn.net/ai2000ai/article/details/727714612. RTMP æ¡æ‰‹RTMP æ¡æ‰‹åˆ†ä¸ºç®€å•æ¡æ‰‹å’Œå¤æ‚æ¡æ‰‹ï¼Œç°åœ¨Adobeå…¬å¸ä½¿ç”¨RTMPåè®®çš„äº§å“ç”¨å¤æ‚æ¡æ‰‹çš„è¾ƒå¤šï¼Œä¸åšä»‹ç»ã€‚æ¡æ‰‹åŒ…æ ¼å¼ï¼š 0 1 2 3 4 5 6 7+-+-+-+-+-+-+-+-+|     version   |+-+-+-+-+-+-+-+-+ C0 and S0 bitsC0å’ŒS0ï¼š1ä¸ªå­—èŠ‚ï¼ŒåŒ…å«äº†RTMPç‰ˆæœ¬, å½“å‰RTMPåè®®çš„ç‰ˆæœ¬ä¸º 3 0                   1                   2                   3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                           time (4 bytes)                      |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                           zero (4 bytes)                      |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                           random bytes                        |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                           random bytes                        ||                               (cont)                          ||                               ....                            |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                        C1 and S1 bitsC1å’ŒS1ï¼š4å­—èŠ‚æ—¶é—´æˆ³ï¼Œ4å­—èŠ‚çš„0ï¼Œ1528å­—èŠ‚çš„éšæœºæ•°  0                   1                   2                   3  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          time (4 bytes)                       | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          time2 (4 bytes)                      | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          random echo                          | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          random echo                          | |                             (cont)                            | |                              ....                             | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                            C2 and S2 bitsC2å’ŒS2ï¼š4å­—èŠ‚æ—¶é—´æˆ³ï¼Œ4å­—èŠ‚ä»å¯¹ç«¯è¯»åˆ°çš„æ—¶é—´æˆ³ï¼Œ1528å­—èŠ‚éšæœºæ•°RTMPæ¡æ‰‹åŸºæœ¬è¿‡ç¨‹ï¼š+-------------+                            +-------------+|   Client    |      TCP/IP Network        |     Server  |+-------------+             |              +-------------+       |                    |                     |Uninitialized               |                Uninitialized       |        C0          |                     |       |-------------------&gt;|           C0        |       |                    |--------------------&gt;|       |        C1          |                     |       |-------------------&gt;|           S0        |       |                    |&lt;--------------------|       |                    |           S1        |  Version sent              |&lt;--------------------|       |        S0          |                     |       |&lt;-------------------|                     |       |        S1          |                     |       |&lt;-------------------|               Version sent       |                    |           C1        |       |                    |--------------------&gt;|       |        C2          |                     |       |-------------------&gt;|           S2        |       |                    |&lt;--------------------|    Ack sent                |                   Ack Sent       |        S2          |                     |       |&lt;-------------------|                     |       |                    |           C2        |       |                    |--------------------&gt;|Handshake Done              |               Handshake Done      |                     |                     |          Pictorial Representation of Handshakeæ¡æ‰‹å¼€å§‹äºå®¢æˆ·ç«¯å‘é€C0ã€C1å—ã€‚æœåŠ¡å™¨æ”¶åˆ°C0æˆ–C1åå‘é€S0å’ŒS1ã€‚å½“å®¢æˆ·ç«¯æ”¶é½S0å’ŒS1åï¼Œå¼€å§‹å‘é€C2ã€‚å½“æœåŠ¡å™¨æ”¶é½C0å’ŒC1åï¼Œå¼€å§‹å‘é€S2ã€‚å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åˆ†åˆ«æ”¶åˆ°S2å’ŒC2åï¼Œæ¡æ‰‹å®Œæˆã€‚æ³¨æ„äº‹é¡¹ï¼š åœ¨å®é™…å·¥ç¨‹åº”ç”¨ä¸­ï¼Œä¸€èˆ¬æ˜¯å®¢æˆ·ç«¯å…ˆå°†C0, C1å—åŒæ—¶å‘å‡ºï¼ŒæœåŠ¡å™¨åœ¨æ”¶åˆ°C1 ä¹‹ååŒæ—¶å°†S0, S1, S2å‘ç»™å®¢æˆ·ç«¯ã€‚S2çš„å†…å®¹å°±æ˜¯æ”¶åˆ°çš„C1å—çš„å†…å®¹ã€‚ä¹‹åå®¢æˆ·ç«¯æ”¶åˆ°S1å—ï¼Œå¹¶åŸæ ·è¿”å›ç»™æœåŠ¡å™¨ï¼Œç®€å•æ¡æ‰‹å®Œæˆã€‚æŒ‰ç…§RTMPåè®®ä¸ªè¦æ±‚ï¼Œå®¢æˆ·ç«¯éœ€è¦æ ¡éªŒC1å—çš„å†…å®¹å’ŒS2å—çš„å†…å®¹æ˜¯å¦ç›¸åŒï¼Œç›¸åŒçš„è¯æ‰å½»åº•å®Œæˆæ¡æ‰‹è¿‡ç¨‹ï¼Œå®é™…ç¼–å†™ç¨‹åºç”¨ä¸€èˆ¬éƒ½ä¸å»åšæ ¡éªŒã€‚RTMPæ¡æ‰‹çš„è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å®Œæˆäº†ä¸¤ä»¶äº‹ï¼šæ ¡éªŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯RTMPåè®®ç‰ˆæœ¬å·æ˜¯å‘äº†ä¸€å †éšæœºæ•°æ®ï¼Œæ ¡éªŒç½‘ç»œçŠ¶å†µã€‚3. RTMP æ¶ˆæ¯RTMPæ¶ˆæ¯æ ¼å¼ï¼š  0                   1                   2                   3  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Message Type |               Payload length                   | |   (1 byte)   |                   (3 bytes)                    | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          Timestamp                            | |                          (4 bytes)                            | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          Stream ID            | |                          (3 bytes)            | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                         Message Headerâ€¢ 1å­—èŠ‚æ¶ˆæ¯ç±»å‹â€¢ 3å­—èŠ‚è´Ÿè½½æ¶ˆæ¯é•¿åº¦â€¢ 4å­—èŠ‚æ—¶é—´æˆ³â€¢ 3å­—èŠ‚ Stream IDï¼ŒåŒºåˆ†æ¶ˆæ¯æµæ³¨æ„äº‹é¡¹ï¼š å®é™…RTMPé€šä¿¡ä¸­å¹¶æœªæŒ‰ç…§ä¸Šè¿°æ ¼å¼å»å‘é€RTMPæ¶ˆæ¯ï¼Œè€Œæ˜¯å°†RTMP æ¶ˆæ¯åˆ†å—å‘é€ï¼Œä¹‹åå°†ä»‹ç»RTMPæ¶ˆæ¯åˆ†å—ã€‚RTMP æ¶ˆæ¯åˆ†å—ï¼ˆchunkingï¼‰è€Œå¯¹äºåŸºäºTCPçš„RTMPåè®®è€Œè¨€ï¼Œåè®®æ˜¾å¾—ç‰¹åˆ«ç¹çï¼Œä½†æ˜¯æœ‰æ²¡æœ‰æ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆã€‚åŒæ—¶åˆ›å»ºRTMPæ¶ˆæ¯åˆ†å—æ˜¯æ¯”è¾ƒå¤æ‚çš„åœ°æ–¹ï¼Œæ¶‰åŠåˆ°äº†AFMï¼ˆä¹Ÿæ˜¯Adobeå®¶çš„ä¸œè¥¿ï¼‰æ ¼å¼æ•°æ®çš„æ•°æ®ã€‚3.1RTMPæ¶ˆæ¯å—æ ¼å¼ï¼š +--------------+----------------+--------------------+--------------+ | Basic Header | Message Header | Extended Timestamp |  Chunk Data  | +--------------+----------------+--------------------+--------------+ |                                                    | |&lt;------------------- Chunk Header -----------------&gt;|                            Chunk FormatRTMPæ¶ˆæ¯å—æ„æˆï¼šâ€¢ Basic Headerâ€¢ Message Headerâ€¢ Extended Timestampâ€¢ Chunk DataChunk Basic headeræ ¼å¼æœ‰3ç§:æ ¼å¼1ï¼š   0 1 2 3 4 5 6 7  +-+-+-+-+-+-+-+-+  |fmt|   cs id   |  +-+-+-+-+-+-+-+-+ Chunk basic header 1æ ¼å¼2ï¼š  0                      1  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |fmt|      0    |  cs id - 64   | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      Chunk basic header 2æ ¼å¼3ï¼š  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |fmt|         1 |          cs id - 64           | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+             Chunk basic header 3æ³¨æ„äº‹é¡¹ï¼šfmt: ç”¨äºæŒ‡å®šChunk Header é‡Œé¢ Message Headerçš„ç±»å‹ï¼Œåé¢ä¼šä»‹ç»åˆ°cs id: æ˜¯chunk stream idçš„ç¼©å†™ï¼ŒåŒä¸€ä¸ªRTMPæ¶ˆæ¯æ‹†æˆçš„ chunk å—æ‹¥æœ‰ç›¸åŒçš„ cs id, ç”¨äºåŒºåˆ†chunkæ‰€å±çš„RTMPæ¶ˆæ¯, chunk basic header çš„ç±»å‹cs idå ç”¨çš„å­—èŠ‚æ•°æ¥ç¡®å®šMessage Headeræ ¼å¼ï¼šMessage Headerçš„ç±»å‹é€šè¿‡ä¸Šæ–‡chunk basic headerä¸­çš„fmtæŒ‡å®šï¼Œå…±4ç§:æ ¼å¼0:  0                   1                   2                   3  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          timestamp            | message length| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |      message length (cont)    |message type id| msg stream id | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |          message stream id (cont)             | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                Chunk Message Header - Type 0Message Headerå ç”¨11ä¸ªå­—èŠ‚ï¼Œ åœ¨chunk streamçš„å¼€å§‹çš„ç¬¬ä¸€ä¸ªchunkçš„æ—¶å€™å¿…é¡»é‡‡ç”¨è¿™ç§æ ¼å¼ã€‚â€¢ timestampï¼š3ä¸ªå­—èŠ‚ï¼Œå› æ­¤å®ƒæœ€å¤šèƒ½è¡¨ç¤ºåˆ°16777215=0xFFFFFF=2^24-1, å½“å®ƒçš„å€¼è¶…è¿‡è¿™ä¸ªæœ€å¤§å€¼æ—¶ï¼Œè¿™ä¸‰ä¸ªå­—èŠ‚éƒ½ç½®ä¸º1ï¼Œå®é™…çš„timestampä¼šè½¬å­˜åˆ°Extended Timestampå­—æ®µä¸­ï¼Œæ¥å—ç«¯åœ¨åˆ¤æ–­timestampå­—æ®µ24ä¸ªä½éƒ½ä¸º1æ—¶å°±ä¼šå»Extended timestampä¸­è§£æå®é™…çš„æ—¶é—´æˆ³ã€‚â€¢ message lengthï¼š3ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºå®é™…å‘é€çš„æ¶ˆæ¯çš„æ•°æ®å¦‚éŸ³é¢‘å¸§ã€è§†é¢‘å¸§ç­‰æ•°æ®çš„é•¿åº¦ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚æ³¨æ„è¿™é‡Œæ˜¯Messageçš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯chunkå±äºçš„Messageçš„æ€»æ•°æ®é•¿åº¦ï¼Œè€Œä¸æ˜¯chunkæœ¬èº«Dataçš„æ•°æ®çš„é•¿åº¦ã€‚â€¢ message type idï¼š1ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºå®é™…å‘é€çš„æ•°æ®çš„ç±»å‹ï¼Œå¦‚8ä»£è¡¨éŸ³é¢‘æ•°æ®ã€9ä»£è¡¨è§†é¢‘æ•°æ®ã€‚â€¢ msg stream idï¼š4ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºè¯¥chunkæ‰€åœ¨çš„æµçš„IDï¼Œå’ŒBasic Headerçš„CSIDä¸€æ ·ï¼Œå®ƒé‡‡ç”¨å°ç«¯å­˜å‚¨çš„æ–¹å¼æ ¼å¼1ï¼š  0                   1                   2                   3  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |                          timestamp            | message length| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |      message length (cont)    |message type id|   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                 Chunk Message Header - Type 1 Message Headerå ç”¨7ä¸ªå­—èŠ‚ï¼Œçœå»äº†è¡¨ç¤ºmsg stream idçš„4ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºæ­¤chunkå’Œä¸Šä¸€æ¬¡å‘çš„chunkæ‰€åœ¨çš„æµç›¸åŒã€‚â€¢ timestamp deltaï¼š3ä¸ªå­—èŠ‚ï¼Œæ³¨æ„è¿™é‡Œå’Œæ ¼å¼0æ—¶ä¸åŒï¼Œå­˜å‚¨çš„æ˜¯å’Œä¸Šä¸€ä¸ªchunkçš„æ—¶é—´å·®ã€‚ç±»ä¼¼ä¸Šé¢æåˆ°çš„timestampï¼Œå½“å®ƒçš„å€¼è¶…è¿‡3ä¸ªå­—èŠ‚æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼æ—¶ï¼Œä¸‰ä¸ªå­—èŠ‚éƒ½ç½®ä¸º1ï¼Œå®é™…çš„æ—¶é—´æˆ³å·®å€¼å°±ä¼šè½¬å­˜åˆ°Extended Timestampå­—æ®µä¸­ï¼Œæ¥å—ç«¯åœ¨åˆ¤æ–­timestamp deltaå­—æ®µ24ä¸ªä½éƒ½ä¸º1æ—¶å°±ä¼šå»Extended timestampä¸­è§£ææ—¶æœºçš„ä¸ä¸Šæ¬¡æ—¶é—´æˆ³çš„å·®å€¼ã€‚æ ¼å¼2ï¼š  0                   1                   2       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |                          timestamp            |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+           Chunk Message Header - Type 2 Message Headerå ç”¨3ä¸ªå­—èŠ‚ï¼Œç›¸å¯¹äºæ ¼å¼1ï¼Œåˆçœå»äº†è¡¨ç¤ºæ¶ˆæ¯é•¿åº¦çš„3ä¸ªå­—èŠ‚å’Œè¡¨ç¤ºæ¶ˆæ¯ç±»å‹çš„1ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºæ­¤chunkå’Œä¸Šä¸€æ¬¡å‘é€çš„chunkæ‰€åœ¨çš„æµã€æ¶ˆæ¯çš„é•¿åº¦å’Œæ¶ˆæ¯çš„ç±»å‹éƒ½ç›¸åŒã€‚ä½™ä¸‹çš„è¿™ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºtimestamp deltaï¼Œä½¿ç”¨åŒæ ¼å¼1ã€‚æ ¼å¼3ï¼š0å­—èŠ‚ï¼Œå®ƒè¡¨ç¤ºè¿™ä¸ªchunkçš„Message Headerå’Œä¸Šä¸€ä¸ªæ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œæ— éœ€å†æ¬¡ä¼ é€Extended Timestampï¼ˆæ‰©å±•æ—¶é—´æˆ³ï¼‰ï¼šåœ¨chunkä¸­ä¼šæœ‰æ—¶é—´æˆ³timestampå’Œæ—¶é—´æˆ³å·®timestamp deltaï¼Œ åªæœ‰è¿™ä¸¤è€…ä¹‹ä¸€å¤§äº3ä¸ªå­—èŠ‚èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å€¼0xFFFFFFï¼16777215æ—¶ï¼Œæ‰ä¼šç”¨è¿™ä¸ªå­—æ®µæ¥è¡¨ç¤ºçœŸæ­£çš„æ—¶é—´æˆ³ï¼Œå¦åˆ™è¿™ä¸ªå­—æ®µä¸ä¼ ï¼ˆæ„Ÿè°¢è¯„è®ºåŒº @hijiangæŒ‡å‡ºé”™è¯¯ï¼‰ã€‚æ‰©å±•æ—¶é—´æˆ³å 4ä¸ªå­—èŠ‚ï¼Œèƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å€¼å°±æ˜¯0xFFFFFFFFï¼4294967295ã€‚å½“æ‰©å±•æ—¶é—´æˆ³å¯ç”¨æ—¶ï¼Œtimestampå­—æ®µæˆ–è€…timestamp deltaè¦å…¨ç½®ä¸º1ï¼Œè¡¨ç¤ºåº”è¯¥å»æ‰©å±•æ—¶é—´æˆ³å­—æ®µæ¥æå–çœŸæ­£çš„æ—¶é—´æˆ³æˆ–è€…æ—¶é—´æˆ³å·®ã€‚æ³¨æ„æ‰©å±•æ—¶é—´æˆ³å­˜å‚¨çš„æ˜¯å®Œæ•´å€¼ï¼Œè€Œä¸æ˜¯å‡å»æ—¶é—´æˆ³æˆ–è€…æ—¶é—´æˆ³å·®çš„å€¼ã€‚Chunk Dataï¼ˆå—æ•°æ®ï¼‰ï¼š ç”¨æˆ·å±‚é¢ä¸ŠçœŸæ­£æƒ³è¦å‘é€çš„ä¸åè®®æ— å…³çš„æ•°æ®ï¼Œé•¿åº¦åœ¨(0,chunkSize]ä¹‹é—´, chunk sizeé»˜è®¤ä¸º128å­—èŠ‚ã€‚RTMP æ¶ˆæ¯åˆ†å—æ³¨æ„äº‹é¡¹â€¢ Chunk Size:RTMPæ˜¯æŒ‰ç…§chunk sizeè¿›è¡Œåˆ†å—ï¼Œchunk size æŒ‡çš„æ˜¯ chunkçš„payloadéƒ¨åˆ†çš„å¤§å°ï¼Œä¸åŒ…æ‹¬chunk basic header å’Œ chunk message headeré•¿åº¦ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å„è‡ªç»´æŠ¤äº†ä¸¤ä¸ªchunk size, åˆ†åˆ«æ˜¯è‡ªèº«åˆ†å—çš„chunk size å’Œ å¯¹ç«¯ çš„chunk size, é»˜è®¤çš„è¿™ä¸¤ä¸ªchunk sizeéƒ½æ˜¯128å­—èŠ‚ã€‚é€šè¿‡å‘å¯¹ç«¯å‘é€set chunk size æ¶ˆæ¯å¯ä»¥å‘ŠçŸ¥å¯¹æ–¹æ›´æ”¹äº† chunk sizeçš„å¤§å°ã€‚â€¢ Chunk Type:RTMPæ¶ˆæ¯åˆ†æˆçš„Chunkæœ‰4ç§ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ chunk basic headerçš„é«˜ä¸¤ä½(fmt)æŒ‡å®šï¼Œä¸€èˆ¬åœ¨æ‹†åŒ…çš„æ—¶å€™ä¼šæŠŠä¸€ä¸ªRTMPæ¶ˆæ¯æ‹†æˆä»¥æ ¼å¼0å¼€å§‹çš„chunkï¼Œä¹‹åçš„åŒ…æ‹†æˆæ ¼å¼3 ç±»å‹çš„chunkï¼Œæˆ‘æŸ¥çœ‹äº†æœ‰ä¸å°‘ä»£ç ä¹Ÿæ˜¯è¿™æ ·å®ç°çš„ï¼Œè¿™æ ·ä¹Ÿæ˜¯æœ€ç®€å•çš„å®ç°ã€‚å¦‚æœç¬¬äºŒä¸ªmessageå’Œç¬¬ä¸€ä¸ªmessageçš„message stream ID ç›¸åŒï¼Œå¹¶ä¸”ç¬¬äºŒä¸ªmessageçš„é•¿åº¦ä¹Ÿå¤§äºäº†chunk sizeï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ‹†åŒ…ï¼Ÿå½“æ—¶æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œéƒ½æ²¡æœ‰ä»‹ç»ã€‚åæ¥çœ‹äº†ä¸€äº›æºç ï¼Œå¦‚ SRSï¼ŒFFMPEGä¸­çš„å®ç°ï¼Œå‘ç°ç¬¬äºŒä¸ªmessageå¯ä»¥æ‹†æˆType_1ç±»å‹ä¸€ä¸ªchunkï¼Œ messageå‰©ä½™çš„éƒ¨åˆ†æ‹†æˆType_3ç±»å‹çš„chunkã€‚FFMPEGä¸­å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚3.2 RTMP äº¤äº’æ¶ˆæ¯æ¨æµRTMPæ¶ˆæ¯äº¤äº’æµç¨‹ï¼š          pic_2.png  å…³äºæ¨æµçš„è¿‡ç¨‹ï¼ŒRTMPçš„åè®®æ–‡æ¡£ä¸Šç»™äº†ä¸Šå›¾ç¤ºä¾‹ï¼Œè¯´ä¸€ä¸‹æ¨æµæ³¨æ„äº‹é¡¹ï¼š3.2.1 Connect æ¶ˆæ¯RTMP å‘½ä»¤æ¶ˆæ¯æ ¼å¼ï¼š +----------------+---------+---------------------------------------+ |  Field Name    |   Type  |               Description             | +--------------- +---------+---------------------------------------+ |   Command Name | String  | Name of the command. Set to \"connect\".| +----------------+---------+---------------------------------------+ | Transaction ID | Number  |            Always set to 1.           | +----------------+---------+---------------------------------------+ | Command Object | Object  |  Command information object which has | |                |         |           the name-value pairs.       | +----------------+---------+---------------------------------------+ | Optional User  | Object  |       Any optional information        | |   Arguments    |         |                                       | +----------------+---------+---------------------------------------+RTMPæ¡æ‰‹ä¹‹åå…ˆå‘é€ä¸€ä¸ªconnectå‘½ä»¤æ¶ˆæ¯ï¼Œå‘½ä»¤é‡Œé¢åŒ…å«ä»€ä¹ˆä¸œè¥¿ï¼Œåè®®ä¸­æ²¡æœ‰å…·ä½“è§„å®šï¼Œå®é™…é€šä¿¡ä¸­è¦æºå¸¦ rtmp url ä¸­çš„ appName å­—æ®µï¼Œå¹¶ä¸”æŒ‡å®šä¸€äº›ç¼–è§£ç çš„ä¿¡æ¯ï¼Œå¹¶ä»¥AMFæ ¼å¼å‘é€, ä¸‹é¢æ˜¯ç”¨wireshakeæŠ“å–connectå‘½ä»¤éœ€è¦åŒ…å«çš„å‚æ•°ä¿¡æ¯ï¼š          pic_3.png  è¿™äº›ä¿¡æ¯åè®®ä¸­å¹¶æ²¡æœ‰ç‰¹åˆ«è¯¦ç»†è¯´æ˜, åœ¨librtmpï¼Œsrs-librtmpè¿™äº›æºç ä¸­ï¼Œä»¥åŠç”¨wireshark æŠ“åŒ…çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ã€‚æœåŠ¡å™¨è¿”å›çš„æ˜¯ä¸€ä¸ª_resultå‘½ä»¤ç±»å‹æ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯çš„payload lengthä¸€èˆ¬ä¸ä¼šå¤§äº128å­—èŠ‚ï¼Œä½†æ˜¯åœ¨æœ€æ–°çš„nginx-rtmpä¸­è¿”å›çš„æ¶ˆæ¯é•¿åº¦ä¼šå¤§äº128å­—èŠ‚ã€‚æ¶ˆæ¯çš„transactionIDæ˜¯ç”¨æ¥æ ‡è¯†commandç±»å‹çš„æ¶ˆæ¯çš„ï¼ŒæœåŠ¡å™¨è¿”å›çš„_resultæ¶ˆæ¯å¯ä»¥é€šè¿‡transactionIDæ¥åŒºåˆ†æ˜¯å¯¹å“ªä¸ªå‘½ä»¤çš„å›åº”ï¼Œconnect å‘½ä»¤å‘å®Œä¹‹åè¿˜è¦å‘é€å…¶ä»–å‘½ä»¤æ¶ˆæ¯ï¼Œè¦ä¿è¯ä»–ä»¬çš„transactionIDä¸ç›¸åŒã€‚å‘é€å®Œconnectå‘½ä»¤ä¹‹åä¸€èˆ¬ä¼šå‘ä¸€ä¸ª set chunk sizeæ¶ˆæ¯æ¥è®¾ç½®chunk sizeçš„å¤§å°ï¼Œä¹Ÿå¯ä»¥ä¸å‘ã€‚Window Acknowledgement Size æ˜¯è®¾ç½®æ¥æ”¶ç«¯æ¶ˆæ¯çª—å£å¤§å°ï¼Œä¸€èˆ¬æ˜¯2500000å­—èŠ‚ï¼Œå³å‘Šè¯‰å¯¹ç«¯åœ¨æ”¶åˆ°è®¾ç½®çš„çª—å£å¤§å°é•¿åº¦çš„æ•°æ®ä¹‹åè¦è¿”å›ä¸€ä¸ªACKæ¶ˆæ¯ã€‚åœ¨å®é™…åšæ¨æµçš„æ—¶å€™æ¨æµç«¯è¦æ¥æ”¶å¾ˆå°‘çš„æœåŠ¡å™¨æ•°æ®ï¼Œè¿œè¿œåˆ°è¾¾ä¸äº†çª—å£å¤§å°ï¼Œæ‰€ä»¥è¿™ä¸ªæ¶ˆæ¯å¯ä»¥ä¸å‘ã€‚è€Œå¯¹äºæœåŠ¡å™¨è¿”å›çš„ACKæ¶ˆæ¯ä¸€èˆ¬ä¹Ÿä¸åšå¤„ç†ï¼Œé»˜è®¤æœåŠ¡å™¨éƒ½å·²ç»æ”¶åˆ°äº†æ‰€æœ‰æ¶ˆæ¯äº†ã€‚ä¹‹åè¦ç­‰å¾…æœåŠ¡å™¨å¯¹äºconnectæ¶ˆæ¯çš„å›åº”çš„ï¼Œä¸€èˆ¬æ˜¯æŠŠæœåŠ¡å™¨è¿”å›çš„chunkéƒ½è¯»å®Œï¼Œç»„åŒ…æˆå®Œæ•´çš„RTMPæ¶ˆæ¯ï¼Œæ²¡æœ‰é”™è¯¯å°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚3.2.2 Create Stream æ¶ˆæ¯åˆ›å»ºå®ŒRTMPè¿æ¥ä¹‹åå°±å¯ä»¥åˆ›å»ºRTMPæµï¼Œå®¢æˆ·ç«¯è¦æƒ³æœåŠ¡å™¨å‘é€ä¸€ä¸ªreleaseStreamå‘½ä»¤æ¶ˆæ¯ï¼Œä¹‹åæ˜¯FCPublishå‘½ä»¤æ¶ˆæ¯ï¼Œåœ¨ä¹‹åæ˜¯createStreamå‘½ä»¤æ¶ˆæ¯ã€‚å½“å‘é€å®ŒcreateStreamæ¶ˆæ¯ä¹‹åï¼Œè§£ææœåŠ¡å™¨è¿”å›çš„æ¶ˆæ¯ä¼šå¾—åˆ°ä¸€ä¸ªstream IDã€‚          pic_4.png  è¿™ä¸ªIDä¹Ÿå°±æ˜¯ä»¥åå’ŒæœåŠ¡å™¨é€šä¿¡çš„ message stream ID, ä¸€èˆ¬è¿”å›çš„æ˜¯1ï¼Œä¸å›ºå®šã€‚3.2.3 Publish Streamæ¨æµå‡†å¤‡å·¥ä½œçš„æœ€åä¸€æ­¥æ˜¯Publish Streamï¼Œå³å‘æœåŠ¡å™¨å‘ä¸€ä¸ªpublishå‘½ä»¤æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä¸­ä¼šå¸¦æœ‰æµåç§°å­—æ®µï¼Œå³rtmp urlä¸­çš„ streamNameï¼Œè¿™ä¸ªå‘½ä»¤çš„message stream ID å°±æ˜¯ä¸Šé¢ create stream ä¹‹åæœåŠ¡å™¨è¿”å›çš„stream IDï¼Œå‘å®Œè¿™ä¸ªå‘½ä»¤ä¸€èˆ¬ä¸ç”¨ç­‰å¾…æœåŠ¡å™¨è¿”å›çš„å›åº”ï¼Œç›´æ¥å‘é€éŸ³è§†é¢‘ç±»å‹çš„RTMPæ•°æ®åŒ…å³å¯ã€‚æœ‰äº›rtmpåº“è¿˜ä¼šå‘setMetaDataæ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯å¯ä»¥å‘ä¹Ÿå¯ä»¥ä¸å‘ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›éŸ³è§†é¢‘meta dataçš„ä¿¡æ¯ï¼Œå¦‚è§†é¢‘çš„åˆ†è¾¨ç‡ç­‰ç­‰ã€‚æ•´ä¸ªæ¨æµè¿‡ç¨‹rtmp æ¶ˆæ¯æŠ“åŒ…          rtmp_pulish_message.png  4. æ¨é€éŸ³è§†é¢‘å½“ä»¥ä¸Šå·¥ä½œéƒ½å®Œæˆçš„æ—¶å€™ï¼Œå°±å¯ä»¥å‘é€éŸ³è§†é¢‘äº†ã€‚éŸ³è§†é¢‘RTMPæ¶ˆæ¯çš„Payload(æ¶ˆæ¯ä½“)ä¸­éƒ½æ”¾çš„æ˜¯æŒ‰ç…§FLV-TAGæ ¼å¼å°çš„éŸ³è§†é¢‘åŒ…ï¼Œå…·ä½“å¯ä»¥å‚ç…§FLVå°è£…çš„åè®®æ–‡æ¡£ã€‚æ ¼å¼å¿…é¡»å°è£…æ­£ç¡®ï¼Œå¦åˆ™ä¼šé€ æˆæ’­æ”¾ç«¯ä¸èƒ½æ­£å¸¸æ‹¿åˆ°éŸ³è§†é¢‘æ•°æ®ï¼Œæ— æ³•æ’­æ”¾éŸ³è§†é¢‘ã€‚5. å…³äºRTMPçš„æ—¶é—´æˆ³RTMPçš„æ—¶é—´æˆ³å•ä½æ˜¯æ¯«ç§’msï¼Œåœ¨å‘é€éŸ³è§†é¢‘ä¹‹å‰ä¸€ç›´ä¸ºé›¶ï¼Œå‘é€éŸ³è§†é¢‘æ¶ˆæ¯åŒ…åæ—¶å€™å¿…é¡»ä¿è¯æ—¶é—´æˆ³æ˜¯å•è°ƒé€’å¢çš„ï¼Œæ—¶é—´æˆ³å¿…é¡»æ‰“å‡†ç¡®ï¼Œå¦åˆ™æ’­æ”¾ç«¯å¯èƒ½å‡ºç°éŸ³è§†é¢‘ä¸åŒæ­¥çš„æƒ…å†µã€‚Srs-librtmpçš„æºç ä¸­ï¼Œå¦‚æœæ¨çš„æ˜¯è§†é¢‘æ–‡ä»¶çš„è¯ï¼Œå‘ç°ä»–ä»¬æ˜¯ç”¨H264çš„dtsä½œä¸ºæ—¶é—´æˆ³çš„ã€‚å®æ—¶éŸ³è§†é¢‘ä¼ è¾“çš„æ—¶å€™æ˜¯å…ˆè·å–äº†ä¸‹æŸä¸€æ—¶åˆ»ç³»ç»Ÿæ—¶é—´ä½œä¸ºåŸºå‡†ï¼Œç„¶åæ¯æ¬¡ç›¸æœºé‡‡é›†åˆ°çš„è§†é¢‘åŒ…ï¼Œä¸èµ·å§‹çš„åŸºå‡†æ—¶é—´ç›¸å‡ï¼Œå¾—åˆ°æ—¶é—´æˆ³ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ—¶é—´æˆ³çš„æ­£ç¡®æ€§ã€‚6. å…³äºChunk Stream IDRTMP çš„Chunk Steam IDæ˜¯ç”¨æ¥åŒºåˆ†æŸä¸€ä¸ªchunkæ˜¯å±äºå“ªä¸€ä¸ªmessageçš„ ï¼Œ0å’Œ1æ˜¯ä¿ç•™çš„ã€‚æ¯æ¬¡åœ¨å‘é€ä¸€ä¸ªä¸åŒç±»å‹çš„RTMPæ¶ˆæ¯æ—¶éƒ½è¦æœ‰ä¸ç”¨çš„chunk stream ID, å¦‚ä¸Šä¸€ä¸ªMessage æ˜¯commandç±»å‹çš„ï¼Œä¹‹åè¦å‘é€è§†é¢‘ç±»å‹çš„æ¶ˆæ¯ï¼Œè§†é¢‘æ¶ˆæ¯çš„chunk stream ID è¦ä¿è¯å’Œä¸Šé¢ commandç±»å‹çš„æ¶ˆæ¯ä¸åŒã€‚æ¯ä¸€ç§æ¶ˆæ¯ç±»å‹çš„èµ·å§‹chunk çš„ç±»å‹å¿…é¡»æ˜¯ Type_0 ç±»å‹çš„ï¼Œè¡¨æ˜æ–°çš„æ¶ˆæ¯çš„èµ·å§‹ã€‚æ€»ç»“ï¼šRTMPåè®®æ˜¯ä¸ªæ¯”è¾ƒå•°å—¦çš„åè®®ï¼Œå®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒå¤æ‚ï¼Œä½†é€šä¿¡è¿‡ç¨‹è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚åœ¨ç›´æ’­çš„å®é™…å·¥ç¨‹åº”ç”¨ä¸­ï¼Œåè®®ä¸Šå¾ˆå¤šåœ°æ–¹éƒ½æ²¡æœ‰è¯¦ç»†è¯´æ˜ï¼Œæ³¨æ„äº†ä»¥ä¸Šæåˆ°å‡ ç‚¹ï¼ŒåŸºæœ¬èƒ½å¤Ÿä¿è¯RTMPéŸ³è§†é¢‘çš„é€šä¿¡æ­£å¸¸ã€‚ä»¥ä¸Šå°±æ˜¯å¯¹RTMPåè®®çš„ç®€ä»‹å’Œä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œå¸Œæœ›èƒ½å¸®åˆ°æœ‰éœ€è¦çš„æœ‹å‹ï¼Œå¦å¤–æœ¬æ–‡éš¾å…æœ‰é”™è¯¯æˆ–è¯´çš„ä¸å¤Ÿè¯¦ç»†çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ï¼Œä¸€èµ·äº¤æµæ¢è®¨ã€‚æœ¬ç¯‡æ–‡ç« 2017å¹´ç‰ˆæœ¬å‰ä¸€æ®µæ—¶é—´å†™è¿‡ä¸€ç¯‡æ–‡ç« : iOSç›´æ’­è§†é¢‘æ•°æ®é‡‡é›†ã€ç¡¬ç¼–ç ä¿å­˜h264æ–‡ä»¶ï¼Œæ¯”è¾ƒè¯¦ç»†çš„è®°å½•äº†åœ¨åšiOSç«¯è¿›è¡Œè§†é¢‘æ•°æ®é‡‡é›†å’Œç¼–ç çš„è¿‡ç¨‹ï¼Œä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯RTMPåè®®æ¨æµã€‚å› ä¸ºåœ¨å…¬å¸å°†RTMPåè®®ç”¨Java å’Œ Swift åˆ†åˆ«å®ç°äº†ä¸€éï¼Œæ‰€ä»¥å¯¹è¿™å—æ¯”è¾ƒäº†è§£ï¼Œä¸­é—´é‡åˆ°äº†ä¸å°‘å‘ï¼Œè®°å½•ä¸‹æ¥ä¹Ÿæ€•è‡ªå·±å¿˜æ‰ã€‚RTMPåè®®æ˜¯ Adobe å…¬å¸å¼€å‘çš„ä¸€ä¸ªåŸºäºTCPçš„åº”ç”¨å±‚åè®®ï¼ŒAdobe å…¬å¸ä¹Ÿå…¬å¸ƒäº†å…³äºRTMPçš„è§„èŒƒï¼Œä½†æ˜¯è¿™ä¸ªåè®®è§„èŒƒä»‹ç»çš„æœ‰äº›åœ°æ–¹éå¸¸æ¨¡ç³Šï¼Œå¾ˆå¤šä¸œè¥¿å’Œå®é™…åº”ç”¨æ˜¯æœ‰å·®åˆ«çš„ã€‚ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘å…³äºè¿™ä¸ªåè®®çš„ä»‹ç»ï¼Œä½†éƒ½ä¸æ˜¯å¤ªè¯¦ç»†ã€‚æˆ‘é‡åˆ°çš„æ¯”è¾ƒå¥½çš„å‚è€ƒèµ„æ–™å°±æ˜¯è¿™ç¯‡ï¼šå¸¦ä½ åƒé€RTMP, è¿™ç¯‡æ–‡ç« åªæ˜¯åœ¨ç†è®ºä¸Šå¯¹RTMPè¿›è¡Œäº†æ¯”è¾ƒè¯¦ç»†çš„è§£é‡Šï¼Œå¾ˆå¤šä¸œè¥¿è¿˜æ˜¯å’Œå®é™…åº”ç”¨æœ‰å‡ºå…¥ã€‚æˆ‘è¿™ç¯‡æ–‡ç« åªæ˜¯æŠŠé‡åˆ°çš„ä¸€äº›å‘è®°å½•ä¸‹æ¥ï¼Œå¹¶ä¸æ˜¯è¯¦è§£RTMPæ¶ˆæ¯çš„ã€‚å¦å¤–æ‡‚RTMPæ¶ˆæ¯æ‹†åŒ…åˆ†åŒ…ï¼Œè€Œä¸çœŸæ­£çš„å†™å†™çš„è¯æ˜¯å¾ˆéš¾æŠŠRTMPåè®®å¼„å¾—çš„å¾ˆæ¸…æ¥šï¼Œå…³äºRTMPåè®®çš„å®ç°ä¹Ÿæ˜¯æ¯”è¾ƒéº»çƒ¦çš„äº‹ï¼Œæ‡‚å’Œåšäº‹ä¸¤å›äº‹ã€‚å¦å¤–ç”¨wireshark æŠ“ä¸€ä¸‹åŒ…çš„è¯å¯ä»¥éå¸¸ç›´è§‚çš„çœ‹åˆ°RTMPé€šä¿¡çš„è¿‡ç¨‹ï¼Œå¯¹ç†è§£RTMPéå¸¸æœ‰å¸®åŠ©ï¼Œåœ¨è°ƒè¯•ä»£ç çš„æ—¶å€™ä¹Ÿå¤§é‡å€ŸåŠ©wiresharkæ’é”™ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚1. RTMP æ¡æ‰‹RTMP æ¡æ‰‹åˆ†ä¸ºç®€å•æ¡æ‰‹å’Œå¤æ‚æ¡æ‰‹ï¼Œç°åœ¨Adobeå…¬å¸ä½¿ç”¨RTMPåè®®çš„äº§å“åº”è¯¥ç”¨çš„éƒ½æ˜¯å¤æ‚æ¡æ‰‹ï¼Œè¿™é‡Œä¸ä»‹ç»ï¼Œåªè¯´ç®€å•æ¡æ‰‹ã€‚ æŒ‰ç…§ç½‘ä¸Šçš„è¯´æ³•RTMPæ¡æ‰‹çš„è¿‡ç¨‹å¦‚ä¸‹      æ¡æ‰‹å¼€å§‹äºå®¢æˆ·ç«¯å‘é€C0ã€C1å—ã€‚æœåŠ¡å™¨æ”¶åˆ°C0æˆ–C1åå‘é€S0å’ŒS1ã€‚    å½“å®¢æˆ·ç«¯æ”¶é½S0å’ŒS1åï¼Œå¼€å§‹å‘é€C2ã€‚å½“æœåŠ¡å™¨æ”¶é½C0å’ŒC1åï¼Œå¼€å§‹å‘é€S2ã€‚  å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åˆ†åˆ«æ”¶åˆ°S2å’ŒC2åï¼Œæ¡æ‰‹å®Œæˆã€‚åœ¨å®é™…å·¥ç¨‹åº”ç”¨ä¸­ï¼Œä¸€èˆ¬æ˜¯å®¢æˆ·ç«¯å…ˆå°†C0, C1å—åŒæ—¶å‘å‡ºï¼ŒæœåŠ¡å™¨åœ¨æ”¶åˆ°C1 ä¹‹ååŒæ—¶å°†S0, S1, S2å‘ç»™å®¢æˆ·ç«¯ã€‚S2çš„å†…å®¹å°±æ˜¯æ”¶åˆ°çš„C1å—çš„å†…å®¹ã€‚ä¹‹åå®¢æˆ·ç«¯æ”¶åˆ°S1å—ï¼Œå¹¶åŸæ ·è¿”å›ç»™æœåŠ¡å™¨ï¼Œç®€å•æ¡æ‰‹å®Œæˆã€‚æŒ‰ç…§RTMPåè®®ä¸ªè¦æ±‚ï¼Œå®¢æˆ·ç«¯éœ€è¦æ ¡éªŒC1å—çš„å†…å®¹å’ŒS2å—çš„å†…å®¹æ˜¯å¦ç›¸åŒï¼Œç›¸åŒçš„è¯æ‰å½»åº•å®Œæˆæ¡æ‰‹è¿‡ç¨‹ï¼Œå®é™…ç¼–å†™ç¨‹åºç”¨ä¸€èˆ¬éƒ½ä¸å»åšæ ¡éªŒã€‚RTMPæ¡æ‰‹çš„è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å®Œæˆäº†ä¸¤ä»¶äº‹ï¼š1. æ ¡éªŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯RTMPåè®®ç‰ˆæœ¬å·ï¼Œ2. æ˜¯å‘äº†ä¸€å †æ•°æ®ï¼ŒçŒœæƒ³åº”è¯¥æ˜¯æµ‹è¯•ä¸€ä¸‹ç½‘ç»œçŠ¶å†µï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä¼ é”™æˆ–è€…ä¸èƒ½ä¼ çš„æƒ…å†µã€‚RTMPæ¡æ‰‹æ˜¯æ•´ä¸ªRTMPåè®®ä¸­æœ€å®¹æ˜“å®ç°çš„ä¸€æ­¥ï¼Œæ¥ä¸‹æ¥æ‰æ˜¯å¤§å¤´ã€‚2. RTMP åˆ†å—åˆ›å»ºRTMPè¿æ¥ç®—æ˜¯æ¯”è¾ƒéš¾çš„åœ°æ–¹ï¼Œå¼€å§‹æ¶‰åŠæ¶ˆæ¯åˆ†å—ï¼ˆchunkingï¼‰å’Œ AFMï¼ˆä¹Ÿæ˜¯Adobeå®¶çš„ä¸œè¥¿ï¼‰æ ¼å¼æ•°æ®çš„ä¸€äº›ä¸œè¥¿ï¼Œåœ¨ä¸Šé¢æåˆ°çš„æ–‡ç« ä¸­ä¹Ÿæœ‰ä»‹ç»ä¸ºä»€è¦è¿›è¡ŒRTMPåˆ†å—ã€‚Chunk SizeRTMPæ˜¯æŒ‰ç…§chunk sizeè¿›è¡Œåˆ†å—ï¼Œchunk sizeæŒ‡çš„æ˜¯ chunkçš„payloadéƒ¨åˆ†çš„å¤§å°ï¼Œä¸åŒ…æ‹¬chunk basic header å’Œ chunk message headerï¼Œå³chunkçš„bodyçš„å¤§å°ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å„è‡ªç»´æŠ¤äº†ä¸¤ä¸ªchunk size, åˆ†åˆ«æ˜¯è‡ªèº«åˆ†å—çš„chunk size å’Œ å¯¹ç«¯ çš„chunk size, é»˜è®¤çš„è¿™ä¸¤ä¸ªchunk sizeéƒ½æ˜¯128å­—èŠ‚ã€‚é€šè¿‡å‘å¯¹ç«¯å‘é€set chunk size æ¶ˆæ¯å‘ŠçŸ¥å¯¹æ–¹æ›´æ”¹äº† chunk sizeçš„å¤§å°ï¼Œå³å‘Šè¯‰å¯¹ç«¯ï¼šæˆ‘æ¥ä¸‹æ¥è¦ä»¥xxxä¸ªå­—èŠ‚æ‹†åˆ†RTMPæ¶ˆæ¯ï¼Œä½ åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™å°±æŒ‰ç…§æ–°çš„chunk size æ¥ç»„åŒ…ã€‚åœ¨å®é™…å†™ä»£ç çš„æ—¶å€™ä¸€èˆ¬ä¼šæŠŠchunk sizeè®¾ç½®çš„å¾ˆå¤§ï¼Œæœ‰çš„ä¼šè®¾ç½®ä¸º4096ï¼ŒFFMPEGæ¨æµçš„æ—¶å€™è®¾ç½®çš„æ˜¯ 60*1000ï¼Œè¿™æ ·è®¾ç½®çš„å¥½å¤„æ˜¯é¿å…äº†é¢‘ç¹çš„æ‹†åŒ…ç»„åŒ…ï¼Œå ç”¨è¿‡å¤šçš„CPUã€‚è®¾ç½®å¤ªå¤§çš„è¯ä¹Ÿä¸å¥½ï¼Œä¸€ä¸ªå¾ˆå¤§çš„åŒ…å¦‚æœå‘é”™äº†ï¼Œæˆ–è€…ä¸¢å¤±äº†ï¼Œæ’­æ”¾ç«¯å°±ä¼šå‡ºç°é•¿æ—¶é—´çš„èŠ±å±æˆ–è€…é»‘å±ç­‰ç°è±¡ã€‚Chunk TypeRTMP åˆ†æˆçš„Chunkæœ‰4ä¸­ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ chunk basic headerçš„ é«˜ä¸¤ä½æŒ‡å®šï¼Œä¸€èˆ¬åœ¨æ‹†åŒ…çš„æ—¶å€™ä¼šæŠŠä¸€ä¸ªRTMPæ¶ˆæ¯æ‹†æˆä»¥ Type_0 ç±»å‹å¼€å§‹çš„chunkï¼Œä¹‹åçš„åŒ…æ‹†æˆ Type_3 ç±»å‹çš„chunkï¼Œæˆ‘æŸ¥çœ‹äº†æœ‰ä¸å°‘ä»£ç ä¹Ÿæ˜¯è¿™æ ·å®ç°çš„ï¼Œè¿™æ ·ä¹Ÿæ˜¯æœ€ç®€å•çš„å®ç°ã€‚RTMP ä¸­å…³äºMessage åˆ†chunkåªä¸¾äº†ä¸¤ä¸ªä¾‹å­ï¼Œè¿™ä¸¤ä¸ªä¾‹å­ä¸æ˜¯å¾ˆå…·æœ‰ä»£è¡¨æ€§ã€‚å‡å¦‚ç¬¬äºŒä¸ªmessageå’Œç¬¬ä¸€ä¸ªmessageçš„message stream ID ç›¸åŒï¼Œå¹¶ä¸”ç¬¬äºŒä¸ªmessageçš„é•¿åº¦ä¹Ÿå¤§äºäº†chunk sizeï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ‹†åŒ…ï¼Ÿå½“æ—¶æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œéƒ½æ²¡æœ‰ä»‹ç»ã€‚åæ¥çœ‹äº†ä¸€äº›æºç ï¼Œå‘ç°ç¬¬äºŒä¸ªmessageå¯ä»¥æ‹†æˆType_1ç±»å‹ä¸€ä¸ªchunk, messageå‰©ä½™çš„éƒ¨åˆ†æ‹†æˆType_3ç±»å‹çš„chunkã€‚FFMPEGä¸­å¥½åƒå°±æ˜¯è¿™ä¹ˆåšçš„ã€‚3. RTMP æ¶ˆæ¯å…³äºæ¨æµçš„è¿‡ç¨‹ï¼ŒRTMPçš„åè®®æ–‡æ¡£ä¸Šç»™äº†ä¸€ä¸ªç¤ºä¾‹ï¼Œè€ŒçœŸå®çš„RTMPé€šä¿¡è¿‡ç¨‹å’Œå®ƒæœ‰è¾ƒå¤§çš„å·®å¼‚ï¼Œåªè¯´æ¨æµï¼ŒRTMPæ’­æ”¾ç«¯æˆ‘æ²¡æœ‰åšè¿‡ã€‚Connectæ¶ˆæ¯æ¡æ‰‹ä¹‹åå…ˆå‘é€ä¸€ä¸ªconnect å‘½ä»¤æ¶ˆæ¯ï¼Œå‘½ä»¤é‡Œé¢åŒ…å«ä»€ä¹ˆä¸œè¥¿ï¼Œåè®®ä¸­æ²¡æœ‰è¯´ï¼ŒçœŸå®é€šä¿¡ä¸­è¦æŒ‡å®šä¸€äº›ç¼–è§£ç çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æ˜¯ä»¥AMFæ ¼å¼å‘é€çš„, ä¸‹é¢æ˜¯ç”¨swift å†™çš„connectå‘½ä»¤åŒ…å«çš„å‚æ•°ä¿¡æ¯ï¼š       transactionID += 1 // 0x01        let command:RTMPCommandMessage = RTMPCommandMessage(commandName: \"connect\", transactionId: transactionID, messageStreamId: 0x00)        let objects:Amf0Object = Amf0Object()        objects.setProperties(\"app\", value: rtmpSocket.appName)        objects.setProperties(\"flashVer\",value: \"FMLE/3.0 (compatible; FMSc/1.0)\")        objects.setProperties(\"swfUrl\", value:\"\")        objects.setProperties(\"tcUrl\", value: \"rtmp://\" + rtmpSocket.hostname + \"/\" + rtmpSocket.appName)        objects.setProperties(\"fpad\", value: false)        objects.setProperties(\"capabilities\", value:239)        objects.setProperties(\"audioCodecs\", value:3575)        objects.setProperties(\"videoCodecs\", value:252)        objects.setProperties(\"videoFunction\",value: 1)        objects.setProperties(\"pageUrl\",value: \"\")        objects.setProperties(\"objectEncoding\",value: 0)è¿™äº›ä¿¡æ¯å…·ä½“ä»€ä¹ˆæ„æ€æˆ‘ä¹Ÿä¸å¤ªæ˜ç™½ï¼Œåè®®ä¸­ä¹Ÿæ²¡æœ‰ï¼Œéƒ½æ˜¯æˆ‘åœ¨çœ‹librtmpï¼Œsrs-librtmpè¿™äº›æºç ï¼Œä»¥åŠç”¨wireshark æŠ“åŒ…çš„æ—¶å€™çœ‹åˆ°çš„ã€‚å…¶ä¸­å‚æ•°å°‘ä¸€ä¸¤ä¸ªè²Œä¼¼ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯audioCodecså’ŒvideoCodecsè¿™ä¸¤ä¸ªæŒ‡å®šéŸ³è§†é¢‘ç¼–ç ä¿¡æ¯çš„ä¸èƒ½å°‘ã€‚æœåŠ¡å™¨è¿”å›çš„æ˜¯ä¸€ä¸ª_resultå‘½ä»¤ç±»å‹æ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯çš„payload lengthä¸€èˆ¬ä¸ä¼šå¤§äº128å­—èŠ‚ï¼Œä½†æ˜¯åœ¨æœ€æ–°çš„nginx-rtmpä¸­è¿”å›çš„æ¶ˆæ¯é•¿åº¦ä¼šå¤§äº128å­—èŠ‚ï¼Œæ‰€ä»¥ä¸€å®šè¦åšå¥½æ”¶åŒ…ï¼Œç»„åŒ…çš„å·¥ä½œã€‚å…³äºæ¶ˆæ¯çš„transactionIDæ˜¯ç”¨æ¥æ ‡è¯†commandç±»å‹çš„æ¶ˆæ¯çš„ï¼ŒæœåŠ¡å™¨è¿”å›çš„_resultæ¶ˆæ¯å¯ä»¥é€šè¿‡ transactionIDæ¥åŒºåˆ†æ˜¯å¯¹å“ªä¸ªå‘½ä»¤çš„å›åº”ï¼Œconnect å‘½ä»¤å‘å®Œä¹‹åè¿˜è¦å‘é€å…¶ä»–å‘½ä»¤æ¶ˆæ¯ï¼Œè¦ä¿è¯ä»–ä»¬çš„transactionIDä¸ç›¸åŒã€‚å‘é€å®Œconnectå‘½ä»¤ä¹‹åä¸€èˆ¬ä¼šå‘ä¸€ä¸ª set chunk sizeæ¶ˆæ¯æ¥è®¾ç½®chunk size çš„å¤§å°ï¼Œä¹Ÿå¯ä»¥ä¸å‘ã€‚Window Acknowledgement Size æ˜¯è®¾ç½®æ¥æ”¶ç«¯æ¶ˆæ¯çª—å£å¤§å°ï¼Œä¸€èˆ¬æ˜¯2500000å­—èŠ‚ï¼Œå³å‘Šè¯‰å®¢æˆ·ç«¯ä½ åœ¨æ”¶åˆ°æˆ‘è®¾ç½®çš„çª—å£å¤§å°çš„è¿™ä¹ˆå¤šæ•°æ®ä¹‹åç»™æˆ‘è¿”å›ä¸€ä¸ªACKæ¶ˆæ¯ï¼Œå‘Šè¯‰æˆ‘ä½ æ”¶åˆ°äº†è¿™ä¹ˆå¤šæ¶ˆæ¯ã€‚åœ¨å®é™…åšæ¨æµçš„æ—¶å€™æ¨æµç«¯è¦æ¥æ”¶å¾ˆå°‘çš„æœåŠ¡å™¨æ•°æ®ï¼Œè¿œè¿œåˆ°è¾¾ä¸äº†çª—å£å¤§å°ï¼Œæ‰€ä»¥åŸºæœ¬ä¸ç”¨è€ƒè™‘è¿™ç‚¹ã€‚è€Œå¯¹äºæœåŠ¡å™¨è¿”å›çš„ACKæ¶ˆæ¯ä¸€èˆ¬ä¹Ÿä¸åšå¤„ç†ï¼Œæˆ‘ä»¬é»˜è®¤æœåŠ¡å™¨éƒ½å·²ç»æ”¶åˆ°äº†è¿™ä¹ˆå¤šæ¶ˆæ¯ã€‚ä¹‹åè¦ç­‰å¾…æœåŠ¡å™¨å¯¹äºconnectçš„å›åº”çš„ï¼Œä¸€èˆ¬æ˜¯æŠŠæœåŠ¡å™¨è¿”å›çš„chunkéƒ½è¯»å®Œç»„æˆå®Œæ•´çš„RTMPæ¶ˆæ¯ï¼Œæ²¡æœ‰é”™è¯¯å°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚Create Stream æ¶ˆæ¯åˆ›å»ºå®ŒRTMPè¿æ¥ä¹‹åå°±å¯ä»¥åˆ›å»ºRTMPæµï¼Œå®¢æˆ·ç«¯è¦æƒ³æœåŠ¡å™¨å‘é€ä¸€ä¸ªreleaseStreamå‘½ä»¤æ¶ˆæ¯ï¼Œä¹‹åæ˜¯FCPublishå‘½ä»¤æ¶ˆæ¯ï¼Œåœ¨ä¹‹åæ˜¯createStreamå‘½ä»¤æ¶ˆæ¯ã€‚å½“å‘é€å®ŒcreateStreamæ¶ˆæ¯ä¹‹åï¼Œè§£ææœåŠ¡å™¨è¿”å›çš„æ¶ˆæ¯ä¼šå¾—åˆ°ä¸€ä¸ªstream ID, è¿™ä¸ªIDä¹Ÿå°±æ˜¯ä»¥åå’ŒæœåŠ¡å™¨é€šä¿¡çš„ message stream ID, ä¸€èˆ¬è¿”å›çš„æ˜¯1ï¼Œä¸å›ºå®šã€‚Publish Streamæ¨æµå‡†å¤‡å·¥ä½œçš„æœ€åä¸€æ­¥æ˜¯ Publish Streamï¼Œå³å‘æœåŠ¡å™¨å‘ä¸€ä¸ªpublishå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤çš„message stream ID å°±æ˜¯ä¸Šé¢ create stream ä¹‹åæœåŠ¡å™¨è¿”å›çš„stream IDï¼Œå‘å®Œè¿™ä¸ªå‘½ä»¤ä¸€èˆ¬ä¸ç”¨ç­‰å¾…æœåŠ¡å™¨è¿”å›çš„å›åº”ï¼Œç›´æ¥ä¸‹ä¸€æ­¥å‘é€éŸ³è§†é¢‘æ•°æ®ã€‚æœ‰äº›rtmpåº“ è¿˜ä¼šå‘setMetaDataæ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯å¯ä»¥å‘ä¹Ÿå¯ä»¥ä¸å‘ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›éŸ³è§†é¢‘ç¼–ç çš„ä¿¡æ¯ã€‚4. å‘å¸ƒéŸ³è§†é¢‘å½“ä»¥ä¸Šå·¥ä½œéƒ½å®Œæˆçš„æ—¶å€™ï¼Œå°±å¯ä»¥å‘é€éŸ³è§†é¢‘äº†ã€‚éŸ³è§†é¢‘RTMPæ¶ˆæ¯çš„Payloadä¸­éƒ½æ”¾çš„æ˜¯æŒ‰ç…§FLV-TAGæ ¼å¼å°çš„éŸ³è§†é¢‘åŒ…ï¼Œå…·ä½“å¯ä»¥å‚ç…§FLVåè®®æ–‡æ¡£ã€‚5. å…³äºRTMPçš„æ—¶é—´æˆ³RTMPçš„æ—¶é—´æˆ³åœ¨å‘é€éŸ³è§†é¢‘ä¹‹å‰éƒ½ä¸ºé›¶ï¼Œå¼€å§‹å‘é€éŸ³è§†é¢‘æ¶ˆæ¯çš„æ—¶å€™åªè¦ä¿è¯æ—¶é—´æˆ³æ˜¯å•å¢çš„åŸºæœ¬å°±å¯ä»¥æ­£å¸¸æ’­æ”¾éŸ³è§†é¢‘ã€‚æˆ‘è¯»Srs-librtmpçš„æºç ï¼Œå‘ç°ä»–ä»¬æ˜¯ç”¨h264çš„dtsä½œä¸ºæ—¶é—´æˆ³çš„ã€‚æˆ‘åœ¨ç”¨javaå†™çš„æ—¶å€™æ˜¯å…ˆè·å–äº†ä¸‹å½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œç„¶åæ¯æ¬¡å‘é€æ¶ˆæ¯çš„æ—¶å€™éƒ½ä¸è¿™ä¸ªèµ·å§‹æ—¶é—´ç›¸å‡ï¼Œå¾—åˆ°æ—¶é—´æˆ³ã€‚6. å…³äºChunk Stream IDRTMP çš„Chunk Steam IDæ˜¯ç”¨æ¥åŒºåˆ†æŸä¸€ä¸ªchunkæ˜¯å±äºå“ªä¸€ä¸ªmessageçš„ ,0å’Œ1æ˜¯ä¿ç•™çš„ã€‚æ¯æ¬¡åœ¨å‘é€ä¸€ä¸ªä¸åŒç±»å‹çš„RTMPæ¶ˆæ¯æ—¶éƒ½è¦æœ‰ä¸ç”¨çš„chunk stream ID, å¦‚ä¸Šä¸€ä¸ªMessage æ˜¯commandç±»å‹çš„ï¼Œä¹‹åè¦å‘é€è§†é¢‘ç±»å‹çš„æ¶ˆæ¯ï¼Œè§†é¢‘æ¶ˆæ¯çš„chunk stream ID è¦ä¿è¯å’Œä¸Šé¢ commandç±»å‹çš„æ¶ˆæ¯ä¸åŒã€‚æ¯ä¸€ç§æ¶ˆæ¯ç±»å‹çš„èµ·å§‹chunk çš„ç±»å‹å¿…é¡»æ˜¯ Type_0 ç±»å‹çš„ï¼Œè¡¨æ˜æˆ‘æ˜¯ä¸€ä¸ªæ–°çš„æ¶ˆæ¯çš„èµ·å§‹ã€‚å¦å¤–è¿™ç¯‡æ–‡ç« æœ‰äº›åœ°æ–¹è¿˜æ˜¯è¯´çš„æ¨¡ç³Šï¼Œä»¥åæœ‰æ—¶é—´æ…¢æ…¢ä¸°å¯Œå§ã€‚"
  },
  
  {
    "title": "Gitå¼€å‘æäº¤å’Œå‘ç‰ˆè§„èŒƒ",
    "url": "/git-kai-fa-ti-jiao-he-fa-ban-gui-fan.html",
    "categories": "RTC",
    "tags": "",
    "date": "2023-03-12 21:33:36 +0800",
    





    
    "snippet": "ä¸€ã€ æäº¤è§„èŒƒ  ä¿®æ”¹ä¸€ä¸ª bug æˆ–å¢åŠ  feature ä¸è¦ commit å¤šæ¬¡ï¼Œåˆå¹¶æˆä¸€æ¬¡æäº¤ï¼Œä¾¿äºè¿½è¸ª      ä½¿ç”¨ rebase è€Œé mergeï¼Œé¿å…äº§ç”ŸmergeèŠ‚ç‚¹          æ‹‰å–åˆ†æ”¯ä½¿ç”¨ git pull --rebaseå‘½ä»¤      åˆå¹¶åˆ†æ”¯ä½¿ç”¨ git rebase [branch name], å¦‚ git rebase master (å°†materåˆ†æ”¯åˆå¹¶...",
    "content": "ä¸€ã€ æäº¤è§„èŒƒ  ä¿®æ”¹ä¸€ä¸ª bug æˆ–å¢åŠ  feature ä¸è¦ commit å¤šæ¬¡ï¼Œåˆå¹¶æˆä¸€æ¬¡æäº¤ï¼Œä¾¿äºè¿½è¸ª      ä½¿ç”¨ rebase è€Œé mergeï¼Œé¿å…äº§ç”ŸmergeèŠ‚ç‚¹          æ‹‰å–åˆ†æ”¯ä½¿ç”¨ git pull --rebaseå‘½ä»¤      åˆå¹¶åˆ†æ”¯ä½¿ç”¨ git rebase [branch name], å¦‚ git rebase master (å°†materåˆ†æ”¯åˆå¹¶åˆ°å½“å‰æ‰€åœ¨åˆ†æ”¯)            commit log å¢åŠ åˆ†ç±»ï¼Œå°½é‡è§£é‡Šè¯¦ç»†ï¼Œé˜²æ­¢è¿‡åä¸æ¸…æ¥šèŠ‚ç‚¹åšäº†ä»€ä¹ˆä¿®æ”¹    [bugfix] : fix android rtmp video crash ï¼ˆä¿®æ”¹bugï¼‰    [feature] : ios support screen share ( å¢åŠ æ–°åŠŸèƒ½)    [refactor] : refine windows video capture module (é‡æ„æ¨¡å—)    [chore] : update readme doc ï¼ˆå…¶ä»–ä¿®æ”¹ï¼‰  äºŒã€æµç¨‹è§„èŒƒ  ä»“åº“ä¸‹å¿…é¡»æœ‰ master å’Œ dev åˆ†æ”¯ï¼Œdevåˆ†æ”¯ç”¨äºæ—¥å¸¸å¼€å‘ï¼Œmaster åˆ†æ”¯ç”¨äºå‡ºç‰ˆæœ¬;  dev åˆ†æ”¯åŠŸèƒ½ç¨³å®šåå‡ºç‰ˆæœ¬ï¼Œå˜æ›´ç‰ˆæœ¬å·ï¼Œæäº¤ Merge Requestå°† dev åˆ†æ”¯åˆå¹¶åˆ° master åˆ†æ”¯ï¼Œè§¦å‘è‡ªåŠ¨å‡ºåŒ…  master åˆ†æ”¯åªæœ‰ä»“åº“ç®¡ç†å‘˜æœ‰æäº¤&amp;åˆå¹¶æƒé™ï¼›ä¸‰ã€ç‰ˆæœ¬å·ç‰ˆæœ¬å·ç”±3ä½æ„æˆï¼Œå¦‚ 2.3.1ï¼Œé€’å¢è§„åˆ™å¦‚ä¸‹ç¬¬1ä½ï¼šäº§å“æ”¹åŠ¨è¾ƒå¤§ï¼Œå¤§çš„ç‰ˆæœ¬å˜æ›´,å¯èƒ½æ— æ³•å‘åå…¼å®¹ç¬¬2ä½ï¼šå¢åŠ äº†æ–°åŠŸèƒ½ï¼Œå‘åå…¼å®¹ç¬¬3ä½ï¼šä¿®å¤ BUG æˆ–ä¼˜åŒ–ä»£ç ï¼Œå‘åå…¼å®¹å››ã€å…¶ä»–  Git GUIå·¥å…·æ¨èï¼š[fork] (https://git-fork.com) æˆ– [sourcetree] (https://www.sourcetreeapp.com)  Git Rebase è¯¦è§£: https://www.cnblogs.com/TvvT-kevin/p/9611115.html  è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼šhttps//semver.org/lang/zh-CN/"
  },
  
  {
    "title": "Mac M1ç¼–è¯‘WebRTC(105) Android",
    "url": "/mac-m1bian-yiwebrtc105-android.html",
    "categories": "RTC",
    "tags": "M1, WebRTC",
    "date": "2023-03-07 14:09:26 +0800",
    





    
    "snippet": "å› è·¨å¹³å°å¼€å‘ï¼Œå®‰å“WebRTCä¹‹å‰åœ¨Ubuntuä¸Šç¼–è¯‘ï¼Œå¤ªéº»çƒ¦ï¼Œä¿®æ”¹ä¸ºMacç¼–è¯‘ï¼Œé’ˆå¯¹M1ï¼Œx86ä¿®æ”¹ç±»ä¼¼ä»£ç å‡†å¤‡ä¸¤ä»½ä»£ç fetch webrtc_androidfetch webrtc_iosAndroidç›®å½•æ‹·è´ webrtc_android/third_party ç›®å½•ä¸‹çš„ android å¼€å¤´çš„ç›®å½•è¦†ç›–æ‰webrtc_ios/third_partyR8webrtc_android/t...",
    "content": "å› è·¨å¹³å°å¼€å‘ï¼Œå®‰å“WebRTCä¹‹å‰åœ¨Ubuntuä¸Šç¼–è¯‘ï¼Œå¤ªéº»çƒ¦ï¼Œä¿®æ”¹ä¸ºMacç¼–è¯‘ï¼Œé’ˆå¯¹M1ï¼Œx86ä¿®æ”¹ç±»ä¼¼ä»£ç å‡†å¤‡ä¸¤ä»½ä»£ç fetch webrtc_androidfetch webrtc_iosAndroidç›®å½•æ‹·è´ webrtc_android/third_party ç›®å½•ä¸‹çš„ android å¼€å¤´çš„ç›®å½•è¦†ç›–æ‰webrtc_ios/third_partyR8webrtc_android/third_party/r8 -&gt; webrtc_ios/third_party/r8NDKä¸‹è½½macç‰ˆ ndkï¼Œæ›¿æ¢ webrtc_ios/third_party/android_ndk, æ³¨æ„ä¿ç•™é‡Œé¢çš„ android_ndk ç›®å½•ä¸­çš„ BUILD.gnJDKæ‰‹åŠ¨ä¸‹è½½ JDK, éœ€è¦11 æˆ–è€…ä»¥åçš„ç‰ˆæœ¬, æ›¿æ¢åˆ° third_party/jdk/current ç›®å½•ä¸‹LLVMæ‹·è´Macç‰ˆandroid_ndk/toolchains/llvm/prebuilt/darwin-x86_64/lib64/clang/12.0.9/lib/linuxåˆ°third_party/llvm-build/Release+Asserts/lib/clang/15.0.0/libè„šæœ¬ä¿®æ”¹ä¿®æ”¹if (host_cpu == \"x64\") {    android_host_arch = \"x86_64\"} else if (host_cpu == \"x86\") {    android_host_arch = \"x86\"} else if (host_cpu == \"arm64\") {    android_host_arch = \"x86_64\"} else {    assert(false, \"Need Android toolchain support for your build CPU arch.\")}ä¿®æ”¹third_party/ijar/BUILD.gn æ·»åŠ  || is_apple åˆ¤æ–­if (is_linux || is_chromeos || is_apple) {  config(\"ijar_compiler_flags\") {    if (is_clang) {      cflags = [ä» llvm å®˜ç½‘ä¸‹è½½mac arm 15ç‰ˆæœ¬, æ‹·è´llvm-nmllvm-stripllvm-objcopyåˆ°third_party/llvm-build/Release+Asserts/binè‹¥æŠ¥é”™CalledProcessErroræ³¨æ‰ build/android/gyp/util/build_utils.pyraise CalledProcessError(cwd, args, MSG.format(stream_string))å…¶ä»–é”™è¯¯åˆ°è¿™å› ç¯å¢ƒé…ç½®å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯å·²ç»å¾ˆå°‘äº†ï¼Œå¦‚æŠ¥é”™ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œæ•´ä½“çœ‹ä¿®æ”¹çš„ä¸œè¥¿ä¸æ˜¯å¤ªå¤šã€‚ç¼–è¯‘gn gen out/armv8 --args='target_os=\"android\" target_cpu=\"arm64\" is_component_build=false is_debug=false rtc_enable_protobuf=false rtc_include_tests=false rtc_build_examples=false   rtc_enable_sctp=false rtc_enable_libevent=false rtc_build_tools=false disable_android_lint=false use_errorprone_java_compiler=false use_custom_libcxx=false android32_ndk_api_level=18'ç–‘é—®NDKä¸­æœ‰clang, llvmä¸­æœ‰clangï¼Œç©¶ç«Ÿç”¨å“ªä¸ªç¼–è¯‘ï¼Œä¸¤è€…å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿå‚è€ƒ  https://blog.csdn.net/liuwenchang1234/article/details/107559530  https://www.jianshu.com/p/a65545d37022"
  },
  
  {
    "title": "SteerMouse å¼€å¿ƒè„šæœ¬",
    "url": "/steermouse-kai-xin-jiao-ben.html",
    "categories": "å·§è®°",
    "tags": "SteerMouse",
    "date": "2023-03-07 09:49:02 +0800",
    





    
    "snippet": "SteerMouseå¼€å¿ƒè„šæœ¬, æµ‹è¯•5.6.7å¯ä»¥ç”¨code :KMLH-JEEA-RKJM-NBGR-IXHH-LRAJ-POJK-BAFC-HHHH-LRFD#!pythonimport random id = 'ABCDEF-HIJKLM-(A)'code = 'KMLH-JEEA-RKJM-NBGR-IXHH-LRAJ-POJK-BAFC-HHHH-LRFD'  # æ³¨å†Œç   def...",
    "content": "SteerMouseå¼€å¿ƒè„šæœ¬, æµ‹è¯•5.6.7å¯ä»¥ç”¨code :KMLH-JEEA-RKJM-NBGR-IXHH-LRAJ-POJK-BAFC-HHHH-LRFD#!pythonimport random id = 'ABCDEF-HIJKLM-(A)'code = 'KMLH-JEEA-RKJM-NBGR-IXHH-LRAJ-POJK-BAFC-HHHH-LRFD'  # æ³¨å†Œç   def reverse_table(target_table):    ret_table = [0 for x in range(len(target_table))]    for i in range(160):        var = target_table[i // 8]        bit_value = (var &gt;&gt; (i % 8)) &amp; 0x1        index = i % 20        ret_table[index] = ret_table[index] | (bit_value &lt;&lt; i // 20)    return ret_table  def add_random():    return random.choice(['A', 'B', 'C', 'D', 'E'])  def integer_to_hex(int_array):    result = []    not_f_count = 0    for i in range(len(int_array)):        high = int_array[i] // 20        low = int_array[i] % 20        if i % 2 == 0 and i &gt; 0:            result.append('-')        if high == 0 and not_f_count &lt; 4:            result.append(add_random())            not_f_count += 1        else:            result.append(chr(high + 70))        if low == 0 and not_f_count &lt; 4:            result.append(add_random())            not_f_count += 1        else:            result.append(chr(low + 70))    return ''.join(result)  def gen_register_code(user_id):    init_table = [0 for x in range(20)]    init_table[-1] = 70    init_table[-2] = 85    for i in range(17):        init_table[i] = ord(user_id[i])    ret = reverse_table(init_table)    return integer_to_hex(ret)  def main():    print(gen_register_code(id))  if __name__ == '__main__':    main()"
  },
  
  {
    "title": "æŸ¥æ‰¾æ‰€æœ‰å­ç›®å½•æˆ–æ–‡ä»¶å¹¶æ‰§è¡Œæ“ä½œ",
    "url": "/cha-zhao-suo-you-zi-mu-lu-huo-wen-jian-bing-zhi-xi.html",
    "categories": "æ‹™è®°",
    "tags": "find",
    "date": "2023-03-06 10:31:15 +0800",
    





    
    "snippet": "ä¾‹å¦‚ï¼š æŸ¥æ‰¾æ‰€æœ‰.gitç›®å½•å¹¶åˆ é™¤find . -name \"*.git\" -exec rm -rf {} \\;",
    "content": "ä¾‹å¦‚ï¼š æŸ¥æ‰¾æ‰€æœ‰.gitç›®å½•å¹¶åˆ é™¤find . -name \"*.git\" -exec rm -rf {} \\;"
  },
  
  {
    "title": "Text and Typography",
    "url": "/posts/text-and-typography/",
    "categories": "æ‹™è®°",
    "tags": "typography",
    "date": "2019-08-08 11:33:00 +0800",
    





    
    "snippet": "This post is to show Markdown syntax rendering on Chirpy, you can also use it as an example of writing. Now, letâ€™s start looking at text and typography.TitlesH1 - headingH2 - headingH3 - headingH4 ...",
    "content": "This post is to show Markdown syntax rendering on Chirpy, you can also use it as an example of writing. Now, letâ€™s start looking at text and typography.TitlesH1 - headingH2 - headingH3 - headingH4 - headingParagraphQuisque egestas convallis ipsum, ut sollicitudin risus tincidunt a. Maecenas interdum malesuada egestas. Duis consectetur porta risus, sit amet vulputate urna facilisis ac. Phasellus semper dui non purus ultrices sodales. Aliquam ante lorem, ornare a feugiat ac, finibus nec mauris. Vivamus ut tristique nisi. Sed vel leo vulputate, efficitur risus non, posuere mi. Nullam tincidunt bibendum rutrum. Proin commodo ornare sapien. Vivamus interdum diam sed sapien blandit, sit amet aliquam risus mattis. Nullam arcu turpis, mollis quis laoreet at, placerat id nibh. Suspendisse venenatis eros eros.ListsOrdered list  Firstly  Secondly  ThirdlyUnordered list  Chapter          Section                  Paragraph                    ToDo list  Job          Step 1      Step 2      Step 3      Description list  Sun  the star around which the earth orbits  Moon  the natural satellite of the earth, visible by reflected light from the sunBlock Quote  This line shows the block quote.Prompts  An example showing the tip type prompt.  An example showing the info type prompt.  An example showing the warning type prompt.  An example showing the danger type prompt.Tables            Company      Contact      Country                  Alfreds Futterkiste      Maria Anders      Germany              Island Trading      Helen Bennett      UK              Magazzini Alimentari Riuniti      Giovanni Rovelli      Italy      Linkshttp://127.0.0.1:4000FootnoteClick the hook will locate the footnote1, and here is another footnote2.Inline codeThis is an example of Inline Code.FilepathHere is the /path/to/the/file.extend.Code blocksCommonThis is a common code snippet, without syntax highlight and line number.Specific Languageif [ $? -ne 0 ]; then  echo \"The command was not successful.\";  #do the needful / exitfi;Specific filename@import  \"colors/light-typography\",  \"colors/dark-typography\"MathematicsThe mathematics powered by MathJax:\\[\\sum_{n=1}^\\infty 1/n^2 = \\frac{\\pi^2}{6}\\]When $a \\ne 0$, there are two solutions to $ax^2 + bx + c = 0$ and they are\\[x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}\\]Mermaid SVG gantt  title  Adding GANTT diagram functionality to mermaid  apple :a, 2017-07-20, 1w  banana :crit, b, 2017-07-23, 1d  cherry :active, c, after b a, 1dImagesDefault (with caption)Full screen width and center alignmentLeft alignedFloat to leftPraesent maximus aliquam sapien. Sed vel neque in dolor pulvinar auctor. Maecenas pharetra, sem sit amet interdum posuere, tellus lacus eleifend magna, ac lobortis felis ipsum id sapien. Proin ornare rutrum metus, ac convallis diam volutpat sit amet. Phasellus volutpat, elit sit amet tincidunt mollis, felis mi scelerisque mauris, ut facilisis leo magna accumsan sapien. In rutrum vehicula nisl eget tempor. Nullam maximus ullamcorper libero non maximus. Integer ultricies velit id convallis varius. Praesent eu nisl eu urna finibus ultrices id nec ex. Mauris ac mattis quam. Fusce aliquam est nec sapien bibendum, vitae malesuada ligula condimentum.Float to rightPraesent maximus aliquam sapien. Sed vel neque in dolor pulvinar auctor. Maecenas pharetra, sem sit amet interdum posuere, tellus lacus eleifend magna, ac lobortis felis ipsum id sapien. Proin ornare rutrum metus, ac convallis diam volutpat sit amet. Phasellus volutpat, elit sit amet tincidunt mollis, felis mi scelerisque mauris, ut facilisis leo magna accumsan sapien. In rutrum vehicula nisl eget tempor. Nullam maximus ullamcorper libero non maximus. Integer ultricies velit id convallis varius. Praesent eu nisl eu urna finibus ultrices id nec ex. Mauris ac mattis quam. Fusce aliquam est nec sapien bibendum, vitae malesuada ligula condimentum.Dark/Light mode &amp; ShadowThe image below will toggle dark/light mode based on theme preference, notice it has shadows.VideoReverse Footnote            The footnote sourceÂ &#8617;              The 2nd footnote sourceÂ &#8617;      "
  }
  
]

